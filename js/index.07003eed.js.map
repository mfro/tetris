{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/ui/config/config-number.vue?4c1e","webpack:///./src/ui/config/config-select.vue?75a9","webpack:///./src/main.vue?afaf","webpack:///./src/main.vue?c0e6","webpack:///./src/ui/config/config-number.vue?064b","webpack:///./src/ui/config/config-rational.vue?2e4a","webpack:///./src/view/joining.vue?5234","webpack:///./src/ui/config/config-rational.vue?9190","webpack:///./src/view/landing.vue?4a94","webpack:///./src/view/joining.vue?dd75","webpack:////home/mfro/code/web-apps/chess/vue-next/packages/vue/dist/vue.runtime.esm-bundler.js","webpack:///./src/main.vue","webpack:///./src/ui/edit-config.vue","webpack:///./src/ui/config/config-game-rules.vue","webpack:///./src/tetris/config.ts","webpack:///./src/vec.ts","webpack:///./src/ui/config/config-select.vue","webpack:///./src/ui/config/config-select.vue?a069","webpack:///./src/ui/config/config-number.vue","webpack:///./src/ui/config/config-number.vue?0490","webpack:///./src/ui/config/config-rational.vue","webpack:///./src/ui/config/config-rational.vue?6018","webpack:///./src/ui/config/config-game-rules.vue?c2be","webpack:///./src/ui/config/config-user-prefs.vue","webpack:///./src/ui/config/config-autoshift.vue","webpack:///./src/ui/config/config-autoshift.vue?27b0","webpack:///./src/ui/config/config-user-prefs.vue?4068","webpack:///./src/ui/edit-config.vue?e7f8","webpack:///./src/view/room.vue","webpack:///./src/ui/game.vue","webpack:///./src/input.ts","webpack:///./src/tetris/index.ts","webpack:///./src/tetris/render/basic.ts","webpack:///./src/tetris/render/pixi.ts","webpack:///./src/ui/game.vue?8e79","webpack:///./src/ui/clipboard.vue","webpack:///./src/ui/clipboard.vue?d909","webpack:///./src/view/room.vue?0b9e","webpack:///./src/view/landing.vue","webpack:///./src/tetris/remote.ts","webpack:///./src/view/landing.vue?e6b8","webpack:///./src/view/joining.vue","webpack:///./src/view/joining.vue?9e35","webpack:///./src/main.vue?6697","webpack:///./src/main.ts","webpack:///./src/ui/config/config-rational.vue?e7e2","webpack:///./src/view/landing.vue?04a4"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","align-center","class","model-value","editing_user","kind","user_prefs","current_room","room","joining_code","code","$event","style","title","icon","small","$emit","actions","color","save","description","gravity","filter","v","lock_delay","move_reset_limit","bag_preview","wall_kicks","options","wallKickOptions","Vec","x","y","this","Math","sqrt","atan2","a","polar","dir","scalar","b","dot","abs","acos","len","cos","sin","constant","type","optional","inner","natural","rational","zero","tetronimos","define","size","raw_tiles","rotation","map","rotations","I","O","T","J","L","S","Z","all","define_kick_data","raw","no_kick_data","base_kick_data","base_i_kick_data","asira_i_kick_data","standard","Map","asira","none","GameRules","rules","field_size","fall_delay","indexOf","load","src","delay","initial_delay","right","text","label","$refs","select","click","id","ref","option","emits","props","String","modelValue","Array","setup","emit","findIndex","pair","set","render","__scopeId","state","editing","onInput","onBlur","warning","error","Number","Function","toString","immediate","num","parseInt","cssModules","__cssModules","top","focus","setTop","target","column","justify-center","bot","setBot","console","log","components","configSelect","configNumber","configRational","autoshift","soft_drop","configAutoshift","configGameRules","configUserPrefs","game_rules","grow","local","others","member","game","align-start","link","members","index","start","SPACE","LEFT","UP","SHIFT","DOWN","RIGHT","A","X","C","R","down","Set","up_listeners","down_listeners","isKeyDown","k","has","onKeyDown","handler","list","onKeyUp","addEventListener","e","keyCode","add","item","delete","pieces","position","empty_row","row","empty_field","field","empty_state","seed","alea","random","uint32","falling","fall_queue","holding","hold_available","dead","reactive_state","reactive","shallowReactive","customRef","track","trigger","shallowRef","new_game","next_id","collide","part","tile","hard_drop_position","bottom","assign","hold","_a","_b","next_fall","unshift","drop","distance","rotate","kicks","kick_info","assert","kick","lock_down","cleared","every","new_falling","pool","floor","ceil","end_game","play","user","move_reset","lock_progress","fall_progress","repeating","shift_left","shift_right","repeat_shift","repeat_delay","Infinity","try_drop","is_on_ground","try_move_reset","change","hard_drop","press_shift","release_shift","cancel","setInterval","update","clearInterval","min","move","TileStyle","draw_styles","v1","context","surroundings","colors","ghost","fillStyle","fillRect","disabled","border","beginPath","lineCap","lineWidth","strokeStyle","moveTo","lineTo","stroke","restore","v2","globalAlpha","translate","left_inner","left_outer","right_inner","right_outer","IMAGE_STRIDE","image_offset","around","scale","render_tilesheets","callback","bytes","TextEncoder","encode","crypto","subtle","digest","then","hash_raw","hash","from","Uint8Array","padStart","join","localStorage","getItem","cache","JSON","parse","styles","normal","canvas","document","createElement","width","height","getContext","clearRect","offset","url","toDataURL","setItem","stringify","unit_size","pixel","textures","tile_at","pos","draw_tile","base","sprite","texture","SpritePool","container","sprites","removeChild","offsets","adj","eq","addChild","draw_ui","g","topleft","botrite","thickness","lineStyle","clear","center","parts","minX","reduce","minY","maxX","max","maxY","draw_tetronimo","draw_background","beginFill","drawRect","endFill","app","view","transparent","tilesheets","forEach","sheet","loader","onLoad","once","resources","baseTexture","root","background","queue","stage","destroy","cleanup","pixi_render","copy","copied","bold","solo","input","execCommand","clipboard","editConfig","location","origin","pathname","_","start_game","local_game","valid","create_room","observe","hook","original","socket","host","check_exit","WebSocket","config","players","URL","href","searchParams","history","replaceState","search","names","localCleanup","edit","submit","landing","joining","use","mount"],"mappings":"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","file":"js/index.07003eed.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"index\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"config-number_root_1JO2c\"};","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./config-select.vue?vue&type=style&index=0&id=632a7c32&lang=scss&scoped=true\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./main.vue?vue&type=style&index=0&id=3ed78246&lang=scss\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./main.vue?vue&type=style&index=1&id=3ed78246&lang=scss&scoped=true\"","export { default } from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./config-number.vue?vue&type=style&index=0&id=0c08f32e&lang=scss&module=true\"; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./config-number.vue?vue&type=style&index=0&id=0c08f32e&lang=scss&module=true\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"config-rational_root_1KOtQ\"};","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./joining.vue?vue&type=style&index=1&id=d871ed76&lang=scss&scoped=true\"","export { default } from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./config-rational.vue?vue&type=style&index=0&id=1924bb03&lang=scss&module=true\"; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-0-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-0-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-0-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-0-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./config-rational.vue?vue&type=style&index=0&id=1924bb03&lang=scss&module=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./landing.vue?vue&type=style&index=1&id=6be00a92&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./joining.vue?vue&type=style&index=0&id=d871ed76&lang=scss\"","import { setDevtoolsHook, initCustomFormatter, warn } from '@vue/runtime-dom';\nexport * from '@vue/runtime-dom';\nimport { getGlobalThis } from '@vue/shared';\n\nfunction initDev() {\r\n    const target = getGlobalThis();\r\n    target.__VUE__ = true;\r\n    setDevtoolsHook(target.__VUE_DEVTOOLS_GLOBAL_HOOK__);\r\n    {\r\n        initCustomFormatter();\r\n    }\r\n}\n\n// This entry exports the runtime only, and is built as\r\nif ((process.env.NODE_ENV !== 'production') || __VUE_PROD_DEVTOOLS__) {\r\n    initDev();\r\n}\r\nconst compile = () => {\r\n    if ((process.env.NODE_ENV !== 'production')) {\r\n        warn(`Runtime compilation is not supported in this build of Vue.` +\r\n            ( ` Configure your bundler to alias \"vue\" to \"vue/dist/vue.esm-bundler.js\".`\r\n                ) /* should not happen */);\r\n    }\r\n};\n\nexport { compile };\n","<template>\n  <v-app align-center class=\"pa-6\">\n    <v-dialog :model-value=\"editing_user\">\n      <edit-config\n        kind=\"user\"\n        v-model=\"user_prefs\"\n        @close=\"editing_user = false\"\n      />\n    </v-dialog>\n\n    <v-flex class=\"user pa-4\">\n      <v-button @click=\"editing_user = true\">\n        <v-icon class=\"mr-3\">settings</v-icon>\n        <span>User preferences</span>\n      </v-button>\n    </v-flex>\n\n    <room v-if=\"current_room != null\" :room=\"current_room\" />\n\n    <joining\n      v-else-if=\"joining_code != null\"\n      :code=\"joining_code\"\n      @room=\"current_room = $event\"\n    />\n\n    <landing v-else @room=\"current_room = $event\" />\n  </v-app>\n</template>\n\n<script>\nimport { computed, provide, shallowRef, watch } from 'vue';\n\nimport editConfig from '@/ui/edit-config';\n\nimport room from './view/room';\nimport landing from './view/landing';\nimport joining from './view/joining';\n\nexport default {\n  name: 'tetris',\n\n  components: {\n    editConfig,\n\n    room,\n    landing,\n    joining,\n  },\n\n  setup() {\n    const current_room = shallowRef(null);\n    const url = new URL(window.location.href);\n    const code = url.searchParams.get('code');\n    const joining_code = shallowRef(code);\n\n    const raw = localStorage.getItem('mfro:tetris-user-preferences');\n\n    const editing_user = shallowRef(false);\n    const user_prefs = raw ? JSON.parse(raw) : {\n      autoshift: { delay: 2, initial_delay: 10 },\n      soft_drop: 10,\n    };\n\n    provide('user_prefs', user_prefs);\n\n    return {\n      current_room,\n      joining_code,\n      editing_user,\n\n      user_prefs: computed({\n        get: () => user_prefs,\n        set: (v) => {\n          Object.assign(user_prefs, v)\n          localStorage.setItem('mfro:tetris-user-preferences', JSON.stringify(v));\n        },\n      }),\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\">\n#app {\n  width: 100vw;\n  height: 100vh;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.user {\n  position: absolute;\n  left: 0;\n  bottom: 0;\n}\n</style>\n","<template>\n  <v-card style=\"min-width: 60ch\">\n    <template v-slot:title>\n      <v-text title v-if=\"kind == 'game'\">Game rules</v-text>\n      <v-text title v-if=\"kind == 'user'\">User preferences</v-text>\n\n      <v-grow />\n\n      <v-button icon small @click=\"$emit('close')\">\n        <v-icon>close</v-icon>\n      </v-button>\n    </template>\n\n    <config-game-rules v-if=\"kind == 'game'\" v-model=\"value\" />\n    <config-user-prefs v-if=\"kind == 'user'\" v-model=\"value\" />\n\n    <template v-slot:actions>\n      <v-grow />\n\n      <v-button color=\"primary\" @click=\"save()\">\n        <span>Save</span>\n      </v-button>\n    </template>\n  </v-card>\n</template>\n\n<script>\nimport { shallowRef, watch } from 'vue';\nimport configGameRules from './config/config-game-rules';\nimport configUserPrefs from './config/config-user-prefs';\n\nexport default {\n  name: 'edit-config',\n  components: {\n    configGameRules,\n    configUserPrefs,\n  },\n\n  emits: ['close', 'update:modelValue'],\n  props: {\n    kind: String,\n    modelValue: Object,\n  },\n\n  setup(props, { emit }) {\n    const value = shallowRef(props.modelValue);\n\n    watch(() => props.modelValue, v => value.value = v);\n\n    return {\n      value,\n\n      save() {\n        emit('update:modelValue', value.value);\n        emit('close');\n      },\n    }\n  },\n};\n</script>\n\n<style>\n</style>\n","<template>\n  <config-rational\n    name=\"Gravity\"\n    description=\"Gravity for falling pieces (tiles per frame)\"\n    v-model=\"gravity\"\n    :filter=\"(v) => v <= 20\"\n  />\n\n  <config-number\n    name=\"Lock delay\"\n    description=\"Delay after touching the ground before a piece locks down (frames)\"\n    v-model=\"lock_delay\"\n    :filter=\"(v) => v >= 0\"\n  />\n\n  <config-number\n    name=\"Move reset limit\"\n    description=\"Maximum number of times the lock delay can be reset by successful shifts or rotates\"\n    v-model=\"move_reset_limit\"\n    :filter=\"(v) => v >= 0\"\n  />\n\n  <config-number\n    name=\"Preview size\"\n    description=\"Number of pieces in the preview\"\n    v-model=\"bag_preview\"\n    :filter=\"(v) => v >= 0 && v <= 6\"\n  />\n\n  <config-select\n    name=\"Wall kick style\"\n    description=\"Wall kick configuration to use for rotations\"\n    v-model=\"wall_kicks\"\n    :options=\"wallKickOptions\"\n  />\n</template>\n\n<script>\nimport { computed } from 'vue';\n\nimport { wall_kicks } from '@/tetris/config';\n\nimport configSelect from './config-select';\nimport configNumber from './config-number';\nimport configRational from './config-rational';\n\nconst wallKickOptions = [\n  ['No Kicks', wall_kicks.none],\n  ['Standard', wall_kicks.standard],\n  ['Asira', wall_kicks.asira],\n];\n\nfunction field(emit, target, key, get = v => v, set = v => v) {\n  return computed({\n    get: () => get(target()[key]),\n    set: (value) => {\n      let rules = { ...target(), [key]: set(value) };\n      emit('update:modelValue', rules);\n    },\n  });\n}\n\nexport default {\n  name: 'config-game-rules',\n  components: {\n    configSelect,\n    configNumber,\n    configRational,\n  },\n\n  emits: ['update:modelValue'],\n  props: {\n    modelValue: Object,\n  },\n\n  setup(props, { emit }) {\n    let gravity = field(emit, () => props.modelValue, 'fall_delay', v => 1 / v, v => 1 / v);\n    let lock_delay = field(emit, () => props.modelValue, 'lock_delay');\n    let move_reset_limit = field(emit, () => props.modelValue, 'move_reset_limit');\n    let bag_preview = field(emit, () => props.modelValue, 'bag_preview');\n    let wall_kicks = field(emit, () => props.modelValue, 'wall_kicks');\n\n    return {\n      gravity,\n      lock_delay,\n      move_reset_limit,\n      bag_preview,\n      wall_kicks,\n      wallKickOptions,\n    };\n  },\n};\n</script>\n\n<style>\n</style>\n","import { Vec } from '@/vec';\n\nimport { TetronimoKind, Tile, Tetronimo } from '.';\n\nexport namespace tetronimos {\n  function define(size: number, raw_tiles: [number, number][]): TetronimoKind {\n    let rotation = raw_tiles.map(t => new Vec(t[0], t[1]));\n    let rotations = [rotation];\n\n    for (let i = 0; i < 3; ++i) {\n      rotation = rotation.map(v => new Vec(size - 1 - v.y, v.x));\n      rotations.push(rotation);\n    }\n\n    return {\n      size,\n      rotations,\n    };\n  }\n\n  export const I = define(4, [[0, 1], [1, 1], [2, 1], [3, 1]]);\n  export const O = define(2, [[0, 0], [0, 1], [1, 0], [1, 1]]);\n  export const T = define(3, [[1, 0], [0, 1], [1, 1], [2, 1]]);\n  export const J = define(3, [[0, 0], [0, 1], [1, 1], [2, 1]]);\n  export const L = define(3, [[2, 0], [0, 1], [1, 1], [2, 1]]);\n  export const S = define(3, [[1, 0], [2, 0], [0, 1], [1, 1]]);\n  export const Z = define(3, [[0, 0], [1, 0], [1, 1], [2, 1]]);\n\n  export const all = [I, O, T, J, L, S, Z];\n}\n\nexport namespace wall_kicks {\n  function define_kick_data(raw: [number, number][][]) {\n    return raw.map(a => [Vec.zero, ...a.map(a => new Vec(a[0], -a[1]))]);\n  }\n\n  const no_kick_data = define_kick_data([\n    [[0, 0]], // 0 -> 1\n    [[0, 0]], // 1 -> 0\n    [[0, 0]], // 1 -> 2\n    [[0, 0]], // 2 -> 1\n    [[0, 0]], // 2 -> 3\n    [[0, 0]], // 3 -> 2\n    [[0, 0]], // 3 -> 0\n    [[0, 0]], // 0 -> 3\n  ]);\n\n  const base_kick_data = define_kick_data([\n    [[0, 0], [-1, 0], [-1, +1], [0, -2], [-1, -2]], // 0 -> 1\n    [[0, 0], [+1, 0], [+1, -1], [0, +2], [+1, +2]], // 1 -> 0\n    [[0, 0], [+1, 0], [+1, -1], [0, +2], [+1, +2]], // 1 -> 2\n    [[0, 0], [-1, 0], [-1, +1], [0, -2], [-1, -2]], // 2 -> 1\n    [[0, 0], [+1, 0], [+1, +1], [0, -2], [+1, -2]], // 2 -> 3\n    [[0, 0], [-1, 0], [-1, -1], [0, +2], [-1, +2]], // 3 -> 2\n    [[0, 0], [-1, 0], [-1, -1], [0, +2], [-1, +2]], // 3 -> 0\n    [[0, 0], [+1, 0], [+1, +1], [0, -2], [+1, -2]], // 0 -> 3\n  ]);\n\n  const base_i_kick_data = define_kick_data([\n    [[0, 0], [-2, 0], [+1, 0], [-2, -1], [+1, +2]], // 0 -> 1\n    [[0, 0], [+2, 0], [-1, 0], [+2, +1], [-1, -2]], // 1 -> 0\n    [[0, 0], [-1, 0], [+2, 0], [-1, +2], [+2, -1]], // 1 -> 2\n    [[0, 0], [+1, 0], [-2, 0], [+1, -2], [-2, +1]], // 2 -> 1\n    [[0, 0], [+2, 0], [-1, 0], [+2, +1], [-1, -2]], // 2 -> 3\n    [[0, 0], [-2, 0], [+1, 0], [-2, -1], [+1, +2]], // 3 -> 2\n    [[0, 0], [+1, 0], [-2, 0], [+1, -2], [-2, +1]], // 3 -> 0\n    [[0, 0], [-1, 0], [+2, 0], [-1, +2], [+2, -1]], // 0 -> 3\n  ]);\n\n  const asira_i_kick_data = define_kick_data([\n    [[0, 0], [-2, 0], [+1, 0], [+1, +2], [-2, -1]], // 0 -> 1\n    [[0, 0], [+2, 0], [-1, 0], [+2, +1], [-1, -2]], // 1 -> 0\n    [[0, 0], [-1, 0], [+2, 0], [-1, +2], [+2, -1]], // 1 -> 2\n    [[0, 0], [-2, 0], [+1, 0], [-2, +1], [+1, -1]], // 2 -> 1\n    [[0, 0], [+2, 0], [-1, 0], [+2, +1], [-1, -1]], // 2 -> 3\n    [[0, 0], [+1, 0], [-2, 0], [+1, +2], [-2, -1]], // 3 -> 2\n    [[0, 0], [-2, 0], [+1, 0], [-2, +1], [+1, -2]], // 3 -> 0\n    [[0, 0], [+2, 0], [-1, 0], [-1, +2], [+2, -1]], // 0 -> 3\n  ]);\n\n  export const standard = new Map([\n    [tetronimos.I, base_i_kick_data],\n    [tetronimos.O, base_kick_data],\n    [tetronimos.T, base_kick_data],\n    [tetronimos.J, base_kick_data],\n    [tetronimos.L, base_kick_data],\n    [tetronimos.S, base_kick_data],\n    [tetronimos.Z, base_kick_data],\n  ]);\n\n  export const asira = new Map([\n    [tetronimos.I, asira_i_kick_data],\n    [tetronimos.O, base_kick_data],\n    [tetronimos.T, base_kick_data],\n    [tetronimos.J, base_kick_data],\n    [tetronimos.L, base_kick_data],\n    [tetronimos.S, base_kick_data],\n    [tetronimos.Z, base_kick_data],\n  ]);\n\n  export const none = new Map([\n    [tetronimos.I, no_kick_data],\n    [tetronimos.O, no_kick_data],\n    [tetronimos.T, no_kick_data],\n    [tetronimos.J, no_kick_data],\n    [tetronimos.L, no_kick_data],\n    [tetronimos.S, no_kick_data],\n    [tetronimos.Z, no_kick_data],\n  ]);\n\n  export const all = [none, standard, asira];\n}\n\nexport interface GameRules {\n  // size of the visible playfield\n  field_size: Vec;\n\n  // updates between the falling piece moving down\n  fall_delay: number;\n  // delay before the falling pieces locks into place\n  lock_delay: number;\n  // limit on how many times rotating or shifting the piece can reset the lock delay. null indicates no limit\n  move_reset_limit: null | number;\n\n  // wall kick data\n  wall_kicks: Map<TetronimoKind, Vec[][]>;\n\n  // number of Tetronimos to pre-generate in the queue\n  bag_preview: 5,\n}\n\nexport namespace GameRules {\n  export function save(rules: GameRules): any {\n    return {\n      field_size: [rules.field_size.x, rules.field_size.y],\n      fall_delay: rules.fall_delay,\n      lock_delay: rules.lock_delay,\n      move_reset_limit: rules.move_reset_limit,\n      wall_kicks: wall_kicks.all.indexOf(rules.wall_kicks),\n      bag_preview: rules.bag_preview,\n    };\n  }\n\n  export function load(src: any): GameRules {\n    return {\n      field_size: new Vec(src.field_size[0], src.field_size[1]),\n      fall_delay: src.fall_delay,\n      lock_delay: src.lock_delay,\n      move_reset_limit: src.move_reset_limit,\n      wall_kicks: wall_kicks.all[src.wall_kicks],\n      bag_preview: src.bag_preview,\n    };\n  }\n}\n\nexport interface UserPreferences {\n  // autoshift information for repeating shifts while input is held\n  autoshift: null | { delay: number, initial_delay: number };\n  // multiplier for fall_delay while soft drop is held\n  soft_drop: number;\n}\n\nexport interface GameState {\n  seed: number;\n  field: (Tile | null)[][],\n\n  falling: Tetronimo | null,\n  fall_queue: TetronimoKind[],\n\n  holding: TetronimoKind | null,\n  hold_available: boolean,\n\n  dead: boolean;\n}\n\nexport type Option =\n  | { type: 'constant', value: any }\n  | { type: 'optional', inner: Option }\n  | { name: string, description: string } & (\n    | { type: 'natural' }\n    | { type: 'rational' }\n    | { type: 'select', options: [string, any][] }\n    | { type: 'object', inner: Definition<any> }\n  );\n\nfunction constant(value: any): Option {\n  return { type: 'constant', value };\n}\n\nfunction optional(inner: Option): Option {\n  return { type: 'optional', inner };\n}\n\nfunction natural(name: string, description: string): Option {\n  return { type: 'natural', name, description };\n}\n\nfunction rational(name: string, description: string): Option {\n  return { type: 'rational', name, description };\n}\n\nfunction select(name: string, description: string, options: [string, any][]): Option {\n  return { type: 'select', name, description, options };\n}\n\nfunction object<T>(name: string, description: string, inner: Definition<T>): Option {\n  return { type: 'object', name, description, inner };\n}\n\ntype Definition<T> = {\n  [K in keyof T]: Option;\n}\n\nexport const GameDefinition: Definition<GameRules> = {\n  field_size: constant(new Vec(10, 40)),\n\n  fall_delay: rational('Drop Delay', 'Drop delay for falling pieces (frames per tile)'),\n\n  lock_delay: rational('Lock Delay', 'Lock down delay (frames)'),\n\n  move_reset_limit: optional(rational('Move Reset Limit', 'Maximum number of times the Lock Delay can be reset by successful shifts or rotates')),\n\n  wall_kicks: select('Wall Kicks', 'Wall kick data', [\n    ['No Kicks', wall_kicks.none],\n    ['Standard', wall_kicks.standard],\n    ['Asira', wall_kicks.asira],\n  ]),\n\n  bag_preview: natural('Preview Size', 'Number of pieces in the preview'),\n};\n\nexport const UserDefinition: Definition<UserPreferences> = {\n  autoshift: optional(object('Autoshift', 'Configure repeated shifts while input is held', {\n    delay: rational('Delay', 'Delay between repeated shifts (frames)'),\n    initial_delay: rational('Initial Delay', 'Delay after first shift before repeating (frames)'),\n  })),\n\n  soft_drop: rational('Soft Drop Multiplier', 'Multiplier for Drop Delay while soft dropping'),\n}\n","export class Vec {\n    constructor(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    get len() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    }\n    get dir() {\n        return Math.atan2(this.y, this.x);\n    }\n    static norm(a) {\n        return Vec.polar(1, a.dir);\n    }\n    static scale(a, scalar) {\n        return new Vec(a.x * scalar, a.y * scalar);\n    }\n    static add(a, b) {\n        return new Vec(a.x + b.x, a.y + b.y);\n    }\n    static dot(a, b) {\n        return a.x * b.x + a.y * b.y;\n    }\n    static eq(a, b) {\n        return a.x == b.x && a.y == b.y;\n    }\n    static delta(a, b) {\n        let dot = Vec.dot(a, b);\n        let abs = Math.acos(dot / a.len / b.len);\n        if (a.y * b.x > a.x * b.y)\n            return -abs;\n        return abs;\n    }\n    static polar(len, dir) {\n        return new Vec(Math.cos(dir) * len, Math.sin(dir) * len);\n    }\n}\nVec.zero = new Vec(0, 0);\n","<template>\n  <v-tooltip right :text=\"description\">\n    <v-input :label=\"name\" @click=\"$refs.select.click()\">\n      <template v-slot=\"{ id }\">\n        <select :id=\"id\" v-model=\"value\" ref=\"select\">\n          <option v-for=\"(option, i) in options\" :key=\"option[0]\" :value=\"i\">\n            {{ option[0] }}\n          </option>\n        </select>\n      </template>\n    </v-input>\n  </v-tooltip>\n\n  <!-- <config-value :name=\"name\" :description=\"description\">\n    <v-select\n      small\n      v-model=\"value\"\n      :options=\"options\"\n      :text=\"(o) => o[0]\"\n      :value=\"(o) => o[1]\"\n    />\n  </config-value> -->\n</template>\n\n<script>\nimport { computed } from 'vue';\n\nexport default {\n  name: 'config-select',\n\n  emits: ['update:modelValue'],\n  props: {\n    name: String,\n    description: String,\n    modelValue: {},\n    options: Array,\n  },\n\n  setup(props, { emit }) {\n    let value = computed({\n      get: () => props.options.findIndex(pair => pair[1] == props.modelValue),\n      set: (v) => {\n        emit('update:modelValue', props.options[v][1]);\n      },\n    });\n\n    return { value };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\nselect {\n  outline: none;\n  width: calc(100% + 32px);\n  margin: -30px -16px -8px -16px;\n  padding: 30px 16px 7px;\n}\n</style>\n","import { render } from \"./config-select.vue?vue&type=template&id=632a7c32&scoped=true\"\nimport script from \"./config-select.vue?vue&type=script&lang=js\"\nexport * from \"./config-select.vue?vue&type=script&lang=js\"\n\nimport \"./config-select.vue?vue&type=style&index=0&id=632a7c32&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-632a7c32\"\n\nexport default script","<template>\n  <v-tooltip right :text=\"description\">\n    <v-text-field\n      :label=\"name\"\n      :model-value=\"state.editing\"\n      @update:model-value=\"onInput\"\n      @blur=\"onBlur\"\n      :warning=\"state.error\"\n    />\n  </v-tooltip>\n</template>\n\n<script>\nimport { nextTick, shallowReactive, watch } from 'vue';\n\nexport default {\n  name: 'config-number',\n\n  emits: ['update:modelValue'],\n  props: {\n    name: String,\n    description: String,\n    modelValue: Number,\n    filter: Function,\n  },\n\n  setup(props, { emit }) {\n    let state = shallowReactive({\n      editing: null,\n      error: false,\n    });\n\n    watch(() => props.modelValue, () => {\n      state.editing = props.modelValue.toString();\n    }, { immediate: true });\n\n    return {\n      state,\n\n      onInput(v) {\n        state.editing = v;\n\n        let num = parseInt(v, 10);\n\n        if (num.toString() != v || props.filter && !props.filter(num)) {\n          state.error = true;\n        } else {\n          state.error = false;\n          nextTick(() => emit('update:modelValue', num));\n        }\n      },\n\n      onBlur() {\n        // debugger;\n        // state.editing = props.modelValue.toString();\n        // state.error = false;\n      },\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" module>\ndiv.root :global(input) {\n  width: 10ch;\n  // text-align: end;\n}\n</style>\n","import { render } from \"./config-number.vue?vue&type=template&id=0c08f32e\"\nimport script from \"./config-number.vue?vue&type=script&lang=js\"\nexport * from \"./config-number.vue?vue&type=script&lang=js\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./config-number.vue?vue&type=style&index=0&id=0c08f32e&lang=scss&module=true\"\ncssModules[\"$style\"] = style0\nscript.render = render\n\nexport default script","<template>\n  <v-tooltip right :text=\"description\">\n    <v-input\n      :label=\"name\"\n      style=\"cursor: text\"\n      @click=\"$refs.top.focus()\"\n      :warning=\"state.error\"\n    >\n      <template v-slot=\"{ id }\">\n        <v-flex>\n          <input\n            ref=\"top\"\n            :id=\"id\"\n            :style=\"{ width: `3ch` }\"\n            :value=\"state.top\"\n            @input=\"setTop($event.target.value)\"\n          />\n\n          <v-flex class=\"mx-2\" column justify-center>\n            <v-text>/</v-text>\n          </v-flex>\n\n          <input\n            @click.stop\n            :value=\"state.bot\"\n            @input=\"setBot($event.target.value)\"\n          />\n        </v-flex>\n      </template>\n    </v-input>\n  </v-tooltip>\n</template>\n\n<script>\nimport { shallowReactive, watch } from 'vue';\n\nexport default {\n  name: 'config-rational',\n\n  emits: ['update:modelValue'],\n  props: {\n    name: String,\n    description: String,\n    modelValue: Number,\n    filter: Function,\n  },\n\n  setup(props, { emit }) {\n    let state = shallowReactive({\n      top: null,\n      bot: null,\n      error: false,\n    });\n\n    watch(() => props.modelValue, () => {\n      if (props.modelValue > 1) {\n        state.top = props.modelValue.toString();\n        state.bot = '1';\n      } else {\n        state.top = '1';\n        state.bot = 1 / props.modelValue.toString();\n      }\n    }, { immediate: true });\n\n    // let top = computed({\n    //   get: () => {\n    //     if (props.modelValue > 1) {\n    //       return props.modelValue.toString();\n    //     } else {\n    //       return '1';\n    //     }\n    //   },\n\n    //   set: (v) => {\n    //     let num = parseInt(v);\n\n    //     if (props.filter && !props.filter(num))\n    //       return;\n\n    //     emit('update:modelValue', num);\n    //   },\n    // });\n\n    // let bot = computed({\n    //   get: () => {\n    //     if (props.modelValue < 1) {\n    //       return (1 / props.modelValue).toString();\n    //     } else {\n    //       return '1';\n    //     }\n    //   },\n\n    //   set: (v) => {\n    //     let num = 1 / parseInt(v);\n\n    //     if (props.filter && !props.filter(num))\n    //       return;\n\n    //     emit('update:modelValue', num);\n    //   },\n    // });\n\n    return {\n      state,\n\n      setTop(v) {\n        state.top = v;\n        state.bot = '1';\n\n        let num = parseInt(v, 10);\n        if (num.toString() != v || props.filter && !props.filter(num)) {\n          state.error = true;\n        } else {\n          state.error = false;\n          emit('update:modelValue', num);\n        }\n      },\n\n      setBot(v) {\n        state.top = '1';\n        state.bot = v;\n\n        let num = 1 / parseInt(v, 10);\n        console.log(v, num);\n        if ((1 / num).toString() != v || props.filter && !props.filter(num)) {\n          state.error = true;\n        } else {\n          state.error = false;\n          emit('update:modelValue', num);\n        }\n      },\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" module>\ndiv.root :global(input) {\n  width: 10ch;\n  // text-align: end;\n}\n</style>\n\n<style lang=\"scss\" scoped>\n@import \"@mfro/vue-ui/src/style.scss\";\n\ninput {\n  color: inherit;\n  font-size: $text-unit;\n  outline: none;\n\n  font-family: Roboto;\n  font-weight: normal;\n}\n</style>\n","import { render } from \"./config-rational.vue?vue&type=template&id=1924bb03&scoped=true\"\nimport script from \"./config-rational.vue?vue&type=script&lang=js\"\nexport * from \"./config-rational.vue?vue&type=script&lang=js\"\n\nconst cssModules = script.__cssModules = {}\nimport style0 from \"./config-rational.vue?vue&type=style&index=0&id=1924bb03&lang=scss&module=true\"\ncssModules[\"$style\"] = style0\nimport \"./config-rational.vue?vue&type=style&index=1&id=1924bb03&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-1924bb03\"\n\nexport default script","import { render } from \"./config-game-rules.vue?vue&type=template&id=71171d2c\"\nimport script from \"./config-game-rules.vue?vue&type=script&lang=js\"\nexport * from \"./config-game-rules.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <config-autoshift v-model=\"autoshift\" />\n\n  <config-number\n    name=\"Soft drop multiplier\"\n    description=\"Gravity multiplier when soft dropping\"\n    v-model=\"soft_drop\"\n    :filter=\"(v) => v >= 0\"\n  />\n</template>\n\n<script>\nimport { computed } from 'vue';\n\nimport configAutoshift from './config-autoshift';\nimport configNumber from './config-number';\n\nfunction field(emit, target, key, get = v => v, set = v => v) {\n  return computed({\n    get: () => get(target()[key]),\n    set: (value) => {\n      let rules = { ...target(), [key]: set(value) };\n      emit('update:modelValue', rules);\n    },\n  });\n}\n\nexport default {\n  name: 'config-game-rules',\n  components: {\n    configAutoshift,\n    configNumber,\n  },\n\n  emits: ['update:modelValue'],\n  props: {\n    modelValue: Object,\n  },\n\n  setup(props, { emit }) {\n    let autoshift = field(emit, () => props.modelValue, 'autoshift');\n    let soft_drop = field(emit, () => props.modelValue, 'soft_drop');\n\n    return {\n      autoshift,\n      soft_drop,\n    };\n  },\n};\n</script>\n\n<style>\n</style>\n","<template>\n  <config-number\n    name=\"Autoshift delay\"\n    description=\"Delay between repeated shifts while input is held (ARR)\"\n    v-model=\"delay\"\n    :filter=\"(v) => v >= 0\"\n  />\n\n  <config-number\n    name=\"Autoshift initial delay\"\n    description=\"Delay after the initial shift when pressing an input before repeating (DAS)\"\n    v-model=\"initial_delay\"\n    :filter=\"(v) => v >= 0\"\n  />\n</template>\n\n<script>\nimport { computed } from 'vue';\n\nimport configNumber from './config-number';\n\nfunction field(emit, target, key, get = v => v, set = v => v) {\n  return computed({\n    get: () => get(target()[key]),\n    set: (value) => {\n      let rules = { ...target(), [key]: set(value) };\n      emit('update:modelValue', rules);\n    },\n  });\n}\n\nexport default {\n  name: 'config-autoshift',\n  components: {\n    configNumber,\n  },\n\n  emits: ['update:modelValue'],\n  props: {\n    modelValue: Object,\n  },\n\n  setup(props, { emit }) {\n    let delay = field(emit, () => props.modelValue, 'delay');\n    let initial_delay = field(emit, () => props.modelValue, 'initial_delay');\n\n    return {\n      delay,\n      initial_delay,\n    };\n  },\n};\n</script>\n\n<style>\n</style>\n","import { render } from \"./config-autoshift.vue?vue&type=template&id=9dea4428\"\nimport script from \"./config-autoshift.vue?vue&type=script&lang=js\"\nexport * from \"./config-autoshift.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./config-user-prefs.vue?vue&type=template&id=f58b7872\"\nimport script from \"./config-user-prefs.vue?vue&type=script&lang=js\"\nexport * from \"./config-user-prefs.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./edit-config.vue?vue&type=template&id=af689ea0\"\nimport script from \"./edit-config.vue?vue&type=script&lang=js\"\nexport * from \"./edit-config.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <v-dialog :model-value=\"editing\">\n    <edit-config kind=\"game\" v-model=\"game_rules\" @close=\"editing = false\" />\n  </v-dialog>\n\n  <v-flex column grow align-center>\n    <v-card v-if=\"!room.local\">\n      <template v-slot:title>\n        <v-flex grow align-start>\n          <v-text title>Tetris Lobby</v-text>\n\n          <v-grow class=\"mx-6\" />\n          <v-grow class=\"mx-6\" />\n\n          <clipboard :value=\"link\" />\n        </v-flex>\n      </template>\n\n      <v-flex column class=\"pt-4\">\n        <v-flex v-for=\"member in room.members\" :key=\"member\" class=\"pa-3 px-4\">\n          <v-text>{{ member.name }}</v-text>\n        </v-flex>\n      </v-flex>\n\n      <template v-slot:actions v-if=\"room.index == 0\">\n        <v-button text @click=\"editing = true\" class=\"mr-3\">\n          <v-icon class=\"mr-3\">settings</v-icon>\n          <span>Game rules</span>\n        </v-button>\n\n        <v-grow />\n\n        <v-button @click=\"start()\" color=\"primary\">\n          <span>Start game</span>\n        </v-button>\n      </template>\n    </v-card>\n\n    <v-flex v-else>\n      <game :value=\"room.local\" />\n\n      <v-flex>\n        <game v-for=\"member in others\" :key=\"member\" :value=\"member.game\" />\n      </v-flex>\n    </v-flex>\n  </v-flex>\n</template>\n\n<script>\nimport { computed, shallowReactive, shallowRef } from 'vue';\n\nimport { Vec } from '@/vec';\nimport { wall_kicks } from '@/tetris/config';\n\nimport game from '@/ui/game';\nimport clipboard from '@/ui/clipboard';\nimport editConfig from '@/ui/edit-config';\n\nexport default {\n  name: 'room',\n  components: {\n    game,\n    clipboard,\n    editConfig,\n  },\n\n  props: ['room'],\n\n  setup(props) {\n    const base = window.location;\n    const link = computed(() => `${base.origin}${base.pathname}?code=${props.room.code}`);\n\n    const editing = shallowRef(false);\n    const game_rules = shallowReactive({\n      field_size: new Vec(10, 40),\n      fall_delay: 50,\n      lock_delay: 30,\n      move_reset_limit: 15,\n\n      wall_kicks: wall_kicks.standard,\n\n      bag_preview: 5,\n    });\n\n    const others = computed(() => {\n      return props.room.members.filter((_, i) => i != props.room.index);\n    });\n\n    return {\n      link,\n\n      editing,\n      game_rules,\n      others,\n\n      start() {\n        props.room.start_game(game_rules);\n      },\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n</style>\n","<template>\n  <canvas ref=\"canvas\" />\n</template>\n\n<script>\nimport { onMounted, ref, shallowRef, toRef, watch } from 'vue';\n\nimport { render as pixi_render } from '@/tetris/render/pixi';\n\nexport default {\n  name: 'game',\n\n  props: {\n    value: Object,\n  },\n\n  setup(props) {\n    let value = toRef(props, 'value');\n    let canvas = ref(null);\n    let cleanup;\n\n    onMounted(() => {\n      watch(value, (game, v) => {\n        cleanup?.();\n\n        if (game) {\n          cleanup = pixi_render(canvas.value, game);\n        }\n      }, { immediate: true });\n    });\n\n    return { canvas };\n  },\n};\n</script>\n\n<style>\n</style>\n","export const\n  SPACE = 32,\n  ENTER = 13,\n  LEFT = 37,\n  UP = 38,\n  SHIFT = 16,\n  DOWN = 40,\n  RIGHT = 39,\n  A = 65,\n  Z = 90,\n  S = 83,\n  X = 88,\n  C = 67,\n  R = 82;\n\nlet down = new Set<number>();\n\nlet up_listeners = new Map<number, (() => void)[]>();\nlet down_listeners = new Map<number, (() => void)[]>();\n\nwindow.addEventListener('keydown', e => {\n  if (down.has(e.keyCode))\n    return;\n\n  // console.log(e.keyCode);\n  down.add(e.keyCode);\n\n  let list = down_listeners.get(e.keyCode);\n  if (!list) return;\n\n  for (let item of list) {\n    item();\n  }\n});\n\nwindow.addEventListener('keyup', e => {\n  down.delete(e.keyCode);\n\n  let list = up_listeners.get(e.keyCode);\n  if (!list) return;\n\n  for (let item of list) {\n    item();\n  }\n});\n\nexport function isKeyDown(k: number) {\n  return down.has(k);\n}\n\nexport function onKeyDown(key: number, handler: () => void) {\n  let list = down_listeners.get(key);\n  if (!list) down_listeners.set(key, list = []);\n  list.push(handler);\n}\n\nexport function onKeyUp(key: number, handler: () => void) {\n  let list = up_listeners.get(key);\n  if (!list) up_listeners.set(key, list = []);\n  list.push(handler);\n}\n","import alea from 'alea';\nimport { customRef, reactive, shallowReactive, shallowRef } from 'vue';\nimport { Vec } from '@/vec';\nimport { assert } from '@mfro/ts-common/assert';\nimport { A, C, DOWN, isKeyDown, LEFT, onKeyDown, onKeyUp, RIGHT, S, SHIFT, SPACE, UP, X, Z } from '@/input';\nimport { tetronimos } from './config';\nconst down = new Vec(0, 1);\n/** get the absolute positions of all the pieces of a tetronimo */\nexport function pieces(t) {\n    return t.kind.rotations[t.rotation]\n        .map(v => Vec.add(t.position, v));\n}\n/** create an empty row */\nexport function empty_row(rules) {\n    let row = [];\n    for (let x = 0; x < rules.field_size.x; ++x) {\n        row[x] = null;\n    }\n    return row;\n}\n/** create an empty field */\nexport function empty_field(rules) {\n    let field = [];\n    for (let y = 0; y < rules.field_size.y; ++y) {\n        field[y] = empty_row(rules);\n    }\n    return field;\n}\n/** create a new game */\nexport function empty_state(rules, seed = null) {\n    if (seed === null)\n        seed = alea(Math.random()).uint32();\n    return {\n        seed,\n        field: empty_field(rules),\n        falling: null,\n        fall_queue: [],\n        holding: null,\n        hold_available: true,\n        dead: false,\n    };\n}\nexport function reactive_state(inner) {\n    let falling = inner.falling;\n    return reactive({\n        seed: inner.seed,\n        field: inner.field.map(row => shallowReactive(row)),\n        falling: customRef((track, trigger) => ({\n            get: () => { track(); return falling; },\n            set: (v) => { falling = v && shallowReactive(v); trigger(); },\n        })),\n        fall_queue: shallowReactive([]),\n        holding: shallowRef(null),\n        hold_available: inner.hold_available,\n        dead: inner.dead,\n    });\n}\nexport function new_game(rules, state) {\n    let next_id = 0;\n    let holding = false;\n    function collide(t) {\n        for (let part of pieces(t)) {\n            if (part.x < 0 || part.x >= rules.field_size.x || part.y >= rules.field_size.y)\n                return true;\n            if (part.y < 0)\n                continue;\n            let tile = state.field[part.y][part.x];\n            if (tile != null)\n                return true;\n        }\n        return false;\n    }\n    function hard_drop_position(t) {\n        let bottom = t.position;\n        while (true) {\n            let position = Vec.add(bottom, down);\n            if (collide(Object.assign(Object.assign({}, t), { position })))\n                break;\n            bottom = position;\n        }\n        return bottom;\n    }\n    function hold() {\n        var _a, _b;\n        if (state.dead || state.falling == null)\n            return;\n        let next_fall = state.holding;\n        state.holding = (_b = (_a = state.falling) === null || _a === void 0 ? void 0 : _a.kind) !== null && _b !== void 0 ? _b : null;\n        if (next_fall) {\n            state.fall_queue.unshift(next_fall);\n        }\n        state.falling = null;\n        state.hold_available = false;\n        holding = true;\n    }\n    function drop(distance) {\n        if (state.dead || state.falling == null)\n            return 0;\n        for (let i = 0; i < distance; ++i) {\n            let position = Vec.add(state.falling.position, down);\n            if (collide(Object.assign(Object.assign({}, state.falling), { position })))\n                return i;\n            state.falling.position = position;\n        }\n        return distance;\n    }\n    function shift(dir) {\n        if (state.dead || state.falling == null)\n            return false;\n        let position = Vec.add(state.falling.position, new Vec(dir, 0));\n        if (!collide(Object.assign(Object.assign({}, state.falling), { position }))) {\n            state.falling.position = position;\n            return true;\n        }\n        return false;\n    }\n    function rotate(dir) {\n        if (state.dead || state.falling == null)\n            return false;\n        let rotation = (state.falling.rotation + dir) % 4;\n        if (rotation < 0)\n            rotation += 4;\n        let kick_info = rules.wall_kicks.get(state.falling.kind);\n        assert(kick_info != null, `no kick info for piece`);\n        let kicks;\n        if (dir == 1)\n            kicks = kick_info[state.falling.rotation * 2];\n        else\n            kicks = kick_info[rotation * 2 + 1];\n        for (let kick of kicks) {\n            let position = Vec.add(state.falling.position, kick);\n            if (!collide(Object.assign(Object.assign({}, state.falling), { position, rotation }))) {\n                state.falling.position = position;\n                state.falling.rotation = rotation;\n                return true;\n            }\n        }\n        return false;\n    }\n    function lock_down() {\n        if (state.dead || state.falling == null)\n            return;\n        for (let part of pieces(state.falling)) {\n            state.field[part.y][part.x] = {\n                id: state.falling.id,\n                kind: state.falling.kind,\n            };\n        }\n        let cleared = 0;\n        for (let y = 0; y < rules.field_size.y; ++y) {\n            if (state.field[y].every(t => t != null)) {\n                for (let i = y; i > 0; --i) {\n                    Object.assign(state.field[i], state.field[i - 1]);\n                }\n                Object.assign(state.field[0], empty_row(rules));\n                cleared += 1;\n            }\n        }\n        if (cleared > 0) {\n            console.log(`cleared ${cleared} lines`);\n        }\n    }\n    function new_falling() {\n        if (state.dead)\n            return false;\n        if (state.fall_queue.length - 1 < rules.bag_preview) {\n            let random = alea(state.seed);\n            state.seed = random.uint32();\n            let pool = tetronimos.all.slice();\n            while (pool.length > 0) {\n                let i = Math.floor(random() * pool.length);\n                let kind = pool.splice(i, 1)[0];\n                state.fall_queue.push(kind);\n            }\n        }\n        let kind = state.fall_queue[0];\n        let position = new Vec(5 - Math.ceil(kind.size / 2), rules.field_size.y / 2 - 2);\n        let rotation = 0;\n        let falling = { id: next_id++, kind, position, rotation };\n        state.hold_available = !holding;\n        holding = false;\n        if (collide(falling)) {\n            return false;\n        }\n        else {\n            state.fall_queue.shift();\n            state.falling = falling;\n            return true;\n        }\n    }\n    function end_game() {\n        state.dead = true;\n        state.falling = null;\n    }\n    return {\n        rules, state,\n        collide,\n        hard_drop_position,\n        hold,\n        drop,\n        shift,\n        rotate,\n        lock_down,\n        new_falling,\n        end_game,\n    };\n}\nexport function play(user, game) {\n    let move_reset = 0;\n    let lock_progress = 0;\n    let fall_progress = 0;\n    let repeating = false;\n    let shift_left = false;\n    let shift_right = false;\n    let repeat_shift = 0;\n    let repeat_delay = 0;\n    new_falling();\n    /** generate a new falling tetronimo, filling the bag if needed */\n    function new_falling() {\n        var _a;\n        if (game.state.dead)\n            return;\n        if (game.new_falling()) {\n            move_reset = (_a = game.rules.move_reset_limit) !== null && _a !== void 0 ? _a : Infinity;\n            try_drop();\n        }\n        else {\n            game.end_game();\n        }\n    }\n    /** determine if the falling piece is resting on the ground */\n    function is_on_ground(t) {\n        let position = Vec.add(t.position, down);\n        return game.collide(Object.assign(Object.assign({}, t), { position }));\n    }\n    /** lock down the falling tetronimo */\n    function lock_down() {\n        game.lock_down();\n        new_falling();\n    }\n    /** try to drop the falling tetronimo one tile */\n    function try_drop() {\n        var _a;\n        if (game.state.dead || game.state.falling == null)\n            return;\n        fall_progress = 0;\n        if (game.drop(1) > 0) {\n            move_reset = (_a = game.rules.move_reset_limit) !== null && _a !== void 0 ? _a : Infinity;\n        }\n    }\n    /** reset the lock_delay, consuming a move reset */\n    function try_move_reset() {\n        if (game.state.dead || game.state.falling == null)\n            return;\n        if (lock_progress > 0 && move_reset > 0) {\n            move_reset -= 1;\n            lock_progress = 0;\n        }\n    }\n    /** hold a piece */\n    function hold() {\n        if (!game.state.hold_available)\n            return;\n        game.hold();\n        new_falling();\n    }\n    /** attempt to shift the falling tetronimo */\n    function shift(change) {\n        if (game.state.dead || game.state.falling == null)\n            return;\n        if (game.shift(change)) {\n            try_move_reset();\n            if (user.autoshift) {\n                repeat_delay = repeating\n                    ? user.autoshift.delay\n                    : user.autoshift.initial_delay;\n                repeating = true;\n            }\n        }\n    }\n    /** attempt to rotate the falling tetronimo */\n    function rotate(change) {\n        if (game.state.dead || game.state.falling == null)\n            return;\n        if (game.rotate(change)) {\n            try_move_reset();\n            return;\n        }\n    }\n    /** hard drop the falling tetronimo */\n    function hard_drop() {\n        if (game.state.dead || game.state.falling == null)\n            return;\n        game.drop(20);\n        lock_down();\n    }\n    /** shift input handler */\n    function press_shift(dir) {\n        if (game.state.dead || game.state.falling == null)\n            return;\n        repeating = false;\n        if (dir == 1)\n            shift_right = true;\n        else\n            shift_left = true;\n        repeat_shift = dir;\n        shift(dir);\n    }\n    /** shift input handler */\n    function release_shift(dir) {\n        if (game.state.dead || game.state.falling == null)\n            return;\n        if (dir == 1)\n            shift_right = false;\n        else\n            shift_left = false;\n        if (user.autoshift && repeat_shift == dir) {\n            repeat_delay = repeating\n                ? user.autoshift.delay\n                : user.autoshift.initial_delay;\n        }\n        repeat_shift = shift_left ? -1 : shift_right ? 1 : 0;\n    }\n    onKeyDown(Z, () => rotate(-1));\n    onKeyDown(A, () => rotate(-1));\n    onKeyDown(X, () => rotate(1));\n    onKeyDown(S, () => rotate(1));\n    onKeyDown(UP, () => rotate(1));\n    onKeyUp(LEFT, () => release_shift(-1));\n    onKeyDown(LEFT, () => press_shift(-1));\n    onKeyUp(RIGHT, () => release_shift(1));\n    onKeyDown(RIGHT, () => press_shift(1));\n    // onKeyDown(DOWN, () => try_drop());\n    onKeyDown(SPACE, () => hard_drop());\n    onKeyDown(C, () => hold());\n    onKeyDown(SHIFT, () => hold());\n    let cancel = setInterval(update, 1000 / 60);\n    function update() {\n        var _a;\n        if (game.state.dead) {\n            return clearInterval(cancel);\n        }\n        if (repeat_delay > 0) {\n            repeat_delay -= 1;\n        }\n        else if (user.autoshift && repeat_shift != 0) {\n            shift(repeat_shift);\n        }\n        if (game.state.falling != null) {\n            if (is_on_ground(game.state.falling)) {\n                lock_progress += 1 / game.rules.lock_delay;\n                fall_progress = Math.min(fall_progress, Math.ceil(1 / game.rules.fall_delay));\n                if (lock_progress >= 1) {\n                    fall_progress = 0;\n                    lock_progress = 0;\n                    lock_down();\n                }\n            }\n            else {\n                if (isKeyDown(DOWN))\n                    fall_progress += 1 / game.rules.fall_delay * user.soft_drop;\n                else\n                    fall_progress += 1 / game.rules.fall_delay;\n                if (fall_progress > 1) {\n                    let drop = Math.floor(fall_progress);\n                    let move = game.drop(drop);\n                    if (move > 0)\n                        move_reset = (_a = game.rules.move_reset_limit) !== null && _a !== void 0 ? _a : Infinity;\n                    if (move == drop)\n                        fall_progress -= drop;\n                    else\n                        fall_progress = 0;\n                }\n            }\n        }\n    }\n    return () => clearInterval(cancel);\n}\n","import { Vec } from '@/vec';\nimport { assert } from '@mfro/ts-common/assert';\n\nimport { TetronimoKind, Tetronimo, pieces, Game } from '..';\nimport { tetronimos } from '../config';\n\n/** draw a single tile of a tetronimo */\nexport const draw_styles = {\n  v1(context: CanvasRenderingContext2D, position: Vec, kind: TetronimoKind, surroundings: boolean[], style: TileStyle) {\n    const colors = new Map([\n      [tetronimos.I, '#31c7ef'],\n      [tetronimos.O, '#e39f02'],\n      [tetronimos.T, '#af298a'],\n      [tetronimos.J, '#2141c6'],\n      [tetronimos.L, '#e35b02'],\n      [tetronimos.S, '#59b101'],\n      [tetronimos.Z, '#d70f37'],\n    ]);\n\n    const p = position;\n\n    context.save();\n    if (style == TileStyle.ghost) {\n      context.fillStyle = 'white';\n      context.fillRect(p.x, p.y, 1, 1);\n    } else if (style == TileStyle.disabled) {\n      context.filter = 'grayscale(100%)';\n    } else {\n      let color = colors.get(kind);\n      assert(color != null, `no color for piece`);\n      context.fillStyle = color;\n      context.fillRect(p.x, p.y, 1, 1);\n    }\n\n    const border = 1 / 8;\n\n    context.beginPath();\n    context.lineCap = 'butt';\n    context.lineWidth = border;\n    context.strokeStyle = '#00000040';\n\n    if (surroundings[0]) {\n      context.moveTo(p.x, p.y + border / 2);\n      context.lineTo(p.x + border / 2, p.y + border / 2);\n      context.lineTo(p.x + border / 2, p.y);\n    }\n\n    if (surroundings[1]) {\n      context.moveTo(p.x, p.y + border / 2);\n      context.lineTo(p.x + 1, p.y + border / 2);\n    }\n\n    if (surroundings[2]) {\n      context.moveTo(p.x + 1 - border / 2, p.y);\n      context.lineTo(p.x + 1 - border / 2, p.y + border / 2);\n      context.lineTo(p.x + 1, p.y + border / 2);\n    }\n\n    if (surroundings[3]) {\n      context.moveTo(p.x - border / 2 + 1, p.y);\n      context.lineTo(p.x - border / 2 + 1, p.y + 1);\n    }\n\n    if (surroundings[4]) {\n      context.moveTo(p.x + 1, p.y + 1 - border / 2);\n      context.lineTo(p.x + 1 - border / 2, p.y + 1 - border / 2);\n      context.lineTo(p.x + 1 - border / 2, p.y + 1);\n    }\n\n    if (surroundings[5]) {\n      context.moveTo(p.x + 1, p.y - border / 2 + 1);\n      context.lineTo(p.x, p.y - border / 2 + 1);\n    }\n\n    if (surroundings[6]) {\n      context.moveTo(p.x + border / 2, p.y + 1);\n      context.lineTo(p.x + border / 2, p.y + 1 - border / 2);\n      context.lineTo(p.x, p.y + 1 - border / 2);\n    }\n\n    if (surroundings[7]) {\n      context.moveTo(p.x + border / 2, p.y + 1);\n      context.lineTo(p.x + border / 2, p.y);\n    }\n\n    // context.strokeStyle = kind.color;\n    // context.stroke();\n\n    context.strokeStyle = '#00000040';\n    context.stroke();\n\n    context.filter = 'none';\n    context.restore();\n  },\n\n  v2(context: CanvasRenderingContext2D, position: Vec, kind: TetronimoKind, surroundings: boolean[], style: TileStyle) {\n    const border = 1 / 8;\n\n    const colors = new Map([\n      [tetronimos.I, ['#31c7ef', '#48e0ff', '#20b0e0']],\n      [tetronimos.O, ['#f7d308', '#ffec1c', '#e8c000']],\n      [tetronimos.T, ['#ad4d9c', '#c658b4', '#983888']],\n      [tetronimos.J, ['#5a65ad', '#6680cc', '#4857a0']],\n      [tetronimos.L, ['#ef7921', '#ff9030', '#e06810']],\n      [tetronimos.S, ['#42b642', '#48d048', '#30a030']],\n      [tetronimos.Z, ['#ef2029', '#ff4848', '#d01818']],\n    ]);\n\n    const p = position;\n\n    let color = colors.get(kind);\n    assert(color != null, `no color for piece`);\n\n    context.save();\n    if (style == TileStyle.ghost) {\n      context.fillStyle = 'white';\n      context.fillRect(p.x, p.y, 1, 1);\n      context.globalAlpha = 0.4;\n    } else if (style == TileStyle.disabled) {\n      context.filter = 'grayscale(100%)';\n    }\n\n    context.translate(p.x, p.y);\n\n    const left_inner = border;\n    const left_outer = border / 2;\n    const right_inner = 1 - border;\n    const right_outer = 1 - border / 2;\n\n    context.fillStyle = color[0];\n    context.fillRect(left_inner, left_inner, 1 - 2 * border, 1 - 2 * border);\n\n    context.lineCap = 'butt';\n    context.lineWidth = border;\n\n    context.beginPath();\n    context.moveTo(left_outer, right_inner);\n    context.lineTo(left_outer, left_inner);\n    context.strokeStyle = surroundings[7] ? color[1] : color[0];\n    context.stroke();\n\n    context.beginPath();\n    context.moveTo(left_inner, left_outer);\n    context.lineTo(right_inner, left_outer);\n    context.strokeStyle = surroundings[1] ? color[1] : color[0];\n    context.stroke();\n\n    context.beginPath();\n    context.moveTo(0, left_outer);\n    context.lineTo(left_outer, left_outer);\n    context.lineTo(left_outer, 0);\n    context.strokeStyle = surroundings[0] || surroundings[7] || surroundings[1] ? color[1] : color[0];\n    context.stroke();\n\n    context.beginPath();\n    context.moveTo(right_outer, left_inner);\n    context.lineTo(right_outer, right_inner);\n    context.strokeStyle = surroundings[3] ? color[2] : color[0];\n    context.stroke();\n\n    context.beginPath();\n    context.moveTo(right_inner, right_outer);\n    context.lineTo(left_inner, right_outer);\n    context.strokeStyle = surroundings[5] ? color[2] : color[0];\n    context.stroke();\n\n    context.beginPath();\n    context.moveTo(1, right_outer);\n    context.lineTo(right_outer, right_outer);\n    context.lineTo(right_outer, 1);\n    context.strokeStyle = surroundings[4] || surroundings[3] || surroundings[5] ? color[2] : color[0];\n    context.stroke();\n\n    context.beginPath();\n    context.moveTo(right_outer, 0);\n    context.lineTo(right_outer, left_outer);\n    context.lineTo(1, left_outer);\n    context.strokeStyle = surroundings[2] && surroundings[1] && surroundings[3] ? color[0]\n      : surroundings[1] ? color[1]\n        : surroundings[3] ? color[2]\n          : surroundings[2] ? color[2]\n            : color[0];\n    context.stroke();\n\n    context.beginPath();\n    context.moveTo(left_outer, 1);\n    context.lineTo(left_outer, right_outer);\n    context.lineTo(0, right_outer);\n    context.strokeStyle = surroundings[6] && surroundings[7] && surroundings[5] ? color[0]\n      : surroundings[7] ? color[1]\n        : surroundings[5] ? color[2]\n          : surroundings[6] ? color[1]\n            : color[0];\n    context.stroke();\n\n    context.filter = 'none';\n    context.restore();\n  },\n};\n\nexport enum TileStyle {\n  normal,\n  ghost,\n  disabled,\n}\n\nconst IMAGE_STRIDE = 256;\nexport function image_offset(around: boolean[], style: TileStyle, size: number) {\n  let index = style << 8;\n\n  for (let i = 0; i < 8; ++i) {\n    if (around[i]) {\n      index |= (1 << i);\n    }\n  }\n\n  // return Vec.scale(new Vec(x, style), size);\n  return Vec.scale(new Vec(index % IMAGE_STRIDE, Math.floor(index / IMAGE_STRIDE)), size);\n}\n\ninterface ImageCache {\n  hash: string;\n  list: string[];\n}\n\nexport function render_tilesheets(size: number, render: (context: CanvasRenderingContext2D, position: Vec, kind: TetronimoKind, around: boolean[], style: TileStyle) => void, callback: (s: string[]) => void) {\n  let bytes = new TextEncoder().encode(render.toString());\n  window.crypto.subtle.digest('SHA-256', bytes).then(hash_raw => {\n    let hash = Array.from(new Uint8Array(hash_raw))\n      .map(b => b.toString(16).padStart(2, '0'))\n      .join('');\n\n    let raw = localStorage.getItem('mfro:tetris-tilesheet');\n    if (raw) {\n      let cache: ImageCache = JSON.parse(raw);\n      if (cache.hash == hash) {\n        // console.log(`tilesheet hash match ${hash}`);\n        callback(cache.list);\n        return;\n      } else {\n        console.log(`tilesheet hash match ${cache.hash} expected ${hash}`);\n      }\n    }\n\n    const styles = [TileStyle.normal, TileStyle.ghost, TileStyle.disabled];\n\n    let canvas = document.createElement('canvas');\n    canvas.width = size * IMAGE_STRIDE;\n    canvas.height = size * styles.length * (256 / IMAGE_STRIDE);\n\n    let context = canvas.getContext('2d');\n    assert(context != null, 'no context');\n\n    context.scale(size, size);\n\n    let list: string[] = [];\n\n    for (let kind of tetronimos.all) {\n      context!.clearRect(0, 0, canvas.width, canvas.height);\n\n      for (let style of styles) {\n        for (let i = 0; i < 256; ++i) {\n          let around = [];\n          for (let j = 0; j < 8; ++j) around[j] = (i & (1 << j)) != 0;\n\n          let offset = image_offset(around, style, 1);\n          render(context!, offset, kind, around, style);\n        }\n      }\n\n      let url = canvas.toDataURL();\n      list.push(url);\n      if (list.length == tetronimos.all.length) {\n        localStorage.setItem('mfro:tetris-tilesheet', JSON.stringify({ hash, list }))\n        callback(list);\n      }\n    }\n  });\n}\n\nfunction prerender(size: number, render: (context: CanvasRenderingContext2D, position: Vec, kind: TetronimoKind, around: boolean[], style: TileStyle) => void) {\n  let images: HTMLImageElement[] = [];\n  // let images = render_tilesheets(size, render).map(s => {\n  //   let image = new Image();\n  //   image.src = s;\n  //   return image;\n  // });\n\n  return (context: CanvasRenderingContext2D, position: Vec, kind: TetronimoKind, around: boolean[], style: TileStyle) => {\n    let sheet = images[tetronimos.all.indexOf(kind)];\n    let offset = image_offset(around, style, size);\n\n    context.drawImage(sheet, offset.x, offset.y, size, size, position.x, position.y, 1, 1)\n  };\n}\n\nexport function render(canvas: HTMLCanvasElement, game: Game) {\n  const unit_size = 32;\n  const pixel = 1 / unit_size;\n\n  // const render_tile = draw_tile.v2;\n  const render_tile = prerender(unit_size, draw_styles.v2);\n\n  canvas.width = (game.rules.field_size.x + 12) * unit_size;\n  canvas.height = (game.rules.field_size.y / 2) * unit_size;\n  canvas.style.width = `${canvas.width}px`;\n  canvas.style.height = `${canvas.height}px`;\n\n  const context = canvas.getContext('2d')!;\n  assert(context != null, 'no context');\n\n  context.imageSmoothingEnabled = false;\n\n  function tile_at(pos: Vec) {\n    if (pos.x < 0 || pos.x >= game.rules.field_size.x\n      || pos.y < 0 || pos.y >= game.rules.field_size.y)\n      return null;\n\n    return game.state.field[pos.y][pos.x];\n  }\n\n  const adj8 = [\n    new Vec(-1, -1),\n    new Vec(0, -1),\n    new Vec(1, -1),\n    new Vec(1, 0),\n    new Vec(1, 1),\n    new Vec(0, 1),\n    new Vec(-1, 1),\n    new Vec(-1, 0),\n  ];\n\n  /** draw a a tetronimo */\n  function draw_tetronimo(t: Tetronimo, style: TileStyle) {\n    for (let offset of t.kind.rotations[t.rotation]) {\n      let position = Vec.add(t.position, offset);\n\n      let diff = adj8.map(adj =>\n        t.kind.rotations[t.rotation]\n          .every(v => !Vec.eq(v, Vec.add(offset, adj)))\n      );\n\n      render_tile(context, position, t.kind, diff, style);\n    }\n  }\n\n  /** draw a tetronimo in the UI */\n  function draw_ui(kinds: TetronimoKind[], center: Vec) {\n    let topleft = Vec.add(center, new Vec(-2, -2));\n    let botrite = Vec.add(center, new Vec(2, -1 + 3 * kinds.length));\n\n    context.lineCap = 'butt';\n    context.lineJoin = 'miter';\n    context.strokeStyle = 'gray'\n    context.beginPath();\n\n    const thickness = 2 * pixel;\n    const length = 8 * pixel;\n\n    context.lineWidth = thickness;\n\n    context.moveTo(topleft.x + thickness / 2, topleft.y + length);\n    context.lineTo(topleft.x + thickness / 2, topleft.y + thickness / 2);\n    context.lineTo(topleft.x + length, topleft.y + thickness / 2);\n\n    context.moveTo(botrite.x - length, topleft.y + thickness / 2);\n    context.lineTo(botrite.x - thickness / 2, topleft.y + thickness / 2);\n    context.lineTo(botrite.x - thickness / 2, topleft.y + length);\n\n    context.moveTo(botrite.x - thickness / 2, botrite.y - length);\n    context.lineTo(botrite.x - thickness / 2, botrite.y - thickness / 2);\n    context.lineTo(botrite.x - length, botrite.y - thickness / 2);\n\n    context.moveTo(topleft.x + length, botrite.y - thickness / 2);\n    context.lineTo(topleft.x + thickness / 2, botrite.y - thickness / 2);\n    context.lineTo(topleft.x + thickness / 2, botrite.y - length);\n\n    context.stroke();\n\n    for (let kind of kinds) {\n      let parts = pieces({ id: -1, kind, position: Vec.zero, rotation: 0 });\n\n      let minX = parts.reduce((m, v) => Math.min(m, v.x), Infinity) + 0.5;\n      let minY = parts.reduce((m, v) => Math.min(m, v.y), Infinity) + 0.5;\n      let maxX = parts.reduce((m, v) => Math.max(m, v.x), -Infinity) + 0.5;\n      let maxY = parts.reduce((m, v) => Math.max(m, v.y), -Infinity) + 0.5;\n\n      let offset = new Vec(-(minX + maxX) / 2, -(minY + maxY) / 2);\n      let position = Vec.add(center, offset);\n\n      draw_tetronimo({ id: -1, kind, position, rotation: 0 }, TileStyle.normal);\n\n      center = Vec.add(center, new Vec(0, 3));\n    }\n  }\n\n  requestAnimationFrame(tick);\n  function tick() {\n    requestAnimationFrame(tick);\n\n    context.clearRect(0, 0, canvas.width, canvas.height);\n    context.save();\n\n    context.scale(unit_size, unit_size);\n    context.translate(6, 0);\n\n    if (game.state.holding) {\n      context.save();\n      draw_ui([game.state.holding], new Vec(-3, 3));\n      context.restore();\n    }\n\n    if (game.rules.bag_preview > 0) {\n      draw_ui(game.state.fall_queue.slice(0, game.rules.bag_preview), new Vec(game.rules.field_size.x + 3, 3));\n    }\n\n    context.fillStyle = 'white';\n    context.fillRect(0, 0, game.rules.field_size.x, game.rules.field_size.y);\n\n    context.lineWidth = 1 * pixel;\n    context.strokeStyle = '#f4f4f4';\n    for (let x = 0; x < game.rules.field_size.x; ++x) {\n      context.beginPath();\n      context.moveTo(x + 0.5 * pixel, 0);\n      context.lineTo(x + 0.5 * pixel, game.rules.field_size.y);\n      context.moveTo((x + 1) - 0.5 * pixel, 0);\n      context.lineTo((x + 1) - 0.5 * pixel, game.rules.field_size.y);\n      context.stroke();\n    }\n\n    for (let y = 0; y < game.rules.field_size.y; ++y) {\n      context.beginPath();\n      context.moveTo(0, y + 0.5 * pixel);\n      context.lineTo(game.rules.field_size.x, y + 0.5 * pixel);\n      context.moveTo(0, (y + 1) - 0.5 * pixel);\n      context.lineTo(game.rules.field_size.x, (y + 1) - 0.5 * pixel);\n      context.stroke();\n    }\n\n    context.translate(0, -game.rules.field_size.y / 2);\n\n    if (game.state.falling) {\n      let position = game.hard_drop_position(game.state.falling);\n      draw_tetronimo({ ...game.state.falling, position }, TileStyle.ghost);\n\n      draw_tetronimo(game.state.falling, TileStyle.normal);\n    }\n\n    for (let x = 0; x < game.rules.field_size.x; ++x) {\n      for (let y = 0; y < game.rules.field_size.y; ++y) {\n        let t = game.state.field[y][x];\n        if (t == null) continue;\n\n        let position = new Vec(x, y);\n\n        let diff = adj8.map(adj => tile_at(Vec.add(position, adj))?.id != t!.id);\n\n        render_tile(context, new Vec(x, y), game.state.field[y][x]!.kind, diff, TileStyle.normal);\n      }\n    }\n\n    context.restore();\n  }\n}\n","import { Application, BaseTexture, Container, Graphics, Point, Rectangle, Sprite, Texture } from 'pixi.js';\nimport { watch, watchEffect } from 'vue';\n\nimport { Vec } from '@/vec';\n\nimport { TetronimoKind, Game, Tetronimo, pieces } from '..';\nimport { tetronimos } from '../config';\n\nimport { draw_styles, image_offset, render_tilesheets, TileStyle } from './basic';\n\nconst adj8 = [\n  new Vec(-1, -1),\n  new Vec(0, -1),\n  new Vec(1, -1),\n  new Vec(1, 0),\n  new Vec(1, 1),\n  new Vec(0, 1),\n  new Vec(-1, 1),\n  new Vec(-1, 0),\n];\n\nexport function render(canvas: HTMLCanvasElement, game: Game) {\n  const unit_size = 32;\n  const pixel = 1 / unit_size;\n\n  const textures = new Map<TetronimoKind, BaseTexture>();\n\n  canvas.width = (game.rules.field_size.x + 12) * unit_size;\n  canvas.height = (game.rules.field_size.y / 2) * unit_size;\n  canvas.style.width = `${canvas.width}px`;\n  canvas.style.height = `${canvas.height}px`;\n\n  function tile_at(pos: Vec) {\n    if (pos.x < 0 || pos.x >= game.rules.field_size.x\n      || pos.y < 0 || pos.y >= game.rules.field_size.y)\n      return null;\n\n    return game.state.field[pos.y][pos.x];\n  }\n\n  function draw_tile(position: Vec, kind: TetronimoKind, around: boolean[], style: TileStyle) {\n    let base = textures.get(kind)!;\n    let index = image_offset(around, style, unit_size);\n\n    let sprite = new Sprite();\n    sprite.scale = new Point(1 / unit_size, 1 / unit_size);\n    sprite.texture = new Texture(base, new Rectangle(index.x, index.y, unit_size, unit_size));\n    sprite.position = new Point(position.x, position.y);\n\n    return sprite;\n  }\n\n  class SpritePool {\n    sprites: Sprite[] = [];\n\n    constructor(\n      readonly container: Container,\n    ) { }\n\n    clear() {\n      for (let sprite of this.sprites)\n        this.container.removeChild(sprite);\n      this.sprites = [];\n    }\n\n    draw_tetronimo(t: Tetronimo, style: TileStyle) {\n      let offsets = t.kind.rotations[t.rotation];\n\n      for (let offset of t.kind.rotations[t.rotation]) {\n        let position = Vec.add(t.position, offset);\n\n        let around = adj8.map(adj =>\n          offsets\n            .every(v => !Vec.eq(v, Vec.add(offset, adj)))\n        );\n\n        let sprite = draw_tile(position, t.kind, around, style);\n        this.sprites.push(sprite);\n        this.container.addChild(sprite);\n      }\n    }\n  }\n\n  function draw_ui(src: () => (TetronimoKind | null)[]) {\n    let size = src().length;\n\n    let field = new Container();\n    // field.scale = new Point(1, unit_size);\n\n    let g = new Graphics();\n    field.addChild(g);\n    g.scale = new Point(1 / unit_size, 1 / unit_size);\n\n    let topleft = Vec.scale(new Vec(0, 0), unit_size);\n    let botrite = Vec.scale(new Vec(4, 1 + 3 * size), unit_size);\n\n    const thickness = 2;\n    const length = 8;\n\n    g.lineStyle(thickness, 0x808080, 1, 0);\n\n    g.moveTo(topleft.x, topleft.y + length);\n    g.lineTo(topleft.x, topleft.y);\n    g.lineTo(topleft.x + length, topleft.y);\n\n    g.moveTo(botrite.x - length, topleft.y);\n    g.lineTo(botrite.x, topleft.y);\n    g.lineTo(botrite.x, topleft.y + length);\n\n    g.moveTo(botrite.x, botrite.y - length);\n    g.lineTo(botrite.x, botrite.y);\n    g.lineTo(botrite.x - length, botrite.y);\n\n    g.moveTo(topleft.x + length, botrite.y);\n    g.lineTo(topleft.x, botrite.y);\n    g.lineTo(topleft.x, botrite.y - length);\n\n    let pool = new SpritePool(field);\n    watch(() => [src(), game.state.hold_available] as const, ([list, hold_available]) => {\n      pool.clear();\n\n      let center = new Vec(2, 2);\n\n      for (let kind of list) {\n        if (!kind) continue;\n\n        let parts = pieces({ id: -1, kind, position: Vec.zero, rotation: 0 });\n\n        let minX = parts.reduce((m, v) => Math.min(m, v.x), Infinity) + 0.5;\n        let minY = parts.reduce((m, v) => Math.min(m, v.y), Infinity) + 0.5;\n        let maxX = parts.reduce((m, v) => Math.max(m, v.x), -Infinity) + 0.5;\n        let maxY = parts.reduce((m, v) => Math.max(m, v.y), -Infinity) + 0.5;\n\n        let offset = new Vec(-(minX + maxX) / 2, -(minY + maxY) / 2);\n        let position = Vec.add(center, offset);\n\n        let style = list.length == 1 && !hold_available ? TileStyle.disabled : TileStyle.normal;\n\n        pool.draw_tetronimo({ id: -1, kind, position, rotation: 0 }, style);\n        center = Vec.add(center, new Vec(0, 3));\n      }\n    }, { immediate: true });\n\n    return field;\n  }\n\n  function draw_background(g: Graphics) {\n    g.beginFill(0xFFFFFF);\n    g.drawRect(0, 0, game.rules.field_size.x, game.rules.field_size.y);\n    g.endFill();\n\n    g.lineStyle(pixel, 0xf4f4f4);\n    for (let x = 0; x < game.rules.field_size.x; ++x) {\n      g.moveTo(x + 0.5 * pixel, 0);\n      g.lineTo(x + 0.5 * pixel, game.rules.field_size.y);\n      g.moveTo((x + 1) - 0.5 * pixel, 0);\n      g.lineTo((x + 1) - 0.5 * pixel, game.rules.field_size.y);\n    }\n\n    for (let y = 0; y < game.rules.field_size.y; ++y) {\n      g.moveTo(0, y + 0.5 * pixel);\n      g.lineTo(game.rules.field_size.x, y + 0.5 * pixel);\n      g.moveTo(0, (y + 1) - 0.5 * pixel);\n      g.lineTo(game.rules.field_size.x, (y + 1) - 0.5 * pixel);\n    }\n  }\n\n  const app = new Application({\n    view: canvas,\n    width: unit_size * (game.rules.field_size.x + 12),\n    height: unit_size * (game.rules.field_size.y / 2),\n    transparent: true,\n  });\n\n  // let s = performance.now();\n  render_tilesheets(unit_size, draw_styles.v2, tilesheets => {\n    // let e = performance.now();\n    // console.log(e - s);\n    tilesheets.forEach((sheet, i) => {\n      app.loader.add(i.toString(), sheet);\n    });\n    app.loader.load();\n  });\n\n  app.loader.onLoad.once(() => {\n    for (let i = 0; i < 7; ++i) {\n      let base = app.loader.resources[i]!.texture.baseTexture;\n      textures.set(tetronimos.all[i], base);\n    }\n\n    const root = new Container();\n    root.scale = new Point(unit_size, unit_size);\n\n    const field = new Container();\n    field.position = new Point(6, (-game.rules.field_size.y / 2));\n\n    const background = new Graphics();\n    draw_background(background);\n\n    const holding = draw_ui(() => [game.state.holding]);\n    holding.position = new Point(1, 1);\n\n    const queue = draw_ui(() => game.state.fall_queue.slice(0, 5));\n    queue.position = new Point((7 + game.rules.field_size.x), 1);\n\n    field.addChild(background);\n    root.addChild(field);\n    root.addChild(queue);\n    root.addChild(holding);\n    app.stage.addChild(root);\n\n    for (let x = 0; x < game.rules.field_size.x; ++x) {\n      for (let y = 0; y < game.rules.field_size.y; ++y) {\n        let position = new Vec(x, y);\n        let sprite: Sprite | null = null;\n\n        watchEffect(() => {\n          if (sprite != null) {\n            field.removeChild(sprite);\n            sprite = null;\n          }\n\n          let t = game.state.field[y][x];\n          if (t != null) {\n            let around = adj8.map(adj => tile_at(Vec.add(position, adj))?.id != t!.id);\n            sprite = draw_tile(new Vec(x, y), t.kind, around, TileStyle.normal);\n            field.addChild(sprite);\n          }\n        });\n      }\n    }\n\n    let falling = new SpritePool(field);\n    watchEffect(() => {\n      falling.clear();\n\n      if (game.state.falling) {\n        let position = game.hard_drop_position(game.state.falling);\n        let ghost = { ...game.state.falling, position };\n        falling.draw_tetronimo(ghost, TileStyle.ghost);\n        falling.draw_tetronimo(game.state.falling, TileStyle.normal);\n      }\n    });\n  });\n\n  return () => app.destroy();\n}\n","import { render } from \"./game.vue?vue&type=template&id=273dad7b\"\nimport script from \"./game.vue?vue&type=script&lang=js\"\nexport * from \"./game.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","<template>\n  <v-flex align-center justify-center>\n    <v-button small icon @click=\"copy()\" @mouseleave=\"copied = false\">\n      <v-icon small v-if=\"!copied\">content_paste</v-icon>\n      <v-icon small v-else bold style=\"color: #4caf50\">check</v-icon>\n    </v-button>\n\n    <v-text-field small class=\"mt-0 ml-4\" ref=\"input\" solo :model-value=\"value\" />\n  </v-flex>\n</template>\n\n<script>\nimport { shallowRef } from 'vue';\n\nexport default {\n  name: 'clipboard',\n\n  props: {\n    value: String,\n  },\n\n  setup(props) {\n    const input = shallowRef(null);\n    const copied = shallowRef(false);\n\n    return {\n      input, copied,\n      copy: () => {\n        input.value.select();\n        document.execCommand('copy');\n        copied.value = true;\n      },\n    };\n  },\n};\n</script>\n\n<style>\n</style>\n","import { render } from \"./clipboard.vue?vue&type=template&id=2cfc999b\"\nimport script from \"./clipboard.vue?vue&type=script&lang=js\"\nexport * from \"./clipboard.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./room.vue?vue&type=template&id=5479d942&scoped=true\"\nimport script from \"./room.vue?vue&type=script&lang=js\"\nexport * from \"./room.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-5479d942\"\n\nexport default script","<template>\n  <v-dialog :model-value=\"editing\">\n    <edit-config kind=\"game\" v-model=\"game_rules\" @close=\"editing = false\" />\n  </v-dialog>\n\n  <v-flex column grow align-center>\n    <game :value=\"local_game\" />\n\n    <v-grow />\n\n    <!-- <v-flex justify-center>\n      <v-button @click=\"editing = true\">\n        <v-icon class=\"mr-3\">settings</v-icon>\n        <span>Game rules</span>\n      </v-button>\n    </v-flex> -->\n\n    <v-card class=\"mt-4\">\n      <v-text-field label=\"Name\" v-model=\"name\" />\n\n      <v-flex justify-center class=\"my-2\">\n        <v-button\n          text\n          color=\"primary\"\n          :disabled=\"!valid\"\n          @click=\"create_room()\"\n        >\n          <span>Create lobby</span>\n          <v-icon class=\"ml-3\">arrow_forward</v-icon>\n        </v-button>\n      </v-flex>\n    </v-card>\n  </v-flex>\n</template>\n\n<script>\nimport { computed, inject, onBeforeUnmount, onMounted, shallowReactive, shallowRef } from 'vue';\n\nimport { Vec } from '@/vec';\nimport { onKeyDown, R } from '@/input';\nimport { play, new_game, reactive_state, empty_state } from '@/tetris';\nimport { wall_kicks } from '@/tetris/config';\nimport { create_room } from '@/tetris/remote';\n\nimport game from '@/ui/game';\nimport editConfig from '@/ui/edit-config';\nimport configGameRules from '@/ui/config/config-game-rules';\nimport configUserPrefs from '@/ui/config/config-user-prefs';\n\nexport default {\n  name: 'landing',\n  components: {\n    game,\n    editConfig,\n    configGameRules,\n    configUserPrefs,\n  },\n\n  emits: ['room'],\n\n  setup(props, { emit }) {\n    const editing = shallowRef(null);\n    const game_rules = shallowReactive({\n      field_size: new Vec(10, 40),\n      fall_delay: 50,\n      lock_delay: 30,\n      move_reset_limit: 15,\n\n      wall_kicks: wall_kicks.standard,\n\n      bag_preview: 5,\n    });\n\n    const user_prefs = inject('user_prefs');\n\n    const local_game = shallowRef(null);\n\n    let localCleanup;\n    const start_game = () => {\n      localCleanup?.();\n\n      const state = reactive_state(empty_state(game_rules));\n      local_game.value = new_game(game_rules, state);\n      localCleanup = play(user_prefs, local_game.value);\n    };\n\n    onMounted(() => {\n      start_game();\n    });\n\n    onBeforeUnmount(() => localCleanup?.());\n\n    onKeyDown(R, () => start_game());\n\n    const name = shallowRef(localStorage.getItem('mfro:user-name') ?? '');\n    const valid = computed(() => {\n      return name.value != '';\n    });\n\n    return {\n      local_game,\n\n      editing,\n      game_rules,\n\n      name,\n      valid,\n\n      create_room() {\n        localStorage.setItem('mfro:user-name', name.value);\n        let room = create_room(name.value, user_prefs);\n        emit('room', room);\n      },\n\n      edit(name) {\n        editing.value = name;\n      },\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\">\n#app {\n  width: 100vw;\n  height: 100vh;\n}\n</style>\n\n<style lang=\"scss\" scoped>\ncanvas {\n  width: 0;\n}\n</style>\n","import alea from 'alea';\nimport { shallowReactive } from 'vue';\n\nimport { on } from '@mfro/ts-common/events';\nimport { receive, send } from '@mfro/ts-common/sockets/client';\nimport { BroadcastUpdate, ClientUpdate, RoomCode, RoomState, StartGame, StartGameRequest } from 'common';\n\nimport { empty_state, Game, new_game, play, reactive_state } from '.';\nimport { GameRules, UserPreferences } from './config';\n\ninterface Member {\n  name: string;\n  game: Game | null;\n}\n\ninterface RemoteState {\n  code: string | null;\n\n  local: Game | null;\n  index: number;\n  members: Member[];\n\n  start_game(rules: GameRules): void;\n}\n\nfunction observe<Args extends any[], R, O extends { [k in K]: (...args: Args) => R }, K extends keyof O>(target: O, key: K, hook: (...args: Args) => R) {\n  let original = target[key];\n  target[key] = ((...args) => {\n    let result = original(...args);\n    hook(...args);\n    return result;\n  }) as O[K];\n}\n\nexport function create_room(name: string, user: UserPreferences, code: string | null) {\n  let socket: WebSocket;\n  const base =\n    window.location.host == 'box:8080' || window.location.host == 'localhost:8080'\n      ? 'ws://box:8081/' : 'wss://api.mfro.me/tetris/play';\n\n  const state: RemoteState = shallowReactive({\n    local: null,\n    index: 0,\n    members: [],\n\n    code: code,\n    state: 0,\n\n    start_game(rules: GameRules) {\n      let seed = alea(Math.random()).uint32();\n      send(socket, StartGameRequest, { seed, rules: GameRules.save(rules) });\n    },\n  });\n\n  if (state.code) {\n    socket = new WebSocket(`${base}?name=${name}&code=${state.code}`);\n  } else {\n    socket = new WebSocket(`${base}?name=${name}`);\n  }\n\n  function check_exit() {\n    if (state.members.every((m, i) => !m.game || m.game.state.dead)) {\n      state.local = null;\n      for (let member of state.members) {\n        member.game = null;\n      }\n    }\n  }\n\n  let cleanup: (() => void) | null = null;\n  on(receive(socket, StartGame), (config) => {\n    cleanup?.();\n\n    let rules = GameRules.load(config.rules);\n\n    let s = reactive_state(empty_state(rules, config.seed))\n    state.local = new_game(rules, s);\n\n    for (let i = 0; i < config.players; ++i) {\n      if (i == state.index) {\n        state.members[i].game = state.local;\n      } else {\n        let s = reactive_state(empty_state(rules, config.seed))\n        state.members[i].game = new_game(rules, s);\n      }\n    }\n\n    observe(state.local, 'hold', () => send(socket, ClientUpdate, { type: 'hold' }));\n    observe(state.local, 'drop', (distance) => send(socket, ClientUpdate, { type: 'drop', distance }));\n    observe(state.local, 'shift', (dir) => send(socket, ClientUpdate, { type: 'shift', dir }));\n    observe(state.local, 'rotate', (dir) => send(socket, ClientUpdate, { type: 'rotate', dir }));\n    observe(state.local, 'lock_down', () => send(socket, ClientUpdate, { type: 'lock_down' }));\n    observe(state.local, 'new_falling', () => send(socket, ClientUpdate, { type: 'new_falling' }));\n    observe(state.local, 'end_game', () => {\n      send(socket, ClientUpdate, { type: 'end_game' });\n      check_exit();\n    });\n\n    cleanup = play(user, state.local);\n  });\n\n  on(receive(socket, BroadcastUpdate), ([index, update]) => {\n    let target = state.members[index].game!;\n    switch (update.type) {\n      case 'hold': target.hold(); break;\n      case 'drop': target.drop(update.distance); break;\n      case 'shift': target.shift(update.dir); break;\n      case 'rotate': target.rotate(update.dir); break;\n      case 'lock_down': target.lock_down(); break;\n      case 'new_falling': target.new_falling(); break;\n      case 'end_game': target.end_game(); check_exit(); break;\n    }\n  });\n\n  on(receive(socket, RoomCode), code => {\n    if (code != state.code) {\n      const url = new URL(window.location.href);\n      url.searchParams.delete('code');\n      window.history.replaceState(null, document.title, url.pathname + url.search);\n    }\n\n    state.code = code;\n  });\n\n  on(receive(socket, RoomState), ({ index, names }) => {\n    state.members = names.map(name => ({ name, game: null }));\n    state.index = index;\n\n    if (state.members.length > 1) {\n      const url = new URL(window.location.href);\n      url.searchParams.set('code', state.code!);\n      window.history.replaceState(null, document.title, url.pathname + url.search);\n    }\n  });\n\n  return state;\n}\n","import { render } from \"./landing.vue?vue&type=template&id=6be00a92&scoped=true\"\nimport script from \"./landing.vue?vue&type=script&lang=js\"\nexport * from \"./landing.vue?vue&type=script&lang=js\"\n\nimport \"./landing.vue?vue&type=style&index=0&id=6be00a92&lang=scss\"\nimport \"./landing.vue?vue&type=style&index=1&id=6be00a92&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-6be00a92\"\n\nexport default script","<template>\n  <v-flex column grow align-center>\n    <v-card class=\"mb-4\">\n      <v-text-field label=\"Code\" v-model=\"code\" />\n\n      <v-text-field label=\"Name\" v-model=\"name\" />\n\n      <v-flex justify-center class=\"my-2\">\n        <v-button text color=\"primary\" :disabled=\"!valid\" @click=\"submit()\">\n          <span>Join lobby</span>\n          <v-icon class=\"ml-3\">arrow_forward</v-icon>\n        </v-button>\n      </v-flex>\n    </v-card>\n  </v-flex>\n</template>\n\n<script>\nimport { computed, inject, shallowRef } from 'vue';\n\nimport { create_room } from '@/tetris/remote';\n\nexport default {\n  name: 'joining',\n\n  emits: ['room'],\n  props: {\n    code: String,\n  },\n\n  setup(props, { emit }) {\n    const name = shallowRef(localStorage.getItem('mfro:user-name') ?? '');\n    const code = shallowRef(props.code);\n\n    const valid = computed(() => {\n      return name.value != '';\n    });\n\n    const user_prefs = inject('user_prefs');\n\n    return {\n      name,\n      code,\n      valid,\n\n      submit() {\n        localStorage.setItem('mfro:user-name', name.value);\n        let room = create_room(name.value, user_prefs, code.value);\n        emit('room', room);\n      },\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\">\n#app {\n  width: 100vw;\n  height: 100vh;\n}\n</style>\n\n<style lang=\"scss\" scoped>\ncanvas {\n  width: 0;\n}\n</style>\n","import { render } from \"./joining.vue?vue&type=template&id=d871ed76&scoped=true\"\nimport script from \"./joining.vue?vue&type=script&lang=js\"\nexport * from \"./joining.vue?vue&type=script&lang=js\"\n\nimport \"./joining.vue?vue&type=style&index=0&id=d871ed76&lang=scss\"\nimport \"./joining.vue?vue&type=style&index=1&id=d871ed76&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-d871ed76\"\n\nexport default script","import { render } from \"./main.vue?vue&type=template&id=3ed78246&scoped=true\"\nimport script from \"./main.vue?vue&type=script&lang=js\"\nexport * from \"./main.vue?vue&type=script&lang=js\"\n\nimport \"./main.vue?vue&type=style&index=0&id=3ed78246&lang=scss\"\nimport \"./main.vue?vue&type=style&index=1&id=3ed78246&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-3ed78246\"\n\nexport default script","import { createApp } from 'vue'\nimport { framework } from '@mfro/vue-ui';\n\nimport root from './main.vue'\n\ncreateApp(root)\n  .use(framework)\n  .mount('#app')\n","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./config-rational.vue?vue&type=style&index=1&id=1924bb03&lang=scss&scoped=true\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./landing.vue?vue&type=style&index=0&id=6be00a92&lang=scss\""],"sourceRoot":""}