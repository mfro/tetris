(function(e){function t(t){for(var r,l,i=t[0],u=t[1],c=t[2],d=0,s=[];d<i.length;d++)l=i[d],Object.prototype.hasOwnProperty.call(o,l)&&o[l]&&s.push(o[l][0]),o[l]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);f&&f(t);while(s.length)s.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==o[u]&&(r=!1)}r&&(a.splice(t--,1),e=l(l.s=n[0]))}return e}var r={},o={index:0},a=[];function l(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=r,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(n,r,function(t){return e[t]}.bind(null,r));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var f=u;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"162c":function(e,t,n){},"177f":function(e,t,n){e.exports={root:"config-number_root_1JO2c"}},"1f42":function(e,t,n){"use strict";n("162c")},2195:function(e,t,n){"use strict";n("7557")},"3ad7":function(e,t,n){},"4d2a":function(e,t,n){},"50a0":function(e,t,n){"use strict";n("e70f")},6054:function(e,t,n){"use strict";var r=n("177f"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},"735a":function(e,t,n){e.exports={root:"config-rational_root_1KOtQ"}},7557:function(e,t,n){},7591:function(e,t,n){"use strict";n("8caf")},"8caf":function(e,t,n){},"91bd":function(e,t,n){},a5f7:function(e,t,n){},a76e:function(e,t,n){"use strict";var r=n("735a"),o=n.n(r);n.d(t,"default",(function(){return o.a}))},b283:function(e,t,n){"use strict";n("a5f7")},b493:function(e,t,n){"use strict";n("4d2a")},cbc2:function(e,t,n){"use strict";n("81b1");var r=n("fee1");n.d(t,"a",(function(){return r["a"]})),n.d(t,"b",(function(){return r["b"]})),n.d(t,"c",(function(){return r["c"]})),n.d(t,"d",(function(){return r["d"]})),n.d(t,"e",(function(){return r["e"]})),n.d(t,"f",(function(){return r["f"]})),n.d(t,"g",(function(){return r["g"]})),n.d(t,"h",(function(){return r["h"]})),n.d(t,"i",(function(){return r["i"]})),n.d(t,"j",(function(){return r["j"]})),n.d(t,"k",(function(){return r["k"]})),n.d(t,"l",(function(){return r["l"]})),n.d(t,"m",(function(){return r["m"]})),n.d(t,"n",(function(){return r["n"]})),n.d(t,"o",(function(){return r["o"]})),n.d(t,"p",(function(){return r["p"]})),n.d(t,"q",(function(){return r["q"]})),n.d(t,"r",(function(){return r["r"]})),n.d(t,"s",(function(){return r["s"]})),n.d(t,"t",(function(){return r["t"]})),n.d(t,"u",(function(){return r["u"]})),n.d(t,"v",(function(){return r["v"]})),n.d(t,"w",(function(){return r["w"]})),n.d(t,"x",(function(){return r["x"]})),n.d(t,"y",(function(){return r["y"]})),n.d(t,"z",(function(){return r["z"]})),n.d(t,"A",(function(){return r["A"]})),n.d(t,"B",(function(){return r["B"]})),n.d(t,"C",(function(){return r["C"]})),n.d(t,"D",(function(){return r["D"]})),n.d(t,"E",(function(){return r["E"]})),n.d(t,"F",(function(){return r["F"]})),n.d(t,"G",(function(){return r["G"]})),n.d(t,"H",(function(){return r["H"]})),n.d(t,"I",(function(){return r["I"]})),n.d(t,"J",(function(){return r["J"]}));n("669d")},cd49:function(e,t,n){"use strict";n.r(t);n("fd85"),n("15db"),n("c026"),n("4031");var r=n("cbc2"),o=n("34c7"),a=Object(r["J"])("data-v-3ed78246");Object(r["s"])("data-v-3ed78246");var l=Object(r["i"])("settings"),i=Object(r["j"])("span",null,"User preferences",-1);Object(r["q"])();var u=a((function(e,t,n,o,u,c){var f=Object(r["x"])("edit-config"),d=Object(r["x"])("v-dialog"),s=Object(r["x"])("v-icon"),b=Object(r["x"])("v-button"),v=Object(r["x"])("v-flex"),m=Object(r["x"])("room"),j=Object(r["x"])("joining"),p=Object(r["x"])("landing"),O=Object(r["x"])("v-app");return Object(r["p"])(),Object(r["f"])(O,{"align-center":"",class:"pa-6"},{default:a((function(){return[Object(r["j"])(d,{"model-value":o.editing_user},{default:a((function(){return[Object(r["j"])(f,{kind:"user",modelValue:o.user_prefs,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.user_prefs=e}),onClose:t[2]||(t[2]=function(e){return o.editing_user=!1})},null,8,["modelValue"])]})),_:1},8,["model-value"]),Object(r["j"])(v,{class:"user pa-4"},{default:a((function(){return[Object(r["j"])(b,{onClick:t[3]||(t[3]=function(e){return o.editing_user=!0})},{default:a((function(){return[Object(r["j"])(s,{class:"mr-3"},{default:a((function(){return[l]})),_:1}),i]})),_:1})]})),_:1}),null!=o.current_room?(Object(r["p"])(),Object(r["f"])(m,{key:0,room:o.current_room},null,8,["room"])):null!=o.joining_code?(Object(r["p"])(),Object(r["f"])(j,{key:1,code:o.joining_code,onRoom:t[4]||(t[4]=function(e){return o.current_room=e})},null,8,["code"])):(Object(r["p"])(),Object(r["f"])(p,{key:2,onRoom:t[5]||(t[5]=function(e){return o.current_room=e})}))]})),_:1})})),c=(n("241c"),n("5a85"),n("534d"),n("f432"),Object(r["i"])("Game rules")),f=Object(r["i"])("User preferences"),d=Object(r["i"])("close"),s=Object(r["j"])("span",null,"Save",-1);function b(e,t,n,o,a,l){var i=Object(r["x"])("v-text"),u=Object(r["x"])("v-grow"),b=Object(r["x"])("v-icon"),v=Object(r["x"])("v-button"),m=Object(r["x"])("config-game-rules"),j=Object(r["x"])("config-user-prefs"),p=Object(r["x"])("v-card");return Object(r["p"])(),Object(r["f"])(p,{style:{"min-width":"60ch"}},{title:Object(r["G"])((function(){return["game"==n.kind?(Object(r["p"])(),Object(r["f"])(i,{key:0,title:""},{default:Object(r["G"])((function(){return[c]})),_:1})):Object(r["g"])("",!0),"user"==n.kind?(Object(r["p"])(),Object(r["f"])(i,{key:1,title:""},{default:Object(r["G"])((function(){return[f]})),_:1})):Object(r["g"])("",!0),Object(r["j"])(u),Object(r["j"])(v,{icon:"",small:"",onClick:t[1]||(t[1]=function(t){return e.$emit("close")})},{default:Object(r["G"])((function(){return[Object(r["j"])(b,null,{default:Object(r["G"])((function(){return[d]})),_:1})]})),_:1})]})),actions:Object(r["G"])((function(){return[Object(r["j"])(u),Object(r["j"])(v,{color:"primary",onClick:t[4]||(t[4]=function(e){return o.save()})},{default:Object(r["G"])((function(){return[s]})),_:1})]})),default:Object(r["G"])((function(){return["game"==n.kind?(Object(r["p"])(),Object(r["f"])(m,{key:0,modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.value=e})},null,8,["modelValue"])):Object(r["g"])("",!0),"user"==n.kind?(Object(r["p"])(),Object(r["f"])(j,{key:1,modelValue:o.value,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.value=e})},null,8,["modelValue"])):Object(r["g"])("",!0)]})),_:1})}function v(e,t,n,o,a,l){var i=Object(r["x"])("config-rational"),u=Object(r["x"])("config-number"),c=Object(r["x"])("config-select");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(i,{name:"Gravity",description:"Gravity for falling pieces (tiles per frame)",modelValue:o.gravity,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.gravity=e}),filter:function(e){return e<=20}},null,8,["modelValue","filter"]),Object(r["j"])(u,{name:"Lock delay",description:"Delay after touching the ground before a piece locks down (frames)",modelValue:o.lock_delay,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.lock_delay=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"]),Object(r["j"])(u,{name:"Move reset limit",description:"Maximum number of times the lock delay can be reset by successful shifts or rotates",modelValue:o.move_reset_limit,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.move_reset_limit=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"]),Object(r["j"])(u,{name:"Preview size",description:"Number of pieces in the preview",modelValue:o.bag_preview,"onUpdate:modelValue":t[4]||(t[4]=function(e){return o.bag_preview=e}),filter:function(e){return e>=0&&e<=6}},null,8,["modelValue","filter"]),Object(r["j"])(c,{name:"Wall kick style",description:"Wall kick configuration to use for rotations",modelValue:o.wall_kicks,"onUpdate:modelValue":t[5]||(t[5]=function(e){return o.wall_kicks=e}),options:o.wallKickOptions},null,8,["modelValue","options"])],64)}var m,j,p,O=n("98ad"),g=n("2e1a"),y=(n("862d"),n("b902"),n("966c"),n("d50c"),n("e82c")),_=n("862b"),h=n("c812"),x=function(){function e(t,n){Object(_["a"])(this,e),this.x=t,this.y=n}return Object(h["a"])(e,[{key:"len",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"dir",get:function(){return Math.atan2(this.y,this.x)}}],[{key:"norm",value:function(t){return e.polar(1,t.dir)}},{key:"scale",value:function(t,n){return new e(t.x*n,t.y*n)}},{key:"add",value:function(t,n){return new e(t.x+n.x,t.y+n.y)}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"eq",value:function(e,t){return e.x==t.x&&e.y==t.y}},{key:"delta",value:function(t,n){var r=e.dot(t,n),o=Math.acos(r/t.len/n.len);return t.y*n.x>t.x*n.y?-o:o}},{key:"polar",value:function(t,n){return new e(Math.cos(n)*t,Math.sin(n)*t)}}]),e}();function w(e){return{type:"constant",value:e}}function k(e){return{type:"optional",inner:e}}function V(e,t){return{type:"natural",name:e,description:t}}function S(e,t){return{type:"rational",name:e,description:t}}function T(e,t,n){return{type:"select",name:e,description:t,options:n}}function z(e,t,n){return{type:"object",name:e,description:t,inner:n}}x.zero=new x(0,0),function(e){function t(e,t){for(var n=t.map((function(e){return new x(e[0],e[1])})),r=[n],o=0;o<3;++o)n=n.map((function(t){return new x(e-1-t.y,t.x)})),r.push(n);return{size:e,rotations:r}}e.I=t(4,[[0,1],[1,1],[2,1],[3,1]]),e.O=t(2,[[0,0],[0,1],[1,0],[1,1]]),e.T=t(3,[[1,0],[0,1],[1,1],[2,1]]),e.J=t(3,[[0,0],[0,1],[1,1],[2,1]]),e.L=t(3,[[2,0],[0,1],[1,1],[2,1]]),e.S=t(3,[[1,0],[2,0],[0,1],[1,1]]),e.Z=t(3,[[0,0],[1,0],[1,1],[2,1]]),e.all=[e.I,e.O,e.T,e.J,e.L,e.S,e.Z]}(m||(m={})),function(e){function t(e){return e.map((function(e){return[x.zero].concat(Object(y["a"])(e.map((function(e){return new x(e[0],-e[1])}))))}))}var n=t([[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]]]),r=t([[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]]]),o=t([[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]]]),a=t([[[0,0],[-2,0],[1,0],[1,2],[-2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[-2,0],[1,0],[-2,1],[1,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-1]],[[0,0],[1,0],[-2,0],[1,2],[-2,-1]],[[0,0],[-2,0],[1,0],[-2,1],[1,-2]],[[0,0],[2,0],[-1,0],[-1,2],[2,-1]]]);e.standard=new Map([[m.I,o],[m.O,r],[m.T,r],[m.J,r],[m.L,r],[m.S,r],[m.Z,r]]),e.asira=new Map([[m.I,a],[m.O,r],[m.T,r],[m.J,r],[m.L,r],[m.S,r],[m.Z,r]]),e.none=new Map([[m.I,n],[m.O,n],[m.T,n],[m.J,n],[m.L,n],[m.S,n],[m.Z,n]]),e.all=[e.none,e.standard,e.asira]}(j||(j={})),function(e){function t(e){return{field_size:[e.field_size.x,e.field_size.y],fall_delay:e.fall_delay,lock_delay:e.lock_delay,move_reset_limit:e.move_reset_limit,wall_kicks:j.all.indexOf(e.wall_kicks),bag_preview:e.bag_preview}}function n(e){return{field_size:new x(e.field_size[0],e.field_size[1]),fall_delay:e.fall_delay,lock_delay:e.lock_delay,move_reset_limit:e.move_reset_limit,wall_kicks:j.all[e.wall_kicks],bag_preview:e.bag_preview}}e.save=t,e.load=n}(p||(p={}));w(new x(10,40)),S("Drop Delay","Drop delay for falling pieces (frames per tile)"),S("Lock Delay","Lock down delay (frames)"),k(S("Move Reset Limit","Maximum number of times the Lock Delay can be reset by successful shifts or rotates")),T("Wall Kicks","Wall kick data",[["No Kicks",j.none],["Standard",j.standard],["Asira",j.asira]]),V("Preview Size","Number of pieces in the preview"),k(z("Autoshift","Configure repeated shifts while input is held",{delay:S("Delay","Delay between repeated shifts (frames)"),initial_delay:S("Initial Delay","Delay after first shift before repeating (frames)")})),S("Soft Drop Multiplier","Multiplier for Drop Delay while soft dropping"),n("88f6"),n("932a"),n("0ffc");var C=Object(r["J"])("data-v-632a7c32"),M=C((function(e,t,n,o,a,l){var i=Object(r["x"])("v-input"),u=Object(r["x"])("v-tooltip");return Object(r["p"])(),Object(r["f"])(u,{right:"",text:n.description},{default:C((function(){return[Object(r["j"])(i,{label:n.name,onClick:t[2]||(t[2]=function(t){return e.$refs.select.click()})},{default:C((function(e){var a=e.id;return[Object(r["H"])(Object(r["j"])("select",{id:a,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.value=e}),ref:"select"},[(Object(r["p"])(!0),Object(r["f"])(r["a"],null,Object(r["v"])(n.options,(function(e,t){return Object(r["p"])(),Object(r["f"])("option",{key:e[0],value:t},Object(r["B"])(e[0]),9,["value"])})),128))],8,["id"]),[[r["D"],o.value]])]})),_:1},8,["label"])]})),_:1},8,["text"])})),I=(n("156c"),{name:"config-select",emits:["update:modelValue"],props:{name:String,description:String,modelValue:{},options:Array},setup:function(e,t){var n=t.emit,o=Object(r["d"])({get:function(){return e.options.findIndex((function(t){return t[1]==e.modelValue}))},set:function(t){n("update:modelValue",e.options[t][1])}});return{value:o}}});n("1f42");I.render=M,I.__scopeId="data-v-632a7c32";var U=I;function A(e,t,n,o,a,l){var i=Object(r["x"])("v-text-field"),u=Object(r["x"])("v-tooltip");return Object(r["p"])(),Object(r["f"])(u,{right:"",text:n.description},{default:Object(r["G"])((function(){return[Object(r["j"])(i,{label:n.name,"model-value":o.state.editing,"onUpdate:modelValue":o.onInput,onBlur:o.onBlur,warning:o.state.error},null,8,["label","model-value","onUpdate:modelValue","onBlur","warning"])]})),_:1},8,["text"])}n("9588"),n("7e9e"),n("f542");var J={name:"config-number",emits:["update:modelValue"],props:{name:String,description:String,modelValue:Number,filter:Function},setup:function(e,t){var n=t.emit,o=Object(r["z"])({editing:null,error:!1});return Object(r["E"])((function(){return e.modelValue}),(function(){o.editing=e.modelValue.toString()}),{immediate:!0}),{state:o,onInput:function(t){o.editing=t;var a=parseInt(t,10);a.toString()!=t||e.filter&&!e.filter(a)?o.error=!0:(o.error=!1,Object(r["m"])((function(){return n("update:modelValue",a)})))},onBlur:function(){}}}},P=n("6054");const G=J.__cssModules={};G["$style"]=P["default"],J.render=A;var D=J,L=Object(r["J"])("data-v-1924bb03");Object(r["s"])("data-v-1924bb03");var q=Object(r["i"])("/");Object(r["q"])();var R=L((function(e,t,n,o,a,l){var i=Object(r["x"])("v-text"),u=Object(r["x"])("v-flex"),c=Object(r["x"])("v-input"),f=Object(r["x"])("v-tooltip");return Object(r["p"])(),Object(r["f"])(f,{right:"",text:n.description},{default:L((function(){return[Object(r["j"])(c,{label:n.name,style:{cursor:"text"},onClick:t[4]||(t[4]=function(t){return e.$refs.top.focus()}),warning:o.state.error},{default:L((function(e){var n=e.id;return[Object(r["j"])(u,null,{default:L((function(){return[Object(r["j"])("input",{ref:"top",id:n,style:{width:"3ch"},value:o.state.top,onInput:t[1]||(t[1]=function(e){return o.setTop(e.target.value)})},null,40,["id","value"]),Object(r["j"])(u,{class:"mx-2",column:"","justify-center":""},{default:L((function(){return[Object(r["j"])(i,null,{default:L((function(){return[q]})),_:1})]})),_:1}),Object(r["j"])("input",{onClick:t[2]||(t[2]=Object(r["I"])((function(){}),["stop"])),value:o.state.bot,onInput:t[3]||(t[3]=function(e){return o.setBot(e.target.value)})},null,40,["value"])]})),_:2},1024)]})),_:1},8,["label","warning"])]})),_:1},8,["text"])})),N={name:"config-rational",emits:["update:modelValue"],props:{name:String,description:String,modelValue:Number,filter:Function},setup:function(e,t){var n=t.emit,o=Object(r["z"])({top:null,bot:null,error:!1});return Object(r["E"])((function(){return e.modelValue}),(function(){e.modelValue>1?(o.top=e.modelValue.toString(),o.bot="1"):(o.top="1",o.bot=1/e.modelValue.toString())}),{immediate:!0}),{state:o,setTop:function(t){o.top=t,o.bot="1";var r=parseInt(t,10);r.toString()!=t||e.filter&&!e.filter(r)?o.error=!0:(o.error=!1,n("update:modelValue",r))},setBot:function(t){o.top="1",o.bot=t;var r=1/parseInt(t,10);console.log(t,r),(1/r).toString()!=t||e.filter&&!e.filter(r)?o.error=!0:(o.error=!1,n("update:modelValue",r))}}}},E=n("a76e");n("ce31");const B=N.__cssModules={};B["$style"]=E["default"],N.render=R,N.__scopeId="data-v-1924bb03";var F=N,W=[["No Kicks",j.none],["Standard",j.standard],["Asira",j.asira]];function Z(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return Object(r["d"])({get:function(){return o(t()[n])},set:function(r){var o=Object(g["a"])(Object(g["a"])({},t()),{},Object(O["a"])({},n,a(r)));e("update:modelValue",o)}})}var K={name:"config-game-rules",components:{configSelect:U,configNumber:D,configRational:F},emits:["update:modelValue"],props:{modelValue:Object},setup:function(e,t){var n=t.emit,r=Z(n,(function(){return e.modelValue}),"fall_delay",(function(e){return 1/e}),(function(e){return 1/e})),o=Z(n,(function(){return e.modelValue}),"lock_delay"),a=Z(n,(function(){return e.modelValue}),"move_reset_limit"),l=Z(n,(function(){return e.modelValue}),"bag_preview"),i=Z(n,(function(){return e.modelValue}),"wall_kicks");return{gravity:r,lock_delay:o,move_reset_limit:a,bag_preview:l,wall_kicks:i,wallKickOptions:W}}};K.render=v;var $=K;function H(e,t,n,o,a,l){var i=Object(r["x"])("config-autoshift"),u=Object(r["x"])("config-number");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(i,{modelValue:o.autoshift,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.autoshift=e})},null,8,["modelValue"]),Object(r["j"])(u,{name:"Soft drop multiplier",description:"Gravity multiplier when soft dropping",modelValue:o.soft_drop,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.soft_drop=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"])],64)}function Q(e,t,n,o,a,l){var i=Object(r["x"])("config-number");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(i,{name:"Autoshift delay",description:"Delay between repeated shifts while input is held (ARR)",modelValue:o.delay,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.delay=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"]),Object(r["j"])(i,{name:"Autoshift initial delay",description:"Delay after the initial shift when pressing an input before repeating (DAS)",modelValue:o.initial_delay,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.initial_delay=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"])],64)}function X(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return Object(r["d"])({get:function(){return o(t()[n])},set:function(r){var o=Object(g["a"])(Object(g["a"])({},t()),{},Object(O["a"])({},n,a(r)));e("update:modelValue",o)}})}var Y={name:"config-autoshift",components:{configNumber:D},emits:["update:modelValue"],props:{modelValue:Object},setup:function(e,t){var n=t.emit,r=X(n,(function(){return e.modelValue}),"delay"),o=X(n,(function(){return e.modelValue}),"initial_delay");return{delay:r,initial_delay:o}}};Y.render=Q;var ee=Y;function te(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return Object(r["d"])({get:function(){return o(t()[n])},set:function(r){var o=Object(g["a"])(Object(g["a"])({},t()),{},Object(O["a"])({},n,a(r)));e("update:modelValue",o)}})}var ne={name:"config-game-rules",components:{configAutoshift:ee,configNumber:D},emits:["update:modelValue"],props:{modelValue:Object},setup:function(e,t){var n=t.emit,r=te(n,(function(){return e.modelValue}),"autoshift"),o=te(n,(function(){return e.modelValue}),"soft_drop");return{autoshift:r,soft_drop:o}}};ne.render=H;var re=ne,oe={name:"edit-config",components:{configGameRules:$,configUserPrefs:re},emits:["close","update:modelValue"],props:{kind:String,modelValue:Object},setup:function(e,t){var n=t.emit,o=Object(r["A"])(e.modelValue);return Object(r["E"])((function(){return e.modelValue}),(function(e){return o.value=e})),{value:o,save:function(){n("update:modelValue",o.value),n("close")}}}};oe.render=b;var ae=oe,le=(n("cbc2f"),Object(r["J"])("data-v-5479d942"));Object(r["s"])("data-v-5479d942");var ie=Object(r["i"])("Tetris Lobby"),ue=Object(r["i"])("settings"),ce=Object(r["j"])("span",null,"Game rules",-1),fe=Object(r["j"])("span",null,"Start game",-1);Object(r["q"])();var de=le((function(e,t,n,o,a,l){var i=Object(r["x"])("edit-config"),u=Object(r["x"])("v-dialog"),c=Object(r["x"])("v-text"),f=Object(r["x"])("v-grow"),d=Object(r["x"])("clipboard"),s=Object(r["x"])("v-flex"),b=Object(r["x"])("v-icon"),v=Object(r["x"])("v-button"),m=Object(r["x"])("v-card"),j=Object(r["x"])("game");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(u,{"model-value":o.editing},{default:le((function(){return[Object(r["j"])(i,{kind:"game",modelValue:o.game_rules,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.game_rules=e}),onClose:t[2]||(t[2]=function(e){return o.editing=!1})},null,8,["modelValue"])]})),_:1},8,["model-value"]),Object(r["j"])(s,{column:"",grow:"","align-center":""},{default:le((function(){return[n.room.local?(Object(r["p"])(),Object(r["f"])(s,{key:1},{default:le((function(){return[Object(r["j"])(j,{value:n.room.local},null,8,["value"]),Object(r["j"])(s,null,{default:le((function(){return[(Object(r["p"])(!0),Object(r["f"])(r["a"],null,Object(r["v"])(o.others,(function(e){return Object(r["p"])(),Object(r["f"])(j,{key:e,value:e.game},null,8,["value"])})),128))]})),_:1})]})),_:1})):(Object(r["p"])(),Object(r["f"])(m,{key:0},Object(r["h"])({title:le((function(){return[Object(r["j"])(s,{grow:"","align-start":""},{default:le((function(){return[Object(r["j"])(c,{title:""},{default:le((function(){return[ie]})),_:1}),Object(r["j"])(f,{class:"mx-6"}),Object(r["j"])(f,{class:"mx-6"}),Object(r["j"])(d,{value:o.link},null,8,["value"])]})),_:1})]})),default:le((function(){return[Object(r["j"])(s,{column:"",class:"pt-4"},{default:le((function(){return[(Object(r["p"])(!0),Object(r["f"])(r["a"],null,Object(r["v"])(n.room.members,(function(e){return Object(r["p"])(),Object(r["f"])(s,{key:e,class:"pa-3 px-4"},{default:le((function(){return[Object(r["j"])(c,null,{default:le((function(){return[Object(r["i"])(Object(r["B"])(e.name),1)]})),_:2},1024)]})),_:2},1024)})),128))]})),_:1})]})),_:2},[0==n.room.index?{name:"actions",fn:le((function(){return[Object(r["j"])(v,{text:"",onClick:t[3]||(t[3]=function(e){return o.editing=!0}),class:"mr-3"},{default:le((function(){return[Object(r["j"])(b,{class:"mr-3"},{default:le((function(){return[ue]})),_:1}),ce]})),_:1}),Object(r["j"])(f),Object(r["j"])(v,{onClick:t[4]||(t[4]=function(e){return o.start()}),color:"primary"},{default:le((function(){return[fe]})),_:1})]}))}:void 0]),1024))]})),_:1})],64)})),se={ref:"canvas"};function be(e,t,n,o,a,l){return Object(r["p"])(),Object(r["f"])("canvas",se,null,512)}n("eea7"),n("46d4"),n("c770"),n("581e"),n("dddc");var ve=n("68d6"),me=n("57d2"),je=n("19a6"),pe=(n("5e5b"),n("b2f1")),Oe=n.n(pe),ge=n("9a81"),ye=(n("46c3"),32),_e=37,he=38,xe=16,we=40,ke=39,Ve=65,Se=90,Te=83,ze=88,Ce=67,Me=82,Ie=new Set,Ue=new Map,Ae=new Map;function Je(e){return Ie.has(e)}function Pe(e,t){var n=Ae.get(e);n||Ae.set(e,n=[]),n.push(t)}function Ge(e,t){var n=Ue.get(e);n||Ue.set(e,n=[]),n.push(t)}window.addEventListener("keydown",(function(e){if(!Ie.has(e.keyCode)){Ie.add(e.keyCode);var t=Ae.get(e.keyCode);if(t){var n,r=Object(me["a"])(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o()}}catch(a){r.e(a)}finally{r.f()}}}})),window.addEventListener("keyup",(function(e){Ie.delete(e.keyCode);var t=Ue.get(e.keyCode);if(t){var n,r=Object(me["a"])(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o()}}catch(a){r.e(a)}finally{r.f()}}}));var De=new x(0,1);function Le(e){return e.kind.rotations[e.rotation].map((function(t){return x.add(e.position,t)}))}function qe(e){for(var t=[],n=0;n<e.field_size.x;++n)t[n]=null;return t}function Re(e){for(var t=[],n=0;n<e.field_size.y;++n)t[n]=qe(e);return t}function Ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t&&(t=Oe()(Math.random()).uint32()),{seed:t,field:Re(e),falling:null,fall_queue:[],holding:null,hold_available:!0,dead:!1}}function Ee(e){var t=e.falling;return Object(r["t"])({seed:e.seed,field:e.field.map((function(e){return Object(r["z"])(e)})),falling:Object(r["k"])((function(e,n){return{get:function(){return e(),t},set:function(e){t=e&&Object(r["z"])(e),n()}}})),fall_queue:Object(r["z"])([]),holding:Object(r["A"])(null),hold_available:e.hold_available,dead:e.dead})}function Be(e,t){var n=0,r=!1;function o(n){var r,o=Object(me["a"])(Le(n));try{for(o.s();!(r=o.n()).done;){var a=r.value;if(a.x<0||a.x>=e.field_size.x||a.y>=e.field_size.y)return!0;if(!(a.y<0)){var l=t.field[a.y][a.x];if(null!=l)return!0}}}catch(i){o.e(i)}finally{o.f()}return!1}function a(e){var t=e.position;while(1){var n=x.add(t,De);if(o(Object.assign(Object.assign({},e),{position:n})))break;t=n}return t}function l(){var e,n;if(!t.dead&&null!=t.falling){var o=t.holding;t.holding=null!==(n=null===(e=t.falling)||void 0===e?void 0:e.kind)&&void 0!==n?n:null,o&&t.fall_queue.unshift(o),t.falling=null,t.hold_available=!1,r=!0}}function i(e){if(t.dead||null==t.falling)return 0;for(var n=0;n<e;++n){var r=x.add(t.falling.position,De);if(o(Object.assign(Object.assign({},t.falling),{position:r})))return n;t.falling.position=r}return e}function u(e){if(t.dead||null==t.falling)return!1;var n=x.add(t.falling.position,new x(e,0));return!o(Object.assign(Object.assign({},t.falling),{position:n}))&&(t.falling.position=n,!0)}function c(n){if(t.dead||null==t.falling)return!1;var r=(t.falling.rotation+n)%4;r<0&&(r+=4);var a,l=e.wall_kicks.get(t.falling.kind);Object(ge["a"])(null!=l,"no kick info for piece"),a=1==n?l[2*t.falling.rotation]:l[2*r+1];var i,u=Object(me["a"])(a);try{for(u.s();!(i=u.n()).done;){var c=i.value,f=x.add(t.falling.position,c);if(!o(Object.assign(Object.assign({},t.falling),{position:f,rotation:r})))return t.falling.position=f,t.falling.rotation=r,!0}}catch(d){u.e(d)}finally{u.f()}return!1}function f(){if(!t.dead&&null!=t.falling){var n,r=Object(me["a"])(Le(t.falling));try{for(r.s();!(n=r.n()).done;){var o=n.value;t.field[o.y][o.x]={id:t.falling.id,kind:t.falling.kind}}}catch(u){r.e(u)}finally{r.f()}for(var a=0,l=0;l<e.field_size.y;++l)if(t.field[l].every((function(e){return null!=e}))){for(var i=l;i>0;--i)Object.assign(t.field[i],t.field[i-1]);Object.assign(t.field[0],qe(e)),a+=1}a>0&&console.log("cleared ".concat(a," lines"))}}function d(){if(t.dead)return!1;if(t.fall_queue.length-1<e.bag_preview){var a=Oe()(t.seed);t.seed=a.uint32();var l=m.all.slice();while(l.length>0){var i=Math.floor(a()*l.length),u=l.splice(i,1)[0];t.fall_queue.push(u)}}var c=t.fall_queue[0],f=new x(5-Math.ceil(c.size/2),e.field_size.y/2-2),d=0,s={id:n++,kind:c,position:f,rotation:d};return t.hold_available=!r,r=!1,!o(s)&&(t.fall_queue.shift(),t.falling=s,!0)}function s(){t.dead=!0,t.falling=null}return{rules:e,state:t,collide:o,hard_drop_position:a,hold:l,drop:i,shift:u,rotate:c,lock_down:f,new_falling:d,end_game:s}}function Fe(e,t){var n=0,r=0,o=0,a=!1,l=!1,i=!1,u=0,c=0;function f(){var e;t.state.dead||(t.new_falling()?(n=null!==(e=t.rules.move_reset_limit)&&void 0!==e?e:1/0,b()):t.end_game())}function d(e){var n=x.add(e.position,De);return t.collide(Object.assign(Object.assign({},e),{position:n}))}function s(){t.lock_down(),f()}function b(){var e;t.state.dead||null==t.state.falling||(o=0,t.drop(1)>0&&(n=null!==(e=t.rules.move_reset_limit)&&void 0!==e?e:1/0))}function v(){t.state.dead||null==t.state.falling||r>0&&n>0&&(n-=1,r=0)}function m(){t.state.hold_available&&(t.hold(),f())}function j(n){t.state.dead||null==t.state.falling||t.shift(n)&&(v(),e.autoshift&&(c=a?e.autoshift.delay:e.autoshift.initial_delay,a=!0))}function p(e){t.state.dead||null==t.state.falling||t.rotate(e)&&v()}function O(){t.state.dead||null==t.state.falling||(t.drop(20),s())}function g(e){t.state.dead||null==t.state.falling||(a=!1,1==e?i=!0:l=!0,u=e,j(e))}function y(n){t.state.dead||null==t.state.falling||(1==n?i=!1:l=!1,e.autoshift&&u==n&&(c=a?e.autoshift.delay:e.autoshift.initial_delay),u=l?-1:i?1:0)}f(),Pe(Se,(function(){return p(-1)})),Pe(Ve,(function(){return p(-1)})),Pe(ze,(function(){return p(1)})),Pe(Te,(function(){return p(1)})),Pe(he,(function(){return p(1)})),Ge(_e,(function(){return y(-1)})),Pe(_e,(function(){return g(-1)})),Ge(ke,(function(){return y(1)})),Pe(ke,(function(){return g(1)})),Pe(ye,(function(){return O()})),Pe(Ce,(function(){return m()})),Pe(xe,(function(){return m()}));var _=setInterval(h,1e3/60);function h(){var a;if(t.state.dead)return clearInterval(_);if(c>0?c-=1:e.autoshift&&0!=u&&j(u),null!=t.state.falling)if(d(t.state.falling))r+=1/t.rules.lock_delay,o=Math.min(o,Math.ceil(1/t.rules.fall_delay)),r>=1&&(o=0,r=0,s());else if(Je(we)?o+=1/t.rules.fall_delay*e.soft_drop:o+=1/t.rules.fall_delay,o>1){var l=Math.floor(o),i=t.drop(l);i>0&&(n=null!==(a=t.rules.move_reset_limit)&&void 0!==a?a:1/0),i==l?o-=l:o=0}}return function(){return clearInterval(_)}}n("e28c"),n("f1c6"),n("7bea"),n("90fa"),n("feeb"),n("1c98"),n("06a3"),n("1ca0"),n("3a0c"),n("9426"),n("100a"),n("3051"),n("9598"),n("2731"),n("587f"),n("c60d"),n("b285"),n("6a35"),n("b391"),n("1234"),n("dfa9"),n("7c3f"),n("2d6b"),n("0312"),n("1f3b"),n("c666"),n("705d");var We,Ze={v1:function(e,t,n,r,o){var a=new Map([[m.I,"#31c7ef"],[m.O,"#e39f02"],[m.T,"#af298a"],[m.J,"#2141c6"],[m.L,"#e35b02"],[m.S,"#59b101"],[m.Z,"#d70f37"]]),l=t;if(e.save(),o==We.ghost)e.fillStyle="white",e.fillRect(l.x,l.y,1,1);else if(o==We.disabled)e.filter="grayscale(100%)";else{var i=a.get(n);Object(ge["a"])(null!=i,"no color for piece"),e.fillStyle=i,e.fillRect(l.x,l.y,1,1)}var u=1/8;e.beginPath(),e.lineCap="butt",e.lineWidth=u,e.strokeStyle="#00000040",r[0]&&(e.moveTo(l.x,l.y+u/2),e.lineTo(l.x+u/2,l.y+u/2),e.lineTo(l.x+u/2,l.y)),r[1]&&(e.moveTo(l.x,l.y+u/2),e.lineTo(l.x+1,l.y+u/2)),r[2]&&(e.moveTo(l.x+1-u/2,l.y),e.lineTo(l.x+1-u/2,l.y+u/2),e.lineTo(l.x+1,l.y+u/2)),r[3]&&(e.moveTo(l.x-u/2+1,l.y),e.lineTo(l.x-u/2+1,l.y+1)),r[4]&&(e.moveTo(l.x+1,l.y+1-u/2),e.lineTo(l.x+1-u/2,l.y+1-u/2),e.lineTo(l.x+1-u/2,l.y+1)),r[5]&&(e.moveTo(l.x+1,l.y-u/2+1),e.lineTo(l.x,l.y-u/2+1)),r[6]&&(e.moveTo(l.x+u/2,l.y+1),e.lineTo(l.x+u/2,l.y+1-u/2),e.lineTo(l.x,l.y+1-u/2)),r[7]&&(e.moveTo(l.x+u/2,l.y+1),e.lineTo(l.x+u/2,l.y)),e.strokeStyle="#00000040",e.stroke(),e.filter="none",e.restore()},v2:function(e,t,n,r,o){var a=1/8,l=new Map([[m.I,["#31c7ef","#48e0ff","#20b0e0"]],[m.O,["#f7d308","#ffec1c","#e8c000"]],[m.T,["#ad4d9c","#c658b4","#983888"]],[m.J,["#5a65ad","#6680cc","#4857a0"]],[m.L,["#ef7921","#ff9030","#e06810"]],[m.S,["#42b642","#48d048","#30a030"]],[m.Z,["#ef2029","#ff4848","#d01818"]]]),i=t,u=l.get(n);Object(ge["a"])(null!=u,"no color for piece"),e.save(),o==We.ghost?(e.fillStyle="white",e.fillRect(i.x,i.y,1,1),e.globalAlpha=.4):o==We.disabled&&(e.filter="grayscale(100%)"),e.translate(i.x,i.y);var c=a,f=a/2,d=1-a,s=1-a/2;e.fillStyle=u[0],e.fillRect(c,c,1-2*a,1-2*a),e.lineCap="butt",e.lineWidth=a,e.beginPath(),e.moveTo(f,d),e.lineTo(f,c),e.strokeStyle=r[7]?u[1]:u[0],e.stroke(),e.beginPath(),e.moveTo(c,f),e.lineTo(d,f),e.strokeStyle=r[1]?u[1]:u[0],e.stroke(),e.beginPath(),e.moveTo(0,f),e.lineTo(f,f),e.lineTo(f,0),e.strokeStyle=r[0]||r[7]||r[1]?u[1]:u[0],e.stroke(),e.beginPath(),e.moveTo(s,c),e.lineTo(s,d),e.strokeStyle=r[3]?u[2]:u[0],e.stroke(),e.beginPath(),e.moveTo(d,s),e.lineTo(c,s),e.strokeStyle=r[5]?u[2]:u[0],e.stroke(),e.beginPath(),e.moveTo(1,s),e.lineTo(s,s),e.lineTo(s,1),e.strokeStyle=r[4]||r[3]||r[5]?u[2]:u[0],e.stroke(),e.beginPath(),e.moveTo(s,0),e.lineTo(s,f),e.lineTo(1,f),e.strokeStyle=r[2]&&r[1]&&r[3]?u[0]:r[1]?u[1]:r[3]||r[2]?u[2]:u[0],e.stroke(),e.beginPath(),e.moveTo(f,1),e.lineTo(f,s),e.lineTo(0,s),e.strokeStyle=r[6]&&r[7]&&r[5]?u[0]:r[7]?u[1]:r[5]?u[2]:r[6]?u[1]:u[0],e.stroke(),e.filter="none",e.restore()}};(function(e){e[e["normal"]=0]="normal",e[e["ghost"]=1]="ghost",e[e["disabled"]=2]="disabled"})(We||(We={}));var Ke=256;function $e(e,t,n){for(var r=t<<8,o=0;o<8;++o)e[o]&&(r|=1<<o);return x.scale(new x(r%Ke,Math.floor(r/Ke)),n)}function He(e,t,n){var r=(new TextEncoder).encode(t.toString());window.crypto.subtle.digest("SHA-256",r).then((function(r){var o=Array.from(new Uint8Array(r)).map((function(e){return e.toString(16).padStart(2,"0")})).join(""),a=localStorage.getItem("mfro:tetris-tilesheet");if(a){var l=JSON.parse(a);if(l.hash==o)return void n(l.list);console.log("tilesheet hash match ".concat(l.hash," expected ").concat(o))}var i=[We.normal,We.ghost,We.disabled],u=document.createElement("canvas");u.width=e*Ke,u.height=e*i.length*(256/Ke);var c=u.getContext("2d");Object(ge["a"])(null!=c,"no context"),c.scale(e,e);var f,d=[],s=Object(me["a"])(m.all);try{for(s.s();!(f=s.n()).done;){var b=f.value;c.clearRect(0,0,u.width,u.height);var v,j=Object(me["a"])(i);try{for(j.s();!(v=j.n()).done;)for(var p=v.value,O=0;O<256;++O){for(var g=[],y=0;y<8;++y)g[y]=0!=(O&1<<y);var _=$e(g,p,1);t(c,_,b,g,p)}}catch(x){j.e(x)}finally{j.f()}var h=u.toDataURL();d.push(h),d.length==m.all.length&&(localStorage.setItem("mfro:tetris-tilesheet",JSON.stringify({hash:o,list:d})),n(d))}}catch(x){s.e(x)}finally{s.f()}}))}var Qe=[new x(-1,-1),new x(0,-1),new x(1,-1),new x(1,0),new x(1,1),new x(0,1),new x(-1,1),new x(-1,0)];function Xe(e,t){var n=32,o=1/n,a=new Map;function l(e){return e.x<0||e.x>=t.rules.field_size.x||e.y<0||e.y>=t.rules.field_size.y?null:t.state.field[e.y][e.x]}function i(e,t,r,o){var l=a.get(t),i=$e(r,o,n),u=new je["f"];return u.scale=new je["d"](1/n,1/n),u.texture=new je["g"](l,new je["e"](i.x,i.y,n,n)),u.position=new je["d"](e.x,e.y),u}e.width=(t.rules.field_size.x+12)*n,e.height=t.rules.field_size.y/2*n,e.style.width="".concat(e.width,"px"),e.style.height="".concat(e.height,"px");var u=function(){function e(t){Object(_["a"])(this,e),this.container=t,this.sprites=[]}return Object(h["a"])(e,[{key:"clear",value:function(){var e,t=Object(me["a"])(this.sprites);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.container.removeChild(n)}}catch(r){t.e(r)}finally{t.f()}this.sprites=[]}},{key:"draw_tetronimo",value:function(e,t){var n,r=this,o=e.kind.rotations[e.rotation],a=Object(me["a"])(e.kind.rotations[e.rotation]);try{var l=function(){var a=n.value,l=x.add(e.position,a),u=Qe.map((function(e){return o.every((function(t){return!x.eq(t,x.add(a,e))}))})),c=i(l,e.kind,u,t);r.sprites.push(c),r.container.addChild(c)};for(a.s();!(n=a.n()).done;)l()}catch(u){a.e(u)}finally{a.f()}}}]),e}();function c(e){var o=e().length,a=new je["b"],l=new je["c"];a.addChild(l),l.scale=new je["d"](1/n,1/n);var i=x.scale(new x(0,0),n),c=x.scale(new x(4,1+3*o),n),f=2,d=8;l.lineStyle(f,8421504,1,0),l.moveTo(i.x,i.y+d),l.lineTo(i.x,i.y),l.lineTo(i.x+d,i.y),l.moveTo(c.x-d,i.y),l.lineTo(c.x,i.y),l.lineTo(c.x,i.y+d),l.moveTo(c.x,c.y-d),l.lineTo(c.x,c.y),l.lineTo(c.x-d,c.y),l.moveTo(i.x+d,c.y),l.lineTo(i.x,c.y),l.lineTo(i.x,c.y-d);var s=new u(a);return Object(r["E"])((function(){return[e(),t.state.hold_available]}),(function(e){var t=Object(ve["a"])(e,2),n=t[0],r=t[1];s.clear();var o,a=new x(2,2),l=Object(me["a"])(n);try{for(l.s();!(o=l.n()).done;){var i=o.value;if(i){var u=Le({id:-1,kind:i,position:x.zero,rotation:0}),c=u.reduce((function(e,t){return Math.min(e,t.x)}),1/0)+.5,f=u.reduce((function(e,t){return Math.min(e,t.y)}),1/0)+.5,d=u.reduce((function(e,t){return Math.max(e,t.x)}),-1/0)+.5,b=u.reduce((function(e,t){return Math.max(e,t.y)}),-1/0)+.5,v=new x(-(c+d)/2,-(f+b)/2),m=x.add(a,v),j=1!=n.length||r?We.normal:We.disabled;s.draw_tetronimo({id:-1,kind:i,position:m,rotation:0},j),a=x.add(a,new x(0,3))}}}catch(p){l.e(p)}finally{l.f()}}),{immediate:!0}),a}function f(e){e.beginFill(16777215),e.drawRect(0,0,t.rules.field_size.x,t.rules.field_size.y),e.endFill(),e.lineStyle(o,16053492);for(var n=0;n<t.rules.field_size.x;++n)e.moveTo(n+.5*o,0),e.lineTo(n+.5*o,t.rules.field_size.y),e.moveTo(n+1-.5*o,0),e.lineTo(n+1-.5*o,t.rules.field_size.y);for(var r=0;r<t.rules.field_size.y;++r)e.moveTo(0,r+.5*o),e.lineTo(t.rules.field_size.x,r+.5*o),e.moveTo(0,r+1-.5*o),e.lineTo(t.rules.field_size.x,r+1-.5*o)}var d=new je["a"]({view:e,width:n*(t.rules.field_size.x+12),height:n*(t.rules.field_size.y/2),transparent:!0});return He(n,Ze.v2,(function(e){e.forEach((function(e,t){d.loader.add(t.toString(),e)})),d.loader.load()})),d.loader.onLoad.once((function(){for(var e=0;e<7;++e){var o=d.loader.resources[e].texture.baseTexture;a.set(m.all[e],o)}var s=new je["b"];s.scale=new je["d"](n,n);var b=new je["b"];b.position=new je["d"](6,-t.rules.field_size.y/2);var v=new je["c"];f(v);var j=c((function(){return[t.state.holding]}));j.position=new je["d"](1,1);var p=c((function(){return t.state.fall_queue.slice(0,5)}));p.position=new je["d"](7+t.rules.field_size.x,1),b.addChild(v),s.addChild(b),s.addChild(p),s.addChild(j),d.stage.addChild(s);for(var O=function(e){for(var n=function(n){var o=new x(e,n),a=null;Object(r["F"])((function(){null!=a&&(b.removeChild(a),a=null);var r=t.state.field[n][e];if(null!=r){var u=Qe.map((function(e){var t;return(null===(t=l(x.add(o,e)))||void 0===t?void 0:t.id)!=r.id}));a=i(new x(e,n),r.kind,u,We.normal),b.addChild(a)}}))},o=0;o<t.rules.field_size.y;++o)n(o)},y=0;y<t.rules.field_size.x;++y)O(y);var _=new u(b);Object(r["F"])((function(){if(_.clear(),t.state.falling){var e=t.hard_drop_position(t.state.falling),n=Object(g["a"])(Object(g["a"])({},t.state.falling),{},{position:e});_.draw_tetronimo(n,We.ghost),_.draw_tetronimo(t.state.falling,We.normal)}}))})),function(){return d.destroy()}}var Ye={name:"game",props:{value:Object},setup:function(e){var t,n=Object(r["C"])(e,"value"),o=Object(r["u"])(null);return Object(r["o"])((function(){Object(r["E"])(n,(function(e,n){var r;null===(r=t)||void 0===r||r(),e&&(t=Xe(o.value,e))}),{immediate:!0})})),{canvas:o}}};Ye.render=be;var et=Ye,tt=Object(r["i"])("content_paste"),nt=Object(r["i"])("check");function rt(e,t,n,o,a,l){var i=Object(r["x"])("v-icon"),u=Object(r["x"])("v-button"),c=Object(r["x"])("v-text-field"),f=Object(r["x"])("v-flex");return Object(r["p"])(),Object(r["f"])(f,{"align-center":"","justify-center":""},{default:Object(r["G"])((function(){return[Object(r["j"])(u,{small:"",icon:"",onClick:t[1]||(t[1]=function(e){return o.copy()}),onMouseleave:t[2]||(t[2]=function(e){return o.copied=!1})},{default:Object(r["G"])((function(){return[o.copied?(Object(r["p"])(),Object(r["f"])(i,{key:1,small:"",bold:"",style:{color:"#4caf50"}},{default:Object(r["G"])((function(){return[nt]})),_:1})):(Object(r["p"])(),Object(r["f"])(i,{key:0,small:""},{default:Object(r["G"])((function(){return[tt]})),_:1}))]})),_:1}),Object(r["j"])(c,{small:"",class:"mt-0 ml-4",ref:"input",solo:"","model-value":n.value},null,8,["model-value"])]})),_:1})}var ot={name:"clipboard",props:{value:String},setup:function(e){var t=Object(r["A"])(null),n=Object(r["A"])(!1);return{input:t,copied:n,copy:function(){t.value.select(),document.execCommand("copy"),n.value=!0}}}};ot.render=rt;var at=ot,lt={name:"room",components:{game:et,clipboard:at,editConfig:ae},props:["room"],setup:function(e){var t=window.location,n=Object(r["d"])((function(){return"".concat(t.origin).concat(t.pathname,"?code=").concat(e.room.code)})),o=Object(r["A"])(!1),a=Object(r["z"])({field_size:new x(10,40),fall_delay:50,lock_delay:30,move_reset_limit:15,wall_kicks:j.standard,bag_preview:5}),l=Object(r["d"])((function(){return e.room.members.filter((function(t,n){return n!=e.room.index}))}));return{link:n,editing:o,game_rules:a,others:l,start:function(){e.room.start_game(a)}}}};lt.render=de,lt.__scopeId="data-v-5479d942";var it=lt,ut=Object(r["J"])("data-v-6be00a92");Object(r["s"])("data-v-6be00a92");var ct=Object(r["j"])("span",null,"Create lobby",-1),ft=Object(r["i"])("arrow_forward");Object(r["q"])();var dt=ut((function(e,t,n,o,a,l){var i=Object(r["x"])("edit-config"),u=Object(r["x"])("v-dialog"),c=Object(r["x"])("game"),f=Object(r["x"])("v-grow"),d=Object(r["x"])("v-text-field"),s=Object(r["x"])("v-icon"),b=Object(r["x"])("v-button"),v=Object(r["x"])("v-flex"),m=Object(r["x"])("v-card");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(u,{"model-value":o.editing},{default:ut((function(){return[Object(r["j"])(i,{kind:"game",modelValue:o.game_rules,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.game_rules=e}),onClose:t[2]||(t[2]=function(e){return o.editing=!1})},null,8,["modelValue"])]})),_:1},8,["model-value"]),Object(r["j"])(v,{column:"",grow:"","align-center":""},{default:ut((function(){return[Object(r["j"])(c,{value:o.local_game},null,8,["value"]),Object(r["j"])(f),Object(r["j"])(m,{class:"mt-4"},{default:ut((function(){return[Object(r["j"])(d,{label:"Name",modelValue:o.name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.name=e})},null,8,["modelValue"]),Object(r["j"])(v,{"justify-center":"",class:"my-2"},{default:ut((function(){return[Object(r["j"])(b,{text:"",color:"primary",disabled:!o.valid,onClick:t[4]||(t[4]=function(e){return o.create_room()})},{default:ut((function(){return[ct,Object(r["j"])(s,{class:"ml-3"},{default:ut((function(){return[ft]})),_:1})]})),_:1},8,["disabled"])]})),_:1})]})),_:1})]})),_:1})],64)})),st=(n("32ec"),n("5f99"),n("4c57")),bt=n("d313"),vt=n("b740");function mt(e,t,n){var r=e[t];e[t]=function(){var e=r.apply(void 0,arguments);return n.apply(void 0,arguments),e}}function jt(e,t,n){var o,a="box:8080"==window.location.host||"localhost:8080"==window.location.host?"ws://box:8081/":"wss://api.mfro.me/tetris/play",l=Object(r["z"])({local:null,index:0,members:[],code:n,state:0,start_game:function(e){var t=Oe()(Math.random()).uint32();Object(bt["c"])(o,vt["f"],{seed:t,rules:p.save(e)})}});function i(){if(l.members.every((function(e,t){return!e.game||e.game.state.dead}))){l.local=null;var e,t=Object(me["a"])(l.members);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.game=null}}catch(r){t.e(r)}finally{t.f()}}}o=l.code?new WebSocket("".concat(a,"?name=").concat(e,"&code=").concat(l.code)):new WebSocket("".concat(a,"?name=").concat(e));var u=null;return Object(st["c"])(Object(bt["b"])(o,vt["e"]),(function(e){var n;null===(n=u)||void 0===n||n();var r=p.load(e.rules),a=Ee(Ne(r,e.seed));l.local=Be(r,a);for(var c=0;c<e.players;++c)if(c==l.index)l.members[c].game=l.local;else{var f=Ee(Ne(r,e.seed));l.members[c].game=Be(r,f)}mt(l.local,"hold",(function(){return Object(bt["c"])(o,vt["b"],{type:"hold"})})),mt(l.local,"drop",(function(e){return Object(bt["c"])(o,vt["b"],{type:"drop",distance:e})})),mt(l.local,"shift",(function(e){return Object(bt["c"])(o,vt["b"],{type:"shift",dir:e})})),mt(l.local,"rotate",(function(e){return Object(bt["c"])(o,vt["b"],{type:"rotate",dir:e})})),mt(l.local,"lock_down",(function(){return Object(bt["c"])(o,vt["b"],{type:"lock_down"})})),mt(l.local,"new_falling",(function(){return Object(bt["c"])(o,vt["b"],{type:"new_falling"})})),mt(l.local,"end_game",(function(){Object(bt["c"])(o,vt["b"],{type:"end_game"}),i()})),u=Fe(t,l.local)})),Object(st["c"])(Object(bt["b"])(o,vt["a"]),(function(e){var t=Object(ve["a"])(e,2),n=t[0],r=t[1],o=l.members[n].game;switch(r.type){case"hold":o.hold();break;case"drop":o.drop(r.distance);break;case"shift":o.shift(r.dir);break;case"rotate":o.rotate(r.dir);break;case"lock_down":o.lock_down();break;case"new_falling":o.new_falling();break;case"end_game":o.end_game(),i();break}})),Object(st["c"])(Object(bt["b"])(o,vt["c"]),(function(e){if(e!=l.code){var t=new URL(window.location.href);t.searchParams.delete("code"),window.history.replaceState(null,document.title,t.pathname+t.search)}l.code=e})),Object(st["c"])(Object(bt["b"])(o,vt["d"]),(function(e){var t=e.index,n=e.names;if(l.members=n.map((function(e){return{name:e,game:null}})),l.index=t,l.members.length>1){var r=new URL(window.location.href);r.searchParams.set("code",l.code),window.history.replaceState(null,document.title,r.pathname+r.search)}})),l}var pt={name:"landing",components:{game:et,editConfig:ae,configGameRules:$,configUserPrefs:re},emits:["room"],setup:function(e,t){var n,o,a=t.emit,l=Object(r["A"])(null),i=Object(r["z"])({field_size:new x(10,40),fall_delay:50,lock_delay:30,move_reset_limit:15,wall_kicks:j.standard,bag_preview:5}),u=Object(r["l"])("user_prefs"),c=Object(r["A"])(null),f=function(){var e;null===(e=o)||void 0===e||e();var t=Ee(Ne(i));c.value=Be(i,t),o=Fe(u,c.value)};Object(r["o"])((function(){f()})),Object(r["n"])((function(){var e;return null===(e=o)||void 0===e?void 0:e()})),Pe(Me,(function(){return f()}));var d=Object(r["A"])(null!==(n=localStorage.getItem("mfro:user-name"))&&void 0!==n?n:""),s=Object(r["d"])((function(){return""!=d.value}));return{local_game:c,editing:l,game_rules:i,name:d,valid:s,create_room:function(){localStorage.setItem("mfro:user-name",d.value);var e=jt(d.value,u);a("room",e)},edit:function(e){l.value=e}}}};n("fb02"),n("b283");pt.render=dt,pt.__scopeId="data-v-6be00a92";var Ot=pt,gt=Object(r["J"])("data-v-d871ed76");Object(r["s"])("data-v-d871ed76");var yt=Object(r["j"])("span",null,"Join lobby",-1),_t=Object(r["i"])("arrow_forward");Object(r["q"])();var ht=gt((function(e,t,n,o,a,l){var i=Object(r["x"])("v-text-field"),u=Object(r["x"])("v-icon"),c=Object(r["x"])("v-button"),f=Object(r["x"])("v-flex"),d=Object(r["x"])("v-card");return Object(r["p"])(),Object(r["f"])(f,{column:"",grow:"","align-center":""},{default:gt((function(){return[Object(r["j"])(d,{class:"mb-4"},{default:gt((function(){return[Object(r["j"])(i,{label:"Code",modelValue:o.code,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.code=e})},null,8,["modelValue"]),Object(r["j"])(i,{label:"Name",modelValue:o.name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.name=e})},null,8,["modelValue"]),Object(r["j"])(f,{"justify-center":"",class:"my-2"},{default:gt((function(){return[Object(r["j"])(c,{text:"",color:"primary",disabled:!o.valid,onClick:t[3]||(t[3]=function(e){return o.submit()})},{default:gt((function(){return[yt,Object(r["j"])(u,{class:"ml-3"},{default:gt((function(){return[_t]})),_:1})]})),_:1},8,["disabled"])]})),_:1})]})),_:1})]})),_:1})})),xt={name:"joining",emits:["room"],props:{code:String},setup:function(e,t){var n,o=t.emit,a=Object(r["A"])(null!==(n=localStorage.getItem("mfro:user-name"))&&void 0!==n?n:""),l=Object(r["A"])(e.code),i=Object(r["d"])((function(){return""!=a.value})),u=Object(r["l"])("user_prefs");return{name:a,code:l,valid:i,submit:function(){localStorage.setItem("mfro:user-name",a.value);var e=jt(a.value,u,l.value);o("room",e)}}}};n("b493"),n("7591");xt.render=ht,xt.__scopeId="data-v-d871ed76";var wt=xt,kt={name:"tetris",components:{editConfig:ae,room:it,landing:Ot,joining:wt},setup:function(){var e=Object(r["A"])(null),t=new URL(window.location.href),n=t.searchParams.get("code"),o=Object(r["A"])(n),a=localStorage.getItem("mfro:tetris-user-preferences"),l=Object(r["A"])(!1),i=a?JSON.parse(a):{autoshift:{delay:2,initial_delay:10},soft_drop:10};return Object(r["r"])("user_prefs",i),{current_room:e,joining_code:o,editing_user:l,user_prefs:Object(r["d"])({get:function(){return i},set:function(e){Object.assign(i,e),localStorage.setItem("mfro:tetris-user-preferences",JSON.stringify(e))}})}}};n("2195"),n("50a0");kt.render=u,kt.__scopeId="data-v-3ed78246";var Vt=kt;Object(r["e"])(Vt).use(o["a"]).mount("#app")},ce31:function(e,t,n){"use strict";n("91bd")},e70f:function(e,t,n){},fb02:function(e,t,n){"use strict";n("3ad7")}});
//# sourceMappingURL=index.07003eed.js.map