(function(e){function t(t){for(var r,i,a=t[0],u=t[1],c=t[2],d=0,s=[];d<a.length;d++)i=a[d],Object.prototype.hasOwnProperty.call(l,i)&&l[i]&&s.push(l[i][0]),l[i]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);f&&f(t);while(s.length)s.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,a=1;a<n.length;a++){var u=n[a];0!==l[u]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},l={index:0},o=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],u=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var f=u;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},1058:function(e,t,n){"use strict";n("5e0c")},"162c":function(e,t,n){},"17c2":function(e,t,n){e.exports={root:"config-number_root_1JO2c"}},"1b87":function(e,t,n){},"1f42":function(e,t,n){"use strict";n("162c")},"2c01":function(e,t,n){e.exports=n.p+"img/tetrio.f8eaf703.png"},"36ef":function(e,t,n){"use strict";n("bacd")},"3c4c":function(e,t,n){"use strict";var r=n("17c2"),l=n.n(r);n.d(t,"default",(function(){return l.a}))},4232:function(e,t,n){e.exports=n.p+"img/tetrio-bg.bfe283a4.png"},"5e0c":function(e,t,n){},7129:function(e,t,n){e.exports={root:"config-boolean_root_3o7bx"}},bacd:function(e,t,n){},cbc2:function(e,t,n){"use strict";n("81b1");var r=n("fee1");n.d(t,"a",(function(){return r["a"]})),n.d(t,"b",(function(){return r["b"]})),n.d(t,"c",(function(){return r["c"]})),n.d(t,"d",(function(){return r["d"]})),n.d(t,"e",(function(){return r["e"]})),n.d(t,"f",(function(){return r["f"]})),n.d(t,"g",(function(){return r["g"]})),n.d(t,"h",(function(){return r["h"]})),n.d(t,"i",(function(){return r["i"]})),n.d(t,"j",(function(){return r["j"]})),n.d(t,"k",(function(){return r["k"]})),n.d(t,"l",(function(){return r["l"]})),n.d(t,"m",(function(){return r["m"]})),n.d(t,"n",(function(){return r["n"]})),n.d(t,"o",(function(){return r["o"]})),n.d(t,"p",(function(){return r["p"]})),n.d(t,"q",(function(){return r["q"]})),n.d(t,"r",(function(){return r["r"]})),n.d(t,"s",(function(){return r["s"]})),n.d(t,"t",(function(){return r["t"]})),n.d(t,"u",(function(){return r["u"]})),n.d(t,"v",(function(){return r["v"]})),n.d(t,"w",(function(){return r["w"]})),n.d(t,"x",(function(){return r["x"]})),n.d(t,"y",(function(){return r["y"]})),n.d(t,"z",(function(){return r["z"]})),n.d(t,"A",(function(){return r["A"]})),n.d(t,"B",(function(){return r["B"]})),n.d(t,"C",(function(){return r["C"]})),n.d(t,"D",(function(){return r["D"]})),n.d(t,"E",(function(){return r["E"]})),n.d(t,"F",(function(){return r["F"]})),n.d(t,"G",(function(){return r["G"]})),n.d(t,"H",(function(){return r["H"]})),n.d(t,"I",(function(){return r["I"]})),n.d(t,"J",(function(){return r["J"]}));n("669d")},cd49:function(e,t,n){"use strict";n.r(t);n("fd85"),n("15db"),n("c026"),n("4031");var r=n("cbc2"),l=n("34c7"),o=Object(r["J"])("data-v-45e58851");Object(r["s"])("data-v-45e58851");var i=Object(r["i"])("settings"),a=Object(r["j"])("span",null,"User preferences",-1);Object(r["q"])();var u=o((function(e,t,n,l,u,c){var f=Object(r["x"])("edit-config"),d=Object(r["x"])("v-dialog"),s=Object(r["x"])("v-icon"),b=Object(r["x"])("v-button"),m=Object(r["x"])("v-flex"),j=Object(r["x"])("room"),p=Object(r["x"])("joining"),v=Object(r["x"])("landing"),O=Object(r["x"])("v-app");return Object(r["p"])(),Object(r["f"])(O,{"align-center":"",class:"pb-6 root"},{default:o((function(){return[Object(r["j"])(d,{"model-value":l.editing_user},{default:o((function(){return[Object(r["j"])(f,{kind:"user",modelValue:l.user_prefs,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.user_prefs=e}),onClose:t[2]||(t[2]=function(e){return l.editing_user=!1})},null,8,["modelValue"])]})),_:1},8,["model-value"]),Object(r["j"])(m,{class:"user pa-4"},{default:o((function(){return[Object(r["j"])(b,{onClick:t[3]||(t[3]=function(e){return l.editing_user=!0})},{default:o((function(){return[Object(r["j"])(s,{class:"mr-3"},{default:o((function(){return[i]})),_:1}),a]})),_:1})]})),_:1}),null!=l.current_room?(Object(r["p"])(),Object(r["f"])(j,{key:0,room:l.current_room},null,8,["room"])):null!=l.joining_code?(Object(r["p"])(),Object(r["f"])(p,{key:1,code:l.joining_code,onRoom:t[4]||(t[4]=function(e){return l.current_room=e})},null,8,["code"])):(Object(r["p"])(),Object(r["f"])(v,{key:2,onRoom:t[5]||(t[5]=function(e){return l.current_room=e})}))]})),_:1})})),c=(n("241c"),n("84ca"),n("5a85"),n("534d"),n("f432"),n("2e1a")),f=Object(r["i"])("Game rules"),d=Object(r["i"])("User preferences"),s=Object(r["i"])("close"),b=Object(r["j"])("span",null,"Save",-1);function m(e,t,n,l,o,i){var a=Object(r["x"])("v-text"),u=Object(r["x"])("v-grow"),c=Object(r["x"])("v-icon"),m=Object(r["x"])("v-button"),j=Object(r["x"])("config-game-rules"),p=Object(r["x"])("config-user-prefs"),v=Object(r["x"])("v-card");return Object(r["p"])(),Object(r["f"])(v,{style:{"min-width":"60ch"}},{title:Object(r["G"])((function(){return["game"==n.kind?(Object(r["p"])(),Object(r["f"])(a,{key:0,title:""},{default:Object(r["G"])((function(){return[f]})),_:1})):Object(r["g"])("",!0),"user"==n.kind?(Object(r["p"])(),Object(r["f"])(a,{key:1,title:""},{default:Object(r["G"])((function(){return[d]})),_:1})):Object(r["g"])("",!0),Object(r["j"])(u),Object(r["j"])(m,{icon:"",small:"",onClick:t[1]||(t[1]=function(t){return e.$emit("close")})},{default:Object(r["G"])((function(){return[Object(r["j"])(c,null,{default:Object(r["G"])((function(){return[s]})),_:1})]})),_:1})]})),actions:Object(r["G"])((function(){return[Object(r["j"])(u),Object(r["j"])(m,{color:"primary",onClick:t[4]||(t[4]=function(e){return l.save()})},{default:Object(r["G"])((function(){return[b]})),_:1})]})),default:Object(r["G"])((function(){return["game"==n.kind?(Object(r["p"])(),Object(r["f"])(j,{key:0,modelValue:l.value,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.value=e})},null,8,["modelValue"])):Object(r["g"])("",!0),"user"==n.kind?(Object(r["p"])(),Object(r["f"])(p,{key:1,modelValue:l.value,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.value=e})},null,8,["modelValue"])):Object(r["g"])("",!0)]})),_:1})}function j(e,t,n,l,o,i){var a=Object(r["x"])("config-rational"),u=Object(r["x"])("config-number"),c=Object(r["x"])("config-select");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(a,{name:"Gravity",description:"Gravity for falling pieces (tiles per frame)",modelValue:l.gravity,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.gravity=e}),filter:function(e){return e<=20}},null,8,["modelValue","filter"]),Object(r["j"])(u,{name:"Lock delay",description:"Delay after touching the ground before a piece locks down (frames)",modelValue:l.lock_delay,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.lock_delay=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"]),Object(r["j"])(u,{name:"Move reset limit",description:"Maximum number of times the lock delay can be reset by successful shifts or rotates",modelValue:l.move_reset_limit,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.move_reset_limit=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"]),Object(r["j"])(u,{name:"Preview size",description:"Number of pieces in the preview",modelValue:l.bag_preview,"onUpdate:modelValue":t[4]||(t[4]=function(e){return l.bag_preview=e}),filter:function(e){return e>=0&&e<=6}},null,8,["modelValue","filter"]),Object(r["j"])(c,{name:"Wall kick style",description:"Wall kick configuration to use for rotations",modelValue:l.wall_kicks,"onUpdate:modelValue":t[5]||(t[5]=function(e){return l.wall_kicks=e}),options:l.wallKickOptions},null,8,["modelValue","options"])],64)}var p,v,O,g=n("98ad"),y=(n("862d"),n("b902"),n("966c"),n("d50c"),n("e82c")),_=n("862b"),h=n("c812"),x=function(){function e(t,n){Object(_["a"])(this,e),this.x=t,this.y=n}return Object(h["a"])(e,[{key:"len",get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"dir",get:function(){return Math.atan2(this.y,this.x)}}],[{key:"norm",value:function(t){return e.polar(1,t.dir)}},{key:"scale",value:function(t,n){return new e(t.x*n,t.y*n)}},{key:"add",value:function(t,n){return new e(t.x+n.x,t.y+n.y)}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"eq",value:function(e,t){return e.x==t.x&&e.y==t.y}},{key:"delta",value:function(t,n){var r=e.dot(t,n),l=Math.acos(r/t.len/n.len);return t.y*n.x>t.x*n.y?-l:l}},{key:"polar",value:function(t,n){return new e(Math.cos(n)*t,Math.sin(n)*t)}}]),e}();function w(e){return{type:"constant",value:e}}function k(e){return{type:"optional",inner:e}}function V(e,t){return{type:"natural",name:e,description:t}}function z(e,t){return{type:"rational",name:e,description:t}}function S(e,t,n){return{type:"select",name:e,description:t,options:n}}function G(e,t,n){return{type:"object",name:e,description:t,inner:n}}x.zero=new x(0,0),function(e){function t(e,t){for(var n=t.map((function(e){return new x(e[0],e[1])})),r=[n],l=0;l<3;++l)n=n.map((function(t){return new x(e-1-t.y,t.x)})),r.push(n);return{size:e,rotations:r}}e.I=t(4,[[0,1],[1,1],[2,1],[3,1]]),e.O=t(2,[[0,0],[0,1],[1,0],[1,1]]),e.T=t(3,[[1,0],[0,1],[1,1],[2,1]]),e.J=t(3,[[0,0],[0,1],[1,1],[2,1]]),e.L=t(3,[[2,0],[0,1],[1,1],[2,1]]),e.S=t(3,[[1,0],[2,0],[0,1],[1,1]]),e.Z=t(3,[[0,0],[1,0],[1,1],[2,1]]),e.GARBAGE=t(0,[]),e.all=[e.I,e.O,e.T,e.J,e.L,e.S,e.Z]}(p||(p={})),function(e){function t(e){return e.map((function(e){return[x.zero].concat(Object(y["a"])(e.map((function(e){return new x(e[0],-e[1])}))))}))}var n=t([[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]],[[0,0]]]),r=t([[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]]]),l=t([[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]]]),o=t([[[0,0],[-2,0],[1,0],[1,2],[-2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[-2,0],[1,0],[-2,1],[1,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-1]],[[0,0],[1,0],[-2,0],[1,2],[-2,-1]],[[0,0],[-2,0],[1,0],[-2,1],[1,-2]],[[0,0],[2,0],[-1,0],[-1,2],[2,-1]]]);e.standard=new Map([[p.I,l],[p.O,r],[p.T,r],[p.J,r],[p.L,r],[p.S,r],[p.Z,r]]),e.asira=new Map([[p.I,o],[p.O,r],[p.T,r],[p.J,r],[p.L,r],[p.S,r],[p.Z,r]]),e.none=new Map([[p.I,n],[p.O,n],[p.T,n],[p.J,n],[p.L,n],[p.S,n],[p.Z,n]]),e.all=[e.none,e.standard,e.asira]}(v||(v={})),function(e){function t(e){return{field_size:[e.field_size.x,e.field_size.y],fall_delay:e.fall_delay,lock_delay:e.lock_delay,move_reset_limit:e.move_reset_limit,wall_kicks:v.all.indexOf(e.wall_kicks),bag_preview:e.bag_preview}}function n(e){return{field_size:new x(e.field_size[0],e.field_size[1]),fall_delay:e.fall_delay,lock_delay:e.lock_delay,move_reset_limit:e.move_reset_limit,wall_kicks:v.all[e.wall_kicks],bag_preview:e.bag_preview}}e.save=t,e.load=n}(O||(O={}));w(new x(10,40)),z("Drop Delay","Drop delay for falling pieces (frames per tile)"),z("Lock Delay","Lock down delay (frames)"),k(z("Move Reset Limit","Maximum number of times the Lock Delay can be reset by successful shifts or rotates")),S("Wall Kicks","Wall kick data",[["No Kicks",v.none],["Standard",v.standard],["Asira",v.asira]]),V("Preview Size","Number of pieces in the preview"),k(G("Autoshift","Configure repeated shifts while input is held",{delay:z("Delay","Delay between repeated shifts (frames)"),initial_delay:z("Initial Delay","Delay after first shift before repeating (frames)")})),z("Soft Drop Multiplier","Multiplier for Drop Delay while soft dropping"),n("88f6"),n("932a"),n("0ffc");var T=Object(r["J"])("data-v-632a7c32"),A=T((function(e,t,n,l,o,i){var a=Object(r["x"])("v-input"),u=Object(r["x"])("v-tooltip");return Object(r["p"])(),Object(r["f"])(u,{right:"",text:n.description},{default:T((function(){return[Object(r["j"])(a,{label:n.name,onClick:t[2]||(t[2]=function(t){return e.$refs.select.click()})},{default:T((function(e){var o=e.id;return[Object(r["H"])(Object(r["j"])("select",{id:o,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.value=e}),ref:"select"},[(Object(r["p"])(!0),Object(r["f"])(r["a"],null,Object(r["v"])(n.options,(function(e,t){return Object(r["p"])(),Object(r["f"])("option",{key:e[0],value:t},Object(r["B"])(e[0]),9,["value"])})),128))],8,["id"]),[[r["D"],l.value]])]})),_:1},8,["label"])]})),_:1},8,["text"])})),R=(n("156c"),{name:"config-select",emits:["update:modelValue"],props:{name:String,description:String,modelValue:{},options:Array},setup:function(e,t){var n=t.emit,l=Object(r["d"])({get:function(){return e.options.findIndex((function(t){return t[1]==e.modelValue}))},set:function(t){n("update:modelValue",e.options[t][1])}});return{value:l}}});n("1f42");R.render=A,R.__scopeId="data-v-632a7c32";var C=R;function U(e,t,n,l,o,i){var a=Object(r["x"])("v-text-field"),u=Object(r["x"])("v-tooltip");return Object(r["p"])(),Object(r["f"])(u,{right:"",text:n.description},{default:Object(r["G"])((function(){return[Object(r["j"])(a,{label:n.name,"model-value":l.state.editing,"onUpdate:modelValue":l.onInput,warning:l.state.error},null,8,["label","model-value","onUpdate:modelValue","warning"])]})),_:1},8,["text"])}n("9588"),n("7e9e"),n("f542");var I={name:"config-number",emits:["update:modelValue"],props:{name:String,description:String,modelValue:Number,filter:Function},setup:function(e,t){var n=t.emit,l=Object(r["z"])({editing:null,error:!1});return Object(r["E"])((function(){return e.modelValue}),(function(){l.editing=e.modelValue.toString()}),{immediate:!0}),{state:l,onInput:function(t){l.editing=t;var o=parseFloat(t);o.toString()!=t||e.filter&&!e.filter(o)?l.error=!0:(l.error=!1,Object(r["m"])((function(){return n("update:modelValue",o)})))}}}},M=n("3c4c");const E=I.__cssModules={};E["$style"]=M["default"],I.render=U;var J=I,P=Object(r["J"])("data-v-0ea7d42c");Object(r["s"])("data-v-0ea7d42c");var D=Object(r["i"])("/");Object(r["q"])();var L=P((function(e,t,n,l,o,i){var a=Object(r["x"])("v-text"),u=Object(r["x"])("v-flex"),c=Object(r["x"])("v-input"),f=Object(r["x"])("v-tooltip");return Object(r["p"])(),Object(r["f"])(f,{right:"",text:n.description},{default:P((function(){return[Object(r["j"])(c,{label:n.name,style:{cursor:"text"},onClick:t[4]||(t[4]=function(t){return e.$refs.top.focus()}),warning:l.state.error},{default:P((function(e){var n=e.id;return[Object(r["j"])(u,null,{default:P((function(){return[Object(r["j"])("input",{ref:"top",id:n,style:{width:"3ch"},value:l.state.top,onInput:t[1]||(t[1]=function(e){return l.setTop(e.target.value)})},null,40,["id","value"]),Object(r["j"])(u,{class:"mx-2",column:"","justify-center":""},{default:P((function(){return[Object(r["j"])(a,null,{default:P((function(){return[D]})),_:1})]})),_:1}),Object(r["j"])("input",{onClick:t[2]||(t[2]=Object(r["I"])((function(){}),["stop"])),value:l.state.bot,onInput:t[3]||(t[3]=function(e){return l.setBot(e.target.value)})},null,40,["value"])]})),_:2},1024)]})),_:1},8,["label","warning"])]})),_:1},8,["text"])})),B={name:"config-rational",emits:["update:modelValue"],props:{name:String,description:String,modelValue:Number,filter:Function},setup:function(e,t){var n=t.emit,l=Object(r["z"])({top:null,bot:null,error:!1});return Object(r["E"])((function(){return e.modelValue}),(function(){e.modelValue>1?(l.top=e.modelValue.toString(),l.bot="1"):(l.top="1",l.bot=1/e.modelValue.toString())}),{immediate:!0}),{state:l,setTop:function(t){l.top=t,l.bot="1";var r=parseInt(t,10);r.toString()!=t||e.filter&&!e.filter(r)?l.error=!0:(l.error=!1,n("update:modelValue",r))},setBot:function(t){l.top="1",l.bot=t;var r=1/parseInt(t,10);(1/r).toString()!=t||e.filter&&!e.filter(r)?l.error=!0:(l.error=!1,n("update:modelValue",r))}}}};n("1058");B.render=L,B.__scopeId="data-v-0ea7d42c";var N=B,q=[["No Kicks",v.none],["Standard",v.standard],["Asira",v.asira]];function W(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return Object(r["d"])({get:function(){return l(t()[n])},set:function(r){var l=Object(c["a"])(Object(c["a"])({},t()),{},Object(g["a"])({},n,o(r)));e("update:modelValue",l)}})}var F={name:"config-game-rules",components:{configSelect:C,configNumber:J,configRational:N},emits:["update:modelValue"],props:{modelValue:Object},setup:function(e,t){var n=t.emit,r=W(n,(function(){return e.modelValue}),"fall_delay",(function(e){return 1/e}),(function(e){return 1/e})),l=W(n,(function(){return e.modelValue}),"lock_delay"),o=W(n,(function(){return e.modelValue}),"move_reset_limit"),i=W(n,(function(){return e.modelValue}),"bag_preview"),a=W(n,(function(){return e.modelValue}),"wall_kicks");return{gravity:r,lock_delay:l,move_reset_limit:o,bag_preview:i,wall_kicks:a,wallKickOptions:q}}};F.render=j;var Z=F;function K(e,t,n,l,o,i){var a=Object(r["x"])("config-autoshift"),u=Object(r["x"])("config-number"),c=Object(r["x"])("config-render");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(a,{modelValue:l.autoshift,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.autoshift=e})},null,8,["modelValue"]),Object(r["j"])(u,{name:"Soft drop multiplier",description:"Gravity multiplier when soft dropping",modelValue:l.soft_drop,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.soft_drop=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"]),Object(r["j"])(c,{modelValue:l.render,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.render=e})},null,8,["modelValue"])],64)}function $(e,t,n,l,o,i){var a=Object(r["x"])("config-number");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(a,{name:"Autoshift delay",description:"Delay between repeated shifts while input is held (ARR)",modelValue:l.delay,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.delay=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"]),Object(r["j"])(a,{name:"Autoshift initial delay",description:"Delay after the initial shift when pressing an input before repeating (DAS)",modelValue:l.initial_delay,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.initial_delay=e}),filter:function(e){return e>=0}},null,8,["modelValue","filter"])],64)}function H(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return Object(r["d"])({get:function(){return l(t()[n])},set:function(r){var l=Object(c["a"])(Object(c["a"])({},t()),{},Object(g["a"])({},n,o(r)));e("update:modelValue",l)}})}var Q={name:"config-autoshift",components:{configNumber:J},emits:["update:modelValue"],props:{modelValue:Object},setup:function(e,t){var n=t.emit,r=H(n,(function(){return e.modelValue}),"delay"),l=H(n,(function(){return e.modelValue}),"initial_delay");return{delay:r,initial_delay:l}}};Q.render=$;var X=Q;function Y(e,t,n,l,o,i){var a=Object(r["x"])("config-select"),u=Object(r["x"])("config-number"),c=Object(r["x"])("config-boolean");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(a,{name:"Render Style",description:"Wall kick configuration to use for rotations",modelValue:l.style,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.style=e}),options:l.styleOptions},null,8,["modelValue","options"]),"toon"==l.style?(Object(r["p"])(),Object(r["f"])(r["a"],{key:0},[Object(r["j"])(u,{name:"Tile size",description:"Size in pixels of each square on the field",modelValue:l.size,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.size=e}),filter:function(e){return e>0}},null,8,["modelValue","filter"]),Object(r["j"])(c,{name:"Smooth rendering",description:"Join tiles of the same tetronimo",modelValue:l.smooth,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.smooth=e})},null,8,["modelValue"]),Object(r["j"])(u,{name:"Border width",description:"Size of the tile border",modelValue:l.border,"onUpdate:modelValue":t[4]||(t[4]=function(e){return l.border=e}),filter:function(e){return e>=0&&e<=l.size/2}},null,8,["modelValue","filter"])],64)):Object(r["g"])("",!0),"pixel"==l.style?(Object(r["p"])(),Object(r["f"])(r["a"],{key:1},[Object(r["j"])(u,{name:"Tile size",description:"Size in pixels of each square on the field",modelValue:l.size,"onUpdate:modelValue":t[5]||(t[5]=function(e){return l.size=e}),filter:function(e){return e>0}},null,8,["modelValue","filter"]),Object(r["j"])(c,{name:"Smooth rendering",description:"Join tiles of the same tetronimo",modelValue:l.smooth,"onUpdate:modelValue":t[6]||(t[6]=function(e){return l.smooth=e})},null,8,["modelValue"]),Object(r["j"])(u,{name:"Border width",description:"Size of the tile border",modelValue:l.border,"onUpdate:modelValue":t[7]||(t[7]=function(e){return l.border=e}),filter:function(e){return e>=0&&e<=l.size/2}},null,8,["modelValue","filter"]),Object(r["j"])(u,{name:"Ghost opacity",description:"Opacity of the ghost preview",modelValue:l.ghost_opacity,"onUpdate:modelValue":t[8]||(t[8]=function(e){return l.ghost_opacity=e}),filter:function(e){return e>=0&&e<=1}},null,8,["modelValue","filter"])],64)):Object(r["g"])("",!0),"tetrio"==l.style?(Object(r["p"])(),Object(r["f"])(c,{key:2,name:"Ghost color",description:"Color the ghost tile",modelValue:l.ghost_color,"onUpdate:modelValue":t[9]||(t[9]=function(e){return l.ghost_color=e})},null,8,["modelValue"])):Object(r["g"])("",!0)],64)}function ee(e,t,n,l,o,i){var a=Object(r["x"])("v-checkbox"),u=Object(r["x"])("v-input"),c=Object(r["x"])("v-tooltip");return Object(r["p"])(),Object(r["f"])(c,{right:"",text:n.description},{default:Object(r["G"])((function(){return[Object(r["j"])(u,{label:n.name,onClick:t[3]||(t[3]=function(e){return l.value=!l.value})},{default:Object(r["G"])((function(e){var n=e.id;return[Object(r["j"])(a,{id:n,modelValue:l.value,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.value=e}),onClick:t[2]||(t[2]=Object(r["I"])((function(){}),["stop"]))},null,8,["id","modelValue"])]})),_:1},8,["label"])]})),_:1},8,["text"])}var te={name:"config-boolean",emits:["update:modelValue"],props:{name:String,description:String,modelValue:Boolean},setup:function(e,t){var n=t.emit,l=Object(r["d"])({get:function(){return e.modelValue},set:function(e){return n("update:modelValue",e)}});return{value:l}}},ne=n("e306");const re=te.__cssModules={};re["$style"]=ne["default"],te.render=ee;var le=te,oe=[["toon","toon"],["pixel","pixel"],["tetr.io","tetrio"]];function ie(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return Object(r["d"])({get:function(){return l(t()[n])},set:function(r){var l=Object(c["a"])(Object(c["a"])({},t()),{},Object(g["a"])({},n,o(r)));e("update:modelValue",l)}})}var ae={name:"config-render",components:{configAutoshift:X,configBoolean:le,configNumber:J,configSelect:C},emits:["update:modelValue"],props:{modelValue:Object},setup:function(e,t){var n=t.emit,r=ie(n,(function(){return e.modelValue}),"size"),l=ie(n,(function(){return e.modelValue}),"smooth"),o=ie(n,(function(){return e.modelValue}),"style"),i=ie(n,(function(){return e.modelValue}),"border"),a=ie(n,(function(){return e.modelValue}),"ghost_opacity"),u=ie(n,(function(){return e.modelValue}),"ghost_color");return{size:r,smooth:l,style:o,border:i,ghost_opacity:a,ghost_color:u,styleOptions:oe}}};ae.render=Y;var ue=ae;function ce(e,t,n){var l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return e};return Object(r["d"])({get:function(){return l(t()[n])},set:function(r){var l=Object(c["a"])(Object(c["a"])({},t()),{},Object(g["a"])({},n,o(r)));e("update:modelValue",l)}})}var fe={name:"config-game-rules",components:{configAutoshift:X,configNumber:J,configRender:ue},emits:["update:modelValue"],props:{modelValue:Object},setup:function(e,t){var n=t.emit,r=ce(n,(function(){return e.modelValue}),"autoshift"),l=ce(n,(function(){return e.modelValue}),"soft_drop"),o=ce(n,(function(){return e.modelValue}),"render");return{autoshift:r,soft_drop:l,render:o}}};fe.render=K;var de=fe,se={name:"edit-config",components:{configGameRules:Z,configUserPrefs:de},emits:["close","update:modelValue"],props:{kind:String,modelValue:Object},setup:function(e,t){var n=t.emit,l=Object(r["A"])(e.modelValue);return Object(r["E"])((function(){return e.modelValue}),(function(e){return l.value=e})),{value:l,save:function(){n("update:modelValue",l.value),n("close")}}}};se.render=m;var be=se,me=(n("eea7"),n("e28c"),n("f1c6"),n("c770"),n("581e"),n("7bea"),n("90fa"),n("feeb"),n("1c98"),n("06a3"),n("1ca0"),n("3a0c"),n("9426"),n("100a"),n("3051"),n("9598"),n("2731"),n("587f"),n("c60d"),n("b285"),n("6a35"),n("b391"),n("1234"),n("dfa9"),n("7c3f"),n("2d6b"),n("0312"),n("1f3b"),n("c666"),n("705d"),n("68d6")),je=n("57d2"),pe=(n("c1c3"),n("7a28")),ve=n("9a81"),Oe=(n("5e5b"),n("b2f1")),ge=n.n(Oe),ye=(n("46c3"),n("4c57")),_e=32,he=37,xe=38,we=16,ke=40,Ve=39,ze=65,Se=90,Ge=83,Te=88,Ae=67,Re=82,Ce=new Set,Ue=new Map,Ie=new Map;function Me(e){return Ce.has(e)}function Ee(e,t){var n=Ue.get(e);return n||Ue.set(e,n=Object(ye["a"])()),Object(ye["d"])(n,t),function(){return Object(ye["c"])(n,t)}}function Je(e,t){var n=Ie.get(e);return n||Ie.set(e,n=Object(ye["a"])()),Object(ye["d"])(n,t),function(){return Object(ye["c"])(n,t)}}window.addEventListener("keydown",(function(e){if(!Ce.has(e.keyCode)){Ce.add(e.keyCode);var t=Ue.get(e.keyCode);t&&(Object(ye["b"])(t),e.preventDefault())}})),window.addEventListener("keyup",(function(e){Ce.delete(e.keyCode);var t=Ie.get(e.keyCode);t&&(Object(ye["b"])(t),e.preventDefault())}));var Pe,De=new x(0,1);function Le(e){return e.kind.rotations[e.rotation].map((function(t){return x.add(e.position,t)}))}function Be(e){for(var t=[],n=0;n<e.field_size.x;++n)t[n]=null;return t}function Ne(e){for(var t=[],n=0;n<e.field_size.y;++n)t[n]=Be(e);return t}function qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===t&&(t=ge()(Math.random()).uint32()),{seed:t,field:Ne(e),falling:null,fall_queue:[],holding:null,hold_available:!0,garbage_ready:[],garbage_pending:[],dead:!1}}function We(e){var t=e.falling;return Object(r["t"])({seed:e.seed,field:e.field.map((function(e){return Object(r["z"])(e)})),falling:Object(r["k"])((function(e,n){return{get:function(){return e(),t},set:function(e){t=e&&Object(r["z"])(e),n()}}})),fall_queue:Object(r["z"])([]),holding:Object(r["A"])(null),hold_available:e.hold_available,garbage_ready:Object(r["z"])(e.garbage_ready),garbage_pending:Object(r["z"])(e.garbage_pending),dead:e.dead})}function Fe(e,t){var n,r=0,l=!1;function o(n){var r,l=Object(je["a"])(Le(n));try{for(l.s();!(r=l.n()).done;){var o=r.value;if(o.x<0||o.x>=e.field_size.x||o.y>=e.field_size.y)return!0;if(!(o.y<0)){var i=t.field[o.y][o.x];if(null!=i)return!0}}}catch(a){l.e(a)}finally{l.f()}return!1}function i(e){var t=e.position;while(1){var n=x.add(t,De);if(o(Object(c["a"])(Object(c["a"])({},e),{},{position:n})))break;t=n}return t}function a(){var e,n;if(!t.dead&&null!=t.falling){var r=t.holding;t.holding=null!==(e=null===(n=t.falling)||void 0===n?void 0:n.kind)&&void 0!==e?e:null,r&&t.fall_queue.unshift(r),t.falling=null,t.hold_available=!1,l=!0}}function u(e){if(t.dead||null==t.falling)return 0;for(var n=0;n<e;++n){var r=x.add(t.falling.position,De);if(o(Object(c["a"])(Object(c["a"])({},t.falling),{},{position:r})))return n;t.falling.position=r}return e}function f(e){if(t.dead||null==t.falling)return!1;var n=x.add(t.falling.position,new x(e,0));return!o(Object(c["a"])(Object(c["a"])({},t.falling),{},{position:n}))&&(t.falling.position=n,!0)}function d(n){if(t.dead||null==t.falling)return!1;var r=(t.falling.rotation+n)%4;r<0&&(r+=4);var l,i=e.wall_kicks.get(t.falling.kind);Object(ve["a"])(null!=i,"no kick info for piece"),l=1==n?i[2*t.falling.rotation]:i[2*r+1];var a,u=Object(je["a"])(l);try{for(u.s();!(a=u.n()).done;){var f=a.value,d=x.add(t.falling.position,f);if(!o(Object(c["a"])(Object(c["a"])({},t.falling),{},{position:d,rotation:r})))return t.falling.position=d,t.falling.rotation=r,!0}}catch(s){u.e(s)}finally{u.f()}return!1}function s(){if(!t.dead&&null!=t.falling){var r,l=Object(je["a"])(Le(t.falling));try{for(l.s();!(r=l.n()).done;){var o=r.value;t.field[o.y][o.x]={id:t.falling.id,kind:t.falling.kind}}}catch(v){l.e(v)}finally{l.f()}for(var i=[],a=0;a<e.field_size.y;++a)t.field[a].every((function(e){return null!=e}))&&i.push(a);i.length>0&&n.clear_lines(i);var u,c=Object(je["a"])(t.garbage_ready);try{for(c.s();!(u=c.n()).done;){var f=u.value,d=ge()(t.seed);t.seed=d.uint32();for(var s=Math.floor(d()*e.field_size.x),b=0;b<e.field_size.y-f;++b)Object.assign(t.field[b],t.field[b+f]);for(var m=e.field_size.y-f;m<e.field_size.y;++m)for(var j=0;j<e.field_size.x;++j)t.field[m][j]=j==s?null:{id:-1,kind:p.GARBAGE}}}catch(v){c.e(v)}finally{c.f()}t.garbage_ready.length=0}}function b(n){var r,l=Object(je["a"])(n);try{for(l.s();!(r=l.n()).done;){for(var o=r.value,i=o;i>0;--i)Object.assign(t.field[i],t.field[i-1]);for(var a=0;a<e.field_size.x;++a)t.field[0][a]=null}}catch(u){l.e(u)}finally{l.f()}}function m(){if(t.dead)return!1;if(t.fall_queue.length-1<e.bag_preview){var n=ge()(t.seed);t.seed=n.uint32();var i=p.all.slice();while(i.length>0){var a=Math.floor(n()*i.length),u=i.splice(a,1)[0];t.fall_queue.push(u)}}var c=t.fall_queue[0],f=new x(5-Math.ceil(c.size/2),e.field_size.y/2-3),d=0,s={id:r++,kind:c,position:f,rotation:d};return t.hold_available=!l,l=!1,!o(s)&&(t.fall_queue.shift(),t.falling=s,!0)}function j(){t.dead=!0,t.falling=null}function v(){var e=t.garbage_pending.shift();t.garbage_ready.push(e)}return n={rules:e,state:t,collide:o,hard_drop_position:i,hold:a,drop:u,shift:f,rotate:d,lock_down:s,clear_lines:b,new_falling:m,end_game:j,apply_garbage:v}}function Ze(e,t){var n=0,r=0,l=0,o=!1,i=!1,a=!1,u=0,f=0;function d(){var e;t.state.dead||(t.new_falling()?(n=null!==(e=t.rules.move_reset_limit)&&void 0!==e?e:1/0,r=0,l=0,t.drop(1)):t.end_game())}function s(e){var n=x.add(e.position,De);return t.collide(Object(c["a"])(Object(c["a"])({},e),{},{position:n}))}function b(){t.lock_down(),d()}function m(){t.state.dead||null==t.state.falling||r>0&&n>0&&(n-=1,r=0)}function j(){t.state.hold_available&&(t.hold(),d())}function p(n){t.state.dead||null==t.state.falling||t.shift(n)&&(m(),e.autoshift&&(f=o?e.autoshift.delay-1:e.autoshift.initial_delay-1,o=!0))}function v(e){t.state.dead||null==t.state.falling||t.rotate(e)&&m()}function O(){t.state.dead||null==t.state.falling||(t.drop(20),b())}function g(e){t.state.dead||null==t.state.falling||(o=!1,1==e?a=!0:i=!0,u=e,p(e))}function y(n){t.state.dead||null==t.state.falling||(1==n?a=!1:i=!1,e.autoshift&&u==n&&(f=o?e.autoshift.delay:e.autoshift.initial_delay),u=i?-1:a?1:0)}d();var _=[Ee(Se,(function(){return v(-1)})),Ee(ze,(function(){return v(-1)})),Ee(Te,(function(){return v(1)})),Ee(Ge,(function(){return v(1)})),Ee(xe,(function(){return v(1)})),Je(he,(function(){return y(-1)})),Ee(he,(function(){return g(-1)})),Je(Ve,(function(){return y(1)})),Ee(Ve,(function(){return g(1)})),Ee(_e,(function(){return O()})),Ee(Ae,(function(){return j()})),Ee(we,(function(){return j()}))],h=0,w=setInterval(k,1e3/60);function k(){if(!t.state.dead){if(f>0?f-=1:e.autoshift&&0!=u&&p(u),null!=t.state.falling)if(s(t.state.falling))r+=1/t.rules.lock_delay,l=Math.min(l,Math.ceil(1/t.rules.fall_delay)),r>=1&&(l=0,r=0,b());else if(Me(ke)?l+=1/t.rules.fall_delay*e.soft_drop:l+=1/t.rules.fall_delay,l>1){var o,i=Math.floor(l),a=t.drop(i);a>0&&(n=null!==(o=t.rules.move_reset_limit)&&void 0!==o?o:1/0),a==i?l-=i:l=0}t.state.garbage_pending.length>0&&(h+=1,60==h&&(t.apply_garbage(),h=0))}}return function(){clearInterval(w);var e,t=Object(je["a"])(_);try{for(t.s();!(e=t.n()).done;){var n=e.value;n()}}catch(r){t.e(r)}finally{t.f()}_.length=0}}function Ke(e){return $e.apply(this,arguments)}function $e(){return $e=Object(pe["a"])(regeneratorRuntime.mark((function e(t){var r,l,o,i,a,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=function(e,t,n,r){function l(t,n){var r=x.add(n,new x(-2,-2)),l=x.add(n,new x(2,3*t-1));e.lineCap="butt",e.lineJoin="miter",e.strokeStyle="gray",e.beginPath();var i=2*o,a=8*o;e.lineWidth=i,e.moveTo(r.x+i/2,r.y+a),e.lineTo(r.x+i/2,r.y+i/2),e.lineTo(r.x+a,r.y+i/2),e.moveTo(l.x-a,r.y+i/2),e.lineTo(l.x-i/2,r.y+i/2),e.lineTo(l.x-i/2,r.y+a),e.moveTo(l.x-i/2,l.y-a),e.lineTo(l.x-i/2,l.y-i/2),e.lineTo(l.x-a,l.y-i/2),e.moveTo(r.x+a,l.y-i/2),e.lineTo(r.x+i/2,l.y-i/2),e.lineTo(r.x+i/2,l.y-a),e.stroke()}var o=1/r;e.save(),e.scale(r,r),e.translate(n.x,n.y),l(1,new x(-3,3)),l(t.bag_preview,new x(t.field_size.x+3,3)),e.fillStyle="white",e.fillRect(0,0,t.field_size.x,t.field_size.y/2),e.lineWidth=1*o,e.strokeStyle="#f4f4f4";for(var i=0;i<t.field_size.x-1;++i)e.beginPath(),e.moveTo(i+1-.5*o,0),e.lineTo(i+1-.5*o,t.field_size.y/2),e.stroke();for(var a=0;a<t.field_size.y/2-1;++a)e.beginPath(),e.moveTo(0,a+1-.5*o),e.lineTo(t.field_size.x,a+1-.5*o),e.stroke();e.translate(0,-t.field_size.y/2),e.restore()},"toon"!=t.style){e.next=3;break}return e.abrupt("return",{tile_size:t.size,smoothing:t.smooth,render_tile:function(e,n,r,l){var o=new Map([[p.I,"#31c7ef"],[p.O,"#e39f02"],[p.T,"#af298a"],[p.J,"#2141c6"],[p.L,"#e35b02"],[p.S,"#59b101"],[p.Z,"#d70f37"],[p.GARBAGE,"gray"]]);if(e.save(),l==Pe.ghost)e.fillStyle="white",e.fillRect(0,0,1,1);else if(l==Pe.disabled)e.filter="grayscale(100%)";else{var i=o.get(n);Object(ve["a"])(null!=i,"no color for piece"),e.fillStyle=i,e.fillRect(0,0,1,1)}var a=t.border/t.size;e.beginPath(),e.lineCap="butt",e.lineWidth=a,e.strokeStyle="#00000040",r[0]&&(e.moveTo(0,a/2),e.lineTo(a/2,a/2),e.lineTo(a/2,0)),r[1]&&(e.moveTo(0,a/2),e.lineTo(1,a/2)),r[2]&&(e.moveTo(1-a/2,0),e.lineTo(1-a/2,a/2),e.lineTo(1,a/2)),r[3]&&(e.moveTo(-a/2+1,0),e.lineTo(-a/2+1,1)),r[4]&&(e.moveTo(1,1-a/2),e.lineTo(1-a/2,1-a/2),e.lineTo(1-a/2,1)),r[5]&&(e.moveTo(1,-a/2+1),e.lineTo(0,-a/2+1)),r[6]&&(e.moveTo(a/2,1),e.lineTo(a/2,1-a/2),e.lineTo(0,1-a/2)),r[7]&&(e.moveTo(a/2,1),e.lineTo(a/2,0)),e.strokeStyle="#00000040",e.stroke(),e.filter="none",e.restore()},render_background:function(e,n,l){return r(e,n,l,t.size)}});case 3:if("pixel"!=t.style){e.next=5;break}return e.abrupt("return",{tile_size:t.size,smoothing:t.smooth,render_tile:function(e,n,r,l){var o=t.border/t.size,i=new Map([[p.I,["#31c7ef","#48e0ff","#20b0e0"]],[p.O,["#f7d308","#ffec1c","#e8c000"]],[p.T,["#ad4d9c","#c658b4","#983888"]],[p.J,["#5a65ad","#6680cc","#4857a0"]],[p.L,["#ef7921","#ff9030","#e06810"]],[p.S,["#42b642","#48d048","#30a030"]],[p.Z,["#ef2029","#ff4848","#d01818"]],[p.GARBAGE,["#42b642","#48d048","#30a030"]]]),a=i.get(n);Object(ve["a"])(null!=a,"no color for piece"),e.save(),l==Pe.ghost&&(e.fillStyle="white",e.fillRect(0,0,1,1),e.globalAlpha=t.ghost_opacity),l!=Pe.disabled&&n!=p.GARBAGE||(e.filter="grayscale(100%)"),e.fillStyle=a[0],e.fillRect(o,o,1-2*o,1-2*o),o>0&&(e.lineCap="butt",e.lineJoin="miter",e.lineWidth=o,e.fillStyle=r[7]?a[1]:a[0],e.fillRect(0,o,o,1-2*o),e.fillStyle=r[1]?a[1]:a[0],e.fillRect(o,0,1-2*o,o),e.fillStyle=r[0]||r[7]||r[1]?a[1]:a[0],e.fillRect(0,0,o,o),e.fillStyle=r[3]?a[2]:a[0],e.fillRect(1-o,o,o,1-2*o),e.fillStyle=r[5]?a[2]:a[0],e.fillRect(o,1-o,1-2*o,o),e.fillStyle=r[4]||r[3]||r[5]?a[2]:a[0],e.fillRect(1-o,1-o,o,o),e.fillStyle=r[2]&&r[1]&&r[3]?a[0]:r[1]?a[1]:r[3]||r[2]?a[2]:a[0],e.fillRect(1-o,0,o,o),e.fillStyle=r[6]&&r[7]&&r[5]?a[0]:r[7]?a[1]:r[5]?a[2]:r[6]?a[1]:a[0],e.fillRect(0,1-o,o,o)),e.filter="none",e.restore()},render_background:function(e,n,l){return r(e,n,l,t.size)}});case 5:if("tetrio"!=t.style){e.next=18;break}return l=new Image,l.src=n("2c01"),o=new Image,o.src=n("4232"),i=[p.Z,p.L,p.O,p.S,p.I,p.J,p.T],a=new Promise((function(e){return l.onload=e})),u=new Promise((function(e){return o.onload=e})),e.next=15,a;case 15:return e.next=17,u;case 17:return e.abrupt("return",{tile_size:30,smoothing:!1,render_tile:function(e,n,r,o){var a;e.save(),a=o==Pe.disabled||n==p.GARBAGE?9:i.indexOf(n),o==Pe.ghost?(e.globalAlpha=.2,e.drawImage(l,217,0,30,30,0,0,1,1),t.ghost_color&&(e.globalAlpha=1,e.globalCompositeOperation="source-atop",e.drawImage(l,31*a,0,30,30,0,0,1,1))):e.drawImage(l,31*a,0,30,30,0,0,1,1),e.restore()},render_background:function(e,t,n){function r(t,n){e.fillStyle="#000000e0",e.fillRect(n.x-2,n.y-2,4,1+3*t);var r=.125;e.strokeStyle="#ffffffe0",e.lineJoin="round",e.lineWidth=r,e.strokeRect(n.x-2-r/2,n.y-2-r/2,4+r,1+3*t+r)}var l=1/30;e.save(),e.drawImage(o,0,0,2e3,1333,30*(n.x+t.field_size.x/2)-1e3,0,2e3,1333),e.fillStyle="#000000a0",e.fillRect(0,0,2e3,1333),e.scale(30,30),e.translate(n.x,n.y);var i=.125;e.strokeStyle="#ffffffe0",e.lineCap="butt",e.lineJoin="round",e.lineWidth=i,e.beginPath(),e.moveTo(0,i/2),e.lineTo(-i/2,i/2),e.lineTo(-i/2,t.field_size.y/2+i/2),e.lineTo(t.field_size.x+i/2,t.field_size.y/2+i/2),e.lineTo(t.field_size.x+i/2,i/2),e.lineTo(t.field_size.x,i/2),e.stroke(),r(1,new x(-3,3)),r(t.bag_preview,new x(t.field_size.x+3,3)),e.fillStyle="#000000e0",e.fillRect(0,0,t.field_size.x,t.field_size.y/2),e.lineWidth=1*l,e.strokeStyle="#ffffff14";for(var a=0;a<t.field_size.x-1;++a)e.beginPath(),e.moveTo(a+1-.5*l,0),e.lineTo(a+1-.5*l,t.field_size.y/2),e.stroke();for(var u=0;u<t.field_size.y/2-1;++u)e.beginPath(),e.moveTo(0,u+1-.5*l),e.lineTo(t.field_size.x,u+1-.5*l),e.stroke();e.translate(0,-t.field_size.y/2),e.restore()}});case 18:throw new Error("invalid render config");case 19:case"end":return e.stop()}}),e)}))),$e.apply(this,arguments)}function He(e){return Qe.apply(this,arguments)}function Qe(){return Qe=Object(pe["a"])(regeneratorRuntime.mark((function e(t){var n,r,l,o,i,a,u,c,f,d,s,b,m,j,v,O,g,_,h,w,k,V,z,S,G,T,A;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ke(t);case 2:return n=e.sent,r=[Pe.normal,Pe.ghost,Pe.disabled],l=document.createElement("canvas"),n.smoothing?(i=256,l.width=n.tile_size*i,l.height=n.tile_size*r.length*(256/i),o=function(e,t){var n=e|t<<8;return new x(n%i,Math.floor(n/i))}):(l.width=n.tile_size*r.length,l.height=n.tile_size,o=function(e,t){return new x(t,0)}),a=function(e,t){for(var r=0,l=0;l<8;++l)e[l]&&(r|=1<<l);return x.scale(o(r,t),n.tile_size)},u=(new TextEncoder).encode(JSON.stringify(t)+n.render_tile.toString()),e.next=10,window.crypto.subtle.digest("SHA-256",u);case 10:if(c=e.sent,f=Array.from(new Uint8Array(c)).map((function(e){return e.toString(16).padStart(2,"0")})).join(""),d=localStorage.getItem("mfro:tetris-tilesheet"),!d){e.next=20;break}if(s=JSON.parse(d),s.hash!=f){e.next=19;break}return e.abrupt("return",[a,s.images]);case 19:console.log("tilesheet cache miss ".concat(s.hash," expected ").concat(f));case 20:b=l.getContext("2d"),Object(ve["a"])(null!=b,"no context"),b.scale(n.tile_size,n.tile_size),m=[],j=[].concat(Object(y["a"])(p.all),[p.GARBAGE]),v=Object(je["a"])(j);try{for(v.s();!(O=v.n()).done;){g=O.value,b.clearRect(0,0,l.width,l.height),_=Object(je["a"])(r);try{for(_.s();!(h=_.n()).done;)if(w=h.value,n.smoothing)for(k=0;k<256;++k){for(V=[],z=0;z<8;++z)V[z]=0!=(k&1<<z);S=o(k,w),b.translate(S.x,S.y),n.render_tile(b,g,V,w),b.translate(-S.x,-S.y)}else G=[!0,!0,!0,!0,!0,!0,!0,!0],T=o(0,w),b.translate(T.x,T.y),n.render_tile(b,g,G,w),b.translate(-T.x,-T.y)}catch(R){_.e(R)}finally{_.f()}A=l.toDataURL(),m.push(A)}}catch(R){v.e(R)}finally{v.f()}return m.length==j.length&&localStorage.setItem("mfro:tetris-tilesheet",JSON.stringify({hash:f,images:m})),e.abrupt("return",[a,m]);case 29:case"end":return e.stop()}}),e)}))),Qe.apply(this,arguments)}(function(e){e[e["normal"]=0]="normal",e[e["ghost"]=1]="ghost",e[e["disabled"]=2]="disabled"})(Pe||(Pe={}));n("cbc2f");var Xe=Object(r["i"])("Tetris Lobby"),Ye=Object(r["i"])("emoji_events"),et=Object(r["i"])("settings"),tt=Object(r["j"])("span",null,"Game rules",-1),nt=Object(r["j"])("span",null,"Start game",-1);function rt(e,t,n,l,o,i){var a=Object(r["x"])("edit-config"),u=Object(r["x"])("v-dialog"),c=Object(r["x"])("v-text"),f=Object(r["x"])("v-grow"),d=Object(r["x"])("clipboard"),s=Object(r["x"])("v-flex"),b=Object(r["x"])("v-icon"),m=Object(r["x"])("v-button"),j=Object(r["x"])("v-card"),p=Object(r["x"])("game");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(u,{"model-value":l.editing},{default:Object(r["G"])((function(){return[Object(r["j"])(a,{kind:"game",modelValue:l.game_rules,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.game_rules=e}),onClose:t[2]||(t[2]=function(e){return l.editing=!1})},null,8,["modelValue"])]})),_:1},8,["model-value"]),Object(r["j"])(s,{column:"",grow:"","align-center":"",class:"mt-6"},{default:Object(r["G"])((function(){return[n.room.local?(Object(r["p"])(),Object(r["f"])(s,{key:1,column:""},{default:Object(r["G"])((function(){return[Object(r["j"])(s,null,{default:Object(r["G"])((function(){return[l.before?(Object(r["p"])(),Object(r["f"])(p,{key:0,value:l.before.game},null,8,["value"])):Object(r["g"])("",!0),Object(r["j"])(p,{value:n.room.local},null,8,["value"]),l.after?(Object(r["p"])(),Object(r["f"])(p,{key:1,value:l.after.game},null,8,["value"])):Object(r["g"])("",!0)]})),_:1}),Object(r["j"])(s,null,{default:Object(r["G"])((function(){return[(Object(r["p"])(!0),Object(r["f"])(r["a"],null,Object(r["v"])(l.others,(function(e){return Object(r["p"])(),Object(r["f"])(p,{key:e,value:e.game},null,8,["value"])})),128))]})),_:1})]})),_:1})):(Object(r["p"])(),Object(r["f"])(j,{key:0},Object(r["h"])({title:Object(r["G"])((function(){return[Object(r["j"])(s,{grow:"","align-start":""},{default:Object(r["G"])((function(){return[Object(r["j"])(c,{title:""},{default:Object(r["G"])((function(){return[Xe]})),_:1}),Object(r["j"])(f,{class:"mx-6"}),Object(r["j"])(f,{class:"mx-6"}),Object(r["j"])(d,{value:l.link},null,8,["value"])]})),_:1})]})),default:Object(r["G"])((function(){return[Object(r["j"])(s,{column:"",class:"pt-4"},{default:Object(r["G"])((function(){return[(Object(r["p"])(!0),Object(r["f"])(r["a"],null,Object(r["v"])(n.room.members,(function(e){return Object(r["p"])(),Object(r["f"])(s,{key:e,class:"px-4"},{default:Object(r["G"])((function(){return[e.winner?(Object(r["p"])(),Object(r["f"])(b,{key:0,class:"mr-3",style:{color:"#ffc107"}},{default:Object(r["G"])((function(){return[Ye]})),_:1})):Object(r["g"])("",!0),Object(r["j"])(c,{class:"my-3"},{default:Object(r["G"])((function(){return[Object(r["i"])(Object(r["B"])(e.name),1)]})),_:2},1024)]})),_:2},1024)})),128))]})),_:1})]})),_:2},[0==n.room.index?{name:"actions",fn:Object(r["G"])((function(){return[Object(r["j"])(m,{text:"",onClick:t[3]||(t[3]=function(e){return l.editing=!0}),class:"mr-3"},{default:Object(r["G"])((function(){return[Object(r["j"])(b,{class:"mr-3"},{default:Object(r["G"])((function(){return[et]})),_:1}),tt]})),_:1}),Object(r["j"])(f),Object(r["j"])(m,{onClick:t[4]||(t[4]=function(e){return l.start()}),color:"primary"},{default:Object(r["G"])((function(){return[nt]})),_:1})]}))}:void 0]),1024))]})),_:1})],64)}var lt={ref:"canvas"};function ot(e,t,n,l,o,i){return Object(r["p"])(),Object(r["f"])("canvas",lt,null,512)}n("46d4"),n("dddc");var it=n("19a6"),at=new x(1,3),ut=[new x(-1,-1),new x(0,-1),new x(1,-1),new x(1,0),new x(1,1),new x(0,1),new x(-1,1),new x(-1,0)];function ct(e,t){var n=document.createElement("canvas"),r=n.getContext("2d");return Object(ve["a"])(null!=r,"context"),n.width=e.tile_size*(t.field_size.x+12+2*at.x),n.height=e.tile_size*(t.field_size.y/2+2*at.y),e.render_background(r,t,x.add(at,new x(6,0))),n.toDataURL()}function ft(e,t,n){return dt.apply(this,arguments)}function dt(){return dt=Object(pe["a"])(regeneratorRuntime.mark((function e(t,n,l){var o,i,a,u,f,d,s,b,m,j,v,O;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=function(e,t){var n=new it["b"],o=new d(n);return Object(r["E"])((function(){return[e(),l.state.hold_available]}),(function(e){var n=Object(me["a"])(e,2),r=n[0],l=n[1];o.clear();var i,a=new x(2,2),u=Object(je["a"])(r);try{for(u.s();!(i=u.n()).done;){var c=i.value;if(c){var f=Le({id:-1,kind:c,position:x.zero,rotation:0}),d=f.reduce((function(e,t){return Math.min(e,t.x)}),1/0)+.5,s=f.reduce((function(e,t){return Math.min(e,t.y)}),1/0)+.5,b=f.reduce((function(e,t){return Math.max(e,t.x)}),-1/0)+.5,m=f.reduce((function(e,t){return Math.max(e,t.y)}),-1/0)+.5,j=new x(-(d+b)/2,-(s+m)/2),p=x.add(a,j),v=t&&!l?Pe.disabled:Pe.normal;o.draw_tetronimo({id:-1,kind:c,position:p,rotation:0},v),a=x.add(a,new x(0,3))}}}catch(O){u.e(O)}finally{u.f()}}),{immediate:!0}),n},f=function(e,t,n,r){var l=a.get(t),i=v(n,r),u=new it["f"];return u.scale=new it["c"](1/o.tile_size,1/o.tile_size),u.texture=new it["g"](l,new it["d"](i.x,i.y,o.tile_size,o.tile_size)),u.position=new it["c"](e.x,e.y),u},u=function(e){return e.x<0||e.x>=l.rules.field_size.x||e.y<0||e.y>=l.rules.field_size.y?null:l.state.field[e.y][e.x]},e.next=5,Ke(n);case 5:return o=e.sent,i=o.tile_size,a=new Map,t.width=(l.rules.field_size.x+12+2*at.x)*i,t.height=(l.rules.field_size.y/2+2*at.y)*i,t.style.width="".concat(t.width,"px"),t.style.height="".concat(t.height,"px"),t.style.marginBottom="".concat(-at.y*i,"px"),it["h"].SCALE_MODE=it["e"].NEAREST,d=function(){function e(t){Object(_["a"])(this,e),this.container=t,this.sprites=[]}return Object(h["a"])(e,[{key:"clear",value:function(){var e,t=Object(je["a"])(this.sprites);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.container.removeChild(n)}}catch(r){t.e(r)}finally{t.f()}this.sprites=[]}},{key:"draw_tile",value:function(e,t,n,r){var l=f(e,t,n,r);this.sprites.push(l),this.container.addChild(l)}},{key:"draw_tetronimo",value:function(e,t){var n,r=this,l=e.kind.rotations[e.rotation],o=Object(je["a"])(e.kind.rotations[e.rotation]);try{var i=function(){var o=n.value,i=x.add(e.position,o),a=ut.map((function(e){return l.every((function(t){return!x.eq(t,x.add(o,e))}))}));r.draw_tile(i,e.kind,a,t)};for(o.s();!(n=o.n()).done;)i()}catch(a){o.e(a)}finally{o.f()}}}]),e}(),b=new it["a"]({view:t,width:i*(l.rules.field_size.x+12+2*at.x),height:i*(l.rules.field_size.y/2+2*at.y),transparent:!0}),e.next=18,He(n);case 18:return m=e.sent,j=Object(me["a"])(m,2),v=j[0],O=j[1],O.forEach((function(e,t){b.loader.add(t.toString(),e)})),b.loader.add("background",ct(o,l.rules)),b.loader.load(),b.loader.onLoad.once((function(){for(var e=0;e<7;++e){var t=b.loader.resources[e].texture.baseTexture;a.set(p.all[e],t)}var n=b.loader.resources[p.all.length].texture.baseTexture;a.set(p.GARBAGE,n);var o=new it["b"];o.scale=new it["c"](i,i);var m=new it["b"];m.position=new it["c"](6+at.x,-l.rules.field_size.y/2+at.y);var j=new it["f"](b.loader.resources["background"].texture);j.width=l.rules.field_size.x+12+2*at.x,j.height=l.rules.field_size.y/2+2*at.y;var v=s((function(){return[l.state.holding]}),!0);v.position=new it["c"](1+at.x,1+at.y);var O=s((function(){return l.state.fall_queue.slice(0,5)}),!1);O.position=new it["c"](7+at.x+l.rules.field_size.x,1+at.y);var g=new it["b"];g.position=new it["c"](4+at.x,at.y),o.addChild(j),o.addChild(m),o.addChild(O),o.addChild(v),o.addChild(g),b.stage.addChild(o);for(var y=function(e){for(var t=function(t){var n=new x(e,t),o=null;Object(r["F"])((function(){null!=o&&(m.removeChild(o),o=null);var r=l.state.field[t][e];if(null!=r){var i=ut.map((function(e){var t;return(null===(t=u(x.add(n,e)))||void 0===t?void 0:t.id)!=r.id}));o=f(new x(e,t),r.kind,i,Pe.normal),m.addChild(o)}}))},n=0;n<l.rules.field_size.y;++n)t(n)},_=0;_<l.rules.field_size.x;++_)y(_);var h=new d(m);Object(r["F"])((function(){if(h.clear(),l.state.falling){var e=l.hard_drop_position(l.state.falling),t=Object(c["a"])(Object(c["a"])({},l.state.falling),{},{position:e});h.draw_tetronimo(t,Pe.ghost),h.draw_tetronimo(l.state.falling,Pe.normal)}}));var w=new d(g);Object(r["F"])((function(){w.clear();var e,t=l.rules.field_size.y/2,n=Object(je["a"])(l.state.garbage_ready);try{for(n.s();!(e=n.n()).done;){var r=e.value;t-=r;for(var o=0;o<r;++o){var i=new x(0,t+o);w.draw_tile(i,p.GARBAGE,[!0,0==o,!0,!0,!0,o+1==r,!0,!0],Pe.normal)}}}catch(s){n.e(s)}finally{n.f()}var a,u=Object(je["a"])(l.state.garbage_pending);try{for(u.s();!(a=u.n()).done;){var c=a.value;t-=c;for(var f=0;f<c;++f){var d=new x(0,t+f);w.draw_tile(d,p.GARBAGE,[!0,0==f,!0,!0,!0,f+1==c,!0,!0],Pe.ghost)}}}catch(s){u.e(s)}finally{u.f()}}))})),e.abrupt("return",(function(){return b.destroy()}));case 27:case"end":return e.stop()}}),e)}))),dt.apply(this,arguments)}var st={name:"game",props:{value:Object},setup:function(e){var t,n,l,o,i=Object(r["C"])(e,"value"),a=Object(r["u"])(null),u=Object(r["l"])("user_prefs");function c(){var e;a.value==n&&i.value==l&&u.value.render==o||(null===(e=t)||void 0===e||e(),t=null,n=a.value,l=i.value,o=u.value.render,a.value&&i.value&&ft(a.value,u.value.render,i.value).then((function(e){return t=e})))}return Object(r["E"])(i,c),Object(r["E"])(a,c),Object(r["E"])(u,c),Object(r["o"])(c),Object(r["n"])((function(){var e;null===(e=t)||void 0===e||e()})),{canvas:a}}};st.render=ot;var bt=st,mt=Object(r["i"])("content_paste"),jt=Object(r["i"])("check");function pt(e,t,n,l,o,i){var a=Object(r["x"])("v-icon"),u=Object(r["x"])("v-button"),c=Object(r["x"])("v-text-field"),f=Object(r["x"])("v-flex");return Object(r["p"])(),Object(r["f"])(f,{"align-center":"","justify-center":""},{default:Object(r["G"])((function(){return[Object(r["j"])(u,{small:"",icon:"",onClick:t[1]||(t[1]=function(e){return l.copy()}),onMouseleave:t[2]||(t[2]=function(e){return l.copied=!1})},{default:Object(r["G"])((function(){return[l.copied?(Object(r["p"])(),Object(r["f"])(a,{key:1,small:"",bold:"",style:{color:"#4caf50"}},{default:Object(r["G"])((function(){return[jt]})),_:1})):(Object(r["p"])(),Object(r["f"])(a,{key:0,small:""},{default:Object(r["G"])((function(){return[mt]})),_:1}))]})),_:1}),Object(r["j"])(c,{small:"",class:"mt-0 ml-4",ref:"input",solo:"","model-value":n.value},null,8,["model-value"])]})),_:1})}var vt={name:"clipboard",props:{value:String},setup:function(e){var t=Object(r["A"])(null),n=Object(r["A"])(!1);return{input:t,copied:n,copy:function(){t.value.select(),document.execCommand("copy"),n.value=!0}}}};vt.render=pt;var Ot=vt,gt={name:"room",components:{game:bt,clipboard:Ot,editConfig:be},props:["room"],setup:function(e){var t=window.location,n=Object(r["d"])((function(){return"".concat(t.origin).concat(t.pathname,"?code=").concat(e.room.code)})),l=Object(r["A"])(!1),o=Object(r["z"])({field_size:new x(10,40),fall_delay:50,lock_delay:30,move_reset_limit:15,wall_kicks:v.standard,bag_preview:5}),i=Object(r["d"])((function(){if(!(e.room.members.length<3)){var t=e.room.index-1;return-1==t&&(t=e.room.members.length-1),e.room.members[t]}})),a=Object(r["d"])((function(){if(!(e.room.members.length<2)){var t=e.room.index+1;return t==e.room.members.length&&(t=0),e.room.members[t]}})),u=Object(r["d"])((function(){return e.room.members.filter((function(t,n){return n!=e.room.index&&t!=i.value&&t!=a.value}))}));return{link:n,editing:l,game_rules:o,others:u,after:a,before:i,start:function(){e.room.start_game(o)}}}};gt.render=rt;var yt=gt,_t=Object(r["j"])("span",null,"Create lobby",-1),ht=Object(r["i"])("arrow_forward");function xt(e,t,n,l,o,i){var a=Object(r["x"])("edit-config"),u=Object(r["x"])("v-dialog"),c=Object(r["x"])("game"),f=Object(r["x"])("v-grow"),d=Object(r["x"])("v-text-field"),s=Object(r["x"])("v-icon"),b=Object(r["x"])("v-button"),m=Object(r["x"])("v-flex"),j=Object(r["x"])("v-card");return Object(r["p"])(),Object(r["f"])(r["a"],null,[Object(r["j"])(u,{"model-value":l.editing},{default:Object(r["G"])((function(){return[Object(r["j"])(a,{kind:"game",modelValue:l.game_rules,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.game_rules=e}),onClose:t[2]||(t[2]=function(e){return l.editing=!1})},null,8,["modelValue"])]})),_:1},8,["model-value"]),Object(r["j"])(m,{column:"",grow:"","align-center":""},{default:Object(r["G"])((function(){return[Object(r["j"])(c,{value:l.local_game},null,8,["value"]),Object(r["j"])(f),Object(r["j"])(j,{class:"mt-4"},{default:Object(r["G"])((function(){return[Object(r["j"])(d,{label:"Name",modelValue:l.name,"onUpdate:modelValue":t[3]||(t[3]=function(e){return l.name=e})},null,8,["modelValue"]),Object(r["j"])(m,{"justify-center":"",class:"my-2"},{default:Object(r["G"])((function(){return[Object(r["j"])(b,{text:"",color:"primary",disabled:!l.valid,onClick:t[4]||(t[4]=function(e){return l.create_room()})},{default:Object(r["G"])((function(){return[_t,Object(r["j"])(s,{class:"ml-3"},{default:Object(r["G"])((function(){return[ht]})),_:1})]})),_:1},8,["disabled"])]})),_:1})]})),_:1})]})),_:1})],64)}n("32ec"),n("5f99");var wt=n("d313"),kt=n("b740");function Vt(e,t,n){var r=e[t];e[t]=function(){var e=r.apply(void 0,arguments);return n.apply(void 0,arguments),e}}function zt(e,t,n){var l,o=new URL(null!==(l=localStorage.getItem("mfro:tetris-server"))&&void 0!==l?l:"wss://api.mfro.me/tetris/join"),i=Object(r["z"])({local:null,index:0,members:[],code:n,state:0,start_game:function(e){var t=ge()(Math.random()).uint32();Object(wt["c"])(a,kt["f"],{seed:t,rules:O.save(e)})}});o.searchParams.set("name",e),i.code&&o.searchParams.set("code",i.code);var a=new WebSocket(o.toString());function u(){var e=i.members.filter((function(e,t){return e.game&&!e.game.state.dead}));if(1==e.length&&(e[0].winner=!0),0==e.length||1==e.length&&i.members.length>1){i.local=null;var t,n=Object(je["a"])(i.members);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.game=null}}catch(l){n.e(l)}finally{n.f()}}}var c=null;return Object(ye["d"])(Object(wt["b"])(a,kt["e"]),(function(e){var n;null===(n=c)||void 0===n||n();var r=O.load(e.rules),l=We(qe(r,e.seed));i.local=Fe(r,l),Vt(i.local,"hold",(function(){return Object(wt["c"])(a,kt["b"],{type:"hold"})})),Vt(i.local,"drop",(function(e){return Object(wt["c"])(a,kt["b"],{type:"drop",distance:e})})),Vt(i.local,"shift",(function(e){return Object(wt["c"])(a,kt["b"],{type:"shift",dir:e})})),Vt(i.local,"rotate",(function(e){return Object(wt["c"])(a,kt["b"],{type:"rotate",dir:e})})),Vt(i.local,"lock_down",(function(){return Object(wt["c"])(a,kt["b"],{type:"lock_down"})})),Vt(i.local,"clear_lines",(function(e){return Object(wt["c"])(a,kt["b"],{type:"send_lines",count:St(e.length)})})),Vt(i.local,"apply_garbage",(function(){return Object(wt["c"])(a,kt["b"],{type:"apply_garbage"})})),Vt(i.local,"new_falling",(function(){return Object(wt["c"])(a,kt["b"],{type:"new_falling"})})),Vt(i.local,"end_game",(function(){Object(wt["c"])(a,kt["b"],{type:"end_game"}),u()}));for(var o=0;o<e.players;++o)if(i.members[o].winner=!1,o==i.index)i.members[o].game=i.local;else{var f=We(qe(r,e.seed));i.members[o].game=Fe(r,f)}c=Ze(t,i.local)})),Object(ye["d"])(Object(wt["b"])(a,kt["a"]),(function(e){var t=Object(me["a"])(e,2),n=t[0],r=t[1],l=i.members[n].game;if(l!=i.local||"send_lines"==r.type)switch(r.type){case"hold":l.hold();break;case"drop":l.drop(r.distance);break;case"shift":l.shift(r.dir);break;case"rotate":l.rotate(r.dir);break;case"lock_down":l.lock_down();break;case"apply_garbage":l.apply_garbage();break;case"new_falling":l.new_falling();break;case"end_game":l.end_game(),u();break;case"send_lines":var o=i.members[(n+1)%i.members.length].game;o.state.garbage_pending.push(r.count);break}})),Object(ye["d"])(Object(wt["b"])(a,kt["c"]),(function(e){if(e!=i.code){var t=new URL(window.location.href);t.searchParams.delete("code"),window.history.replaceState(null,document.title,t.pathname+t.search)}i.code=e})),Object(ye["d"])(Object(wt["b"])(a,kt["d"]),(function(e){var t,n=e.index,r=e.names;if(null===(t=c)||void 0===t||t(),i.members=r.map((function(e){return{name:e,game:null,winner:!1}})),i.index=n,i.members.length>1){var l=new URL(window.location.href);l.searchParams.set("code",i.code),window.history.replaceState(null,document.title,l.pathname+l.search)}u()})),i}function St(e){return 4==e?4:e-1}var Gt={name:"landing",components:{game:bt,editConfig:be,configGameRules:Z,configUserPrefs:de},emits:["room"],setup:function(e,t){var n,l,o=t.emit,i=Object(r["A"])(null),a=Object(r["z"])({field_size:new x(10,40),fall_delay:50,lock_delay:30,move_reset_limit:15,wall_kicks:v.standard,bag_preview:5}),u=Object(r["l"])("user_prefs"),c=Object(r["A"])(null),f=function(){var e;null===(e=l)||void 0===e||e();var t=We(qe(a));c.value=Fe(a,t),l=Ze(u.value,c.value)};Object(r["o"])((function(){f()})),Object(r["n"])((function(){var e;return null===(e=l)||void 0===e?void 0:e()})),Ee(Re,(function(){return f()}));var d=Object(r["A"])(null!==(n=localStorage.getItem("mfro:user-name"))&&void 0!==n?n:""),s=Object(r["d"])((function(){return""!=d.value}));return{local_game:c,editing:i,game_rules:a,name:d,valid:s,create_room:function(){localStorage.setItem("mfro:user-name",d.value);var e=zt(d.value,u.value);o("room",e)},edit:function(e){i.value=e}}}};Gt.render=xt;var Tt=Gt,At=Object(r["j"])("span",null,"Join lobby",-1),Rt=Object(r["i"])("arrow_forward");function Ct(e,t,n,l,o,i){var a=Object(r["x"])("v-text-field"),u=Object(r["x"])("v-icon"),c=Object(r["x"])("v-button"),f=Object(r["x"])("v-flex"),d=Object(r["x"])("v-card");return Object(r["p"])(),Object(r["f"])(f,{column:"",grow:"","align-center":"",class:"mt-6"},{default:Object(r["G"])((function(){return[Object(r["j"])(d,{class:"mb-4"},{default:Object(r["G"])((function(){return[Object(r["j"])(a,{label:"Code",modelValue:l.code,"onUpdate:modelValue":t[1]||(t[1]=function(e){return l.code=e})},null,8,["modelValue"]),Object(r["j"])(a,{label:"Name",modelValue:l.name,"onUpdate:modelValue":t[2]||(t[2]=function(e){return l.name=e})},null,8,["modelValue"]),Object(r["j"])(f,{"justify-center":"",class:"my-2"},{default:Object(r["G"])((function(){return[Object(r["j"])(c,{text:"",color:"primary",disabled:!l.valid,onClick:t[3]||(t[3]=function(e){return l.submit()})},{default:Object(r["G"])((function(){return[At,Object(r["j"])(u,{class:"ml-3"},{default:Object(r["G"])((function(){return[Rt]})),_:1})]})),_:1},8,["disabled"])]})),_:1})]})),_:1})]})),_:1})}var Ut={name:"joining",emits:["room"],props:{code:String},setup:function(e,t){var n,l=t.emit,o=Object(r["A"])(null!==(n=localStorage.getItem("mfro:user-name"))&&void 0!==n?n:""),i=Object(r["A"])(e.code),a=Object(r["d"])((function(){return""!=o.value})),u=Object(r["l"])("user_prefs");return{name:o,code:i,valid:a,submit:function(){localStorage.setItem("mfro:user-name",o.value);var e=zt(o.value,u.value,i.value);l("room",e)}}}};Ut.render=Ct;var It=Ut,Mt={name:"tetris",components:{editConfig:be,room:yt,landing:Tt,joining:It},setup:function(){var e=Object(r["A"])(null),t=new URL(window.location.href),n=t.searchParams.get("code"),l=Object(r["A"])(n),o=localStorage.getItem("mfro:tetris-user-preferences"),i=Object(r["A"])(!1),a=Object(r["A"])(o?JSON.parse(o):{});return Reflect.has(a.value,"autoshift")||(a.value.autoshift={delay:2,initial_delay:10}),Reflect.has(a.value,"soft_drop")||(a.value.soft_drop=10),Reflect.has(a.value,"render")||(a.value.render={size:24,smooth:!1,style:"pixel",border:3,ghost_opacity:.4}),Object(r["r"])("user_prefs",a),Object(r["F"])((function(){Ke(a.value.render).catch((function(e){a.value=Object(c["a"])(Object(c["a"])({},a.value),{},{render:{size:24,smooth:!1,style:"pixel",border:3,ghost_opacity:.4}}),localStorage.setItem("mfro:tetris-user-preferences",JSON.stringify(a.value))}))})),{current_room:e,joining_code:l,editing_user:i,user_prefs:Object(r["d"])({get:function(){return a.value},set:function(e){a.value=e,localStorage.setItem("mfro:tetris-user-preferences",JSON.stringify(e))}})}}};n("f7d5"),n("36ef");Mt.render=u,Mt.__scopeId="data-v-45e58851";var Et=Mt;Object(r["e"])(Et).use(l["a"]).mount("#app")},e306:function(e,t,n){"use strict";var r=n("7129"),l=n.n(r);n.d(t,"default",(function(){return l.a}))},f7d5:function(e,t,n){"use strict";n("1b87")}});
//# sourceMappingURL=index.d4d02075.js.map